import{a as Se,b as be}from"./chunk-WQSY2NUO.js";import{b as J,d as ye,e as xe}from"./chunk-JWZVU7C2.js";import{b as Ie}from"./chunk-ISADC5UE.js";import{a as Ce,b as K,c as _e,e as Ne}from"./chunk-YOPDCGET.js";import{A as M,B as R,P as W,Q as we,U as Te,Va as Le,aa as Ee,b as H,i as z,k as u,m as N,n as E,q as P,s as L,u as I,v as V,x as ve,y as $,z as he}from"./chunk-3TIUEW6I.js";import{e as fe,j as T,k as ge,n as Fe,r as Pe}from"./chunk-IQCLWYOR.js";import{Q as B,ja as O,k as b,ka as F,o as G,p as ce,r as y,s as x,t as j,y as ue}from"./chunk-NCICF7WD.js";import{$ as k,Aa as _,Ba as f,Ca as m,Da as ne,E as q,Ea as ae,H as c,J as S,K as D,La as w,Ma as A,Mb as pe,Na as se,O as v,P as h,Rb as Q,Wa as le,Xa as me,_ as r,ja as C,ka as oe,la as o,qa as g,tb as Y,ua as n,va as s,wa as d,wb as de,zb as Z}from"./chunk-EUOB27Q6.js";var Ve=()=>"[\\w\\-]+(\\.[\\w \\-]+)";var Ue=["*"],Me=(()=>{class t{style;styleClass;static \u0275fac=function(l){return new(l||t)};static \u0275cmp=S({type:t,selectors:[["p-inputGroupAddon"]],hostAttrs:[1,"p-element","p-inputgroup-addon"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:Ue,decls:2,vars:3,consts:[[3,"ngClass","ngStyle"]],template:function(l,a){l&1&&(ne(),n(0,"div",0),ae(1),s()),l&2&&(o("ngClass",a.styleClass)("ngStyle",a.style),oe("data-pc-name","inputgroupaddon"))},dependencies:[Y,de],encapsulation:2})}return t})(),Re=(()=>{class t{static \u0275fac=function(l){return new(l||t)};static \u0275mod=D({type:t});static \u0275inj=q({imports:[Z,ce]})}return t})();var $e=t=>({"p-error":t});function Ke(t,i){if(t&1&&(n(0,"div",5)(1,"span",6),w(2),s()()),t&2){let e=m();r(2),A(e.authService.system)}}function Je(t,i){t&1&&(n(0,"h2"),w(1,"PRUEBAS"),s())}function Qe(t,i){if(t&1&&(n(0,"div",10),d(1,"app-progress-bar",17),s()),t&2){let e=m(2);r(),o("message",e.messageService.progressBarLogin)}}function Xe(t,i){if(t&1){let e=_();n(0,"form",7),f("ngSubmit",function(){v(e);let a=m();return h(a.onSubmit())}),n(1,"div",8),C(2,Je,2,0,"h2"),n(3,"h2",9),w(4),s()(),n(5,"div",10),d(6,"label",11),n(7,"p-inputGroup"),d(8,"input",12),n(9,"p-inputGroupAddon"),w(10,"@turismo.gob.ec"),s()(),d(11,"small",13),s(),n(12,"div",10),d(13,"label",14)(14,"p-password",15)(15,"small",13),s(),C(16,Qe,2,1,"div",10),n(17,"div",10),d(18,"p-button",16),s()()}if(t&2){let e=m();o("formGroup",e.form),r(2),g(2,e.environment.production?-1:2),r(),o("ngClass",me(17,$e,!e.environment.production)),r(),se(" Ingreso al Sistema ",e.authService.systemShortName," "),r(2),o("label",e.LoginFormEnum.username)("required",e.usernameField),r(5),o("errors",e.usernameField.errors)("touched",e.usernameField.touched)("dirty",e.usernameField.dirty),r(2),o("label",e.LoginFormEnum.password)("required",e.passwordField),r(),o("feedback",!1),r(),o("errors",e.passwordField.errors)("touched",e.passwordField.touched)("dirty",e.passwordField.dirty),r(),g(16,e.coreService.isLoading?16:-1),r(2),o("icon",e.PrimeIcons.SIGN_IN)}}function et(t,i){if(t&1&&(n(0,"div",18),d(1,"p-button",19),s()),t&2){let e=m();r(),o("icon",e.PrimeIcons.DOWNLOAD)}}var Ge=(()=>{let i=class i{constructor(){this.authService=c(F),this.authHttpService=c(O),this.coreService=c(y),this.formBuilder=c(V),this.messageService=c(x),this.routesService=c(j),this.PrimeIcons=b,this.LoginFormEnum=B,this.environment=ue,this.authService.removeLogin(),this.buildForm()}buildForm(){this.form=this.formBuilder.group({username:[null,[u.required,u.pattern(Ve())]],password:[null,[u.required]]}),this.checkValueChanges()}checkValueChanges(){}onSubmit(){this.usernameField.value&&this.usernameField.patchValue(this.usernameField.value.trim()),this.form.valid?this.login():(this.form.markAllAsTouched(),this.messageService.errorsFields())}login(){this.authService.removeLogin(),this.authHttpService.login(this.form.value).subscribe(l=>{if(this.authService.roles.length===0){this.messageService.errorCustom("Sin Rol","No cuenta con un rol asignado"),this.authService.removeLogin();return}this.routesService.roleSelect()})}get usernameField(){return this.form.controls.username}get passwordField(){return this.form.controls.password}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=S({type:i,selectors:[["app-login"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold","p-error"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[3,"ngClass"],[1,"field","col-12"],["for","username","appLabel","",3,"label","required"],["pInputText","","id","username","formControlName","username"],["appErrorMessage","",3,"errors","touched","dirty"],["for","password","appLabel","",3,"label","required"],["id","password","formControlName","password",3,"feedback"],["type","submit","label","Continuar",3,"icon"],[3,"message"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","info","label","Descargar Manual de Usuario",3,"icon"]],template:function(a,p){a&1&&(n(0,"div",0)(1,"p-panel",1),C(2,Ke,3,1,"ng-template",2)(3,Xe,19,19,"ng-template",3)(4,et,2,1,"ng-template",4),s()())},dependencies:[Y,P,z,N,E,L,I,H,M,R,G,T,$,K,W,Se,Me],styles:[`body{background-image:url(/assets/images/pages/auth/login/login.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();function tt(t,i){if(t&1&&(n(0,"div",5)(1,"span",6),w(2),s()()),t&2){let e=m();r(2),A(e.authService.system)}}function it(t,i){if(t&1){let e=_();n(0,"div",9)(1,"p-button",15),f("click",function(){v(e);let a=m(2);return h(a.requestTransactionalCode())}),s()()}if(t&2){let e=m(2);r(),o("icon",e.PrimeIcons.SEND)("disabled",!e.usernameField.valid)}}function rt(t,i){if(t&1&&(n(0,"div",13),d(1,"label",16)(2,"input",17)(3,"small",12),s()),t&2){let e=m(2);r(),o("required",e.transactionalCodeField),r(2),o("errors",e.transactionalCodeField.errors)("touched",e.transactionalCodeField.touched)("dirty",e.transactionalCodeField.dirty)}}function ot(t,i){if(t&1){let e=_();n(0,"div",13)(1,"p-button",18),f("click",function(){v(e);let a=m(2);return h(a.verifyTransactionalCode())}),s()()}if(t&2){let e=m(2);r(),o("icon",e.PrimeIcons.VERIFIED)("disabled",!e.isRequestTransactionalCode||!e.transactionalCodeField.valid)}}function nt(t,i){if(t&1&&(n(0,"div",14)(1,"div",19),d(2,"label",20)(3,"p-password",21)(4,"small",12),s(),n(5,"div",19),d(6,"label",22)(7,"p-password",23)(8,"small",12),s()()),t&2){let e=m(2);r(2),o("label",e.LoginFormEnum.username)("required",e.passwordNewField),r(),o("feedback",!1),r(),o("errors",e.passwordNewField.errors)("touched",e.passwordNewField.touched)("dirty",e.passwordNewField.dirty),r(2),o("label",e.LoginFormEnum.passwordConfirmation)("required",e.passwordConfirmationField),r(),o("feedback",!1),r(),o("errors",e.passwordConfirmationField.errors)("touched",e.passwordConfirmationField.touched)("dirty",e.passwordConfirmationField.dirty)}}function at(t,i){if(t&1){let e=_();n(0,"div",13)(1,"p-button",24),f("click",function(){v(e);let a=m(2);return h(a.resetPassword())}),s()()}if(t&2){let e=m(2);r(),o("icon",e.PrimeIcons.KEY)}}function st(t,i){t&1&&(n(0,"div",13),d(1,"app-progress-bar"),s())}function lt(t,i){if(t&1){let e=_();n(0,"form",7),f("ngSubmit",function(){v(e);let a=m();return h(a.onSubmit())}),n(1,"div",8)(2,"h2"),w(3,"Recupera Contrase\xF1a"),s()(),n(4,"div",9),d(5,"label",10)(6,"input",11)(7,"small",12),s(),C(8,it,2,2,"div",9)(9,rt,4,4,"div",13)(10,ot,2,2,"div",13)(11,nt,9,12,"div",14)(12,at,2,1,"div",13)(13,st,2,0,"div",13),s()}if(t&2){let e=m();o("formGroup",e.form),r(5),o("label",e.LoginFormEnum.username)("required",e.usernameField),r(2),o("errors",e.usernameField.errors)("touched",e.usernameField.touched)("dirty",e.usernameField.dirty),r(),g(8,e.isValidTransactionalCode?-1:8),r(),g(9,e.isRequestTransactionalCode&&!e.isValidTransactionalCode?9:-1),r(),g(10,e.isRequestTransactionalCode&&!e.isValidTransactionalCode?10:-1),r(),g(11,e.isValidTransactionalCode?11:-1),r(),g(12,e.isValidTransactionalCode?12:-1),r(),g(13,e.coreService.isLoading?13:-1)}}function mt(t,i){if(t&1){let e=_();n(0,"div",25)(1,"p-button",26),f("click",function(){v(e);let a=m();return h(a.redirectLogin())}),s()()}if(t&2){let e=m();r(),o("raised",!0)("icon",e.PrimeIcons.ARROW_LEFT)}}var je=(()=>{let i=class i{constructor(){this.coreService=c(y),this.formBuilder=c(V),this.authHttpService=c(O),this.messageService=c(x),this.authService=c(F),this.routesService=c(j),this.PrimeIcons=b,this.isValidTransactionalCode=!1,this.isRequestTransactionalCode=!1,this.LoginFormEnum=B,this.buildForm()}ngOnInit(){}buildForm(){this.form=this.formBuilder.group({transactionalCode:[null,[u.required,u.minLength(6)]],passwordNew:[null,[u.required,u.minLength(8)]],passwordConfirmation:[null,[u.required]],username:[null,[u.required]]},{validators:J.passwordMatchValidator})}onSubmit(){this.form.valid?this.resetPassword():this.form.markAllAsTouched()}resetPassword(){this.authHttpService.resetPassword(this.form.value).subscribe(()=>this.routesService.login())}requestTransactionalCode(){this.usernameField.valid?(this.isRequestTransactionalCode=!1,this.transactionalCodeField.reset(),this.authHttpService.requestTransactionalCode(this.usernameField.value).subscribe(()=>this.isRequestTransactionalCode=!0)):this.usernameField.markAsTouched()}verifyTransactionalCode(){this.usernameField.valid?(this.isValidTransactionalCode=!1,this.authHttpService.verifyTransactionalCode(this.transactionalCodeField.value,this.usernameField.value).subscribe(()=>this.isValidTransactionalCode=!0)):this.transactionalCodeField.markAsTouched()}redirectLogin(){this.routesService.login()}get usernameField(){return this.form.controls.username}get transactionalCodeField(){return this.form.controls.transactionalCode}get passwordNewField(){return this.form.controls.passwordNew}get passwordConfirmationField(){return this.form.controls.passwordConfirmation}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=S({type:i,selectors:[["app-password-reset"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[1,"field","col-12"],["for","username","appLabel","",3,"label","required"],["pInputText","","id","username","formControlName","username"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field"],[1,"formgrid","grid"],["label","Solicitar C\xF3digo","severity","info",3,"click","icon","disabled"],["for","transactionalCode","appLabel","","label","Ingrese el c\xF3digo enviado a su correo",3,"required"],["pInputText","","id","transactionalCode","formControlName","transactionalCode"],["severity","success","label","Validar C\xF3digo",3,"click","icon","disabled"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["for","passwordNew","appLabel","",3,"label","required"],["id","passwordNew","formControlName","passwordNew",3,"feedback"],["for","passwordConfirmation","appLabel","",3,"label","required"],["id","passwordConfirmation","formControlName","passwordConfirmation",3,"feedback"],["label","Resetear Contrase\xF1a",3,"click","icon"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","secondary","label","Regresar al Login",1,"w-full",3,"click","raised","icon"]],template:function(a,p){a&1&&(n(0,"div",0)(1,"p-panel",1),C(2,tt,3,1,"ng-template",2)(3,lt,14,12,"ng-template",3)(4,mt,2,2,"ng-template",4),s()())},dependencies:[P,z,N,E,L,I,H,M,R,G,T,$,K,W],styles:[`body{background-image:url(/assets/images/pages/auth/login/password-reset.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();var dt=()=>({"max-height":"200px"});function pt(t,i){if(t&1&&(n(0,"div",5)(1,"span",6),w(2),s()()),t&2){let e=m();r(2),A(e.authService.system)}}function ct(t,i){if(t&1){let e=_();n(0,"form",7),f("ngSubmit",function(){v(e);let a=m();return h(a.onSubmit())}),n(1,"div",8)(2,"h2"),w(3,"Seleccione un Rol"),s()(),n(4,"div",9),d(5,"label",10)(6,"p-listbox",11)(7,"small",12),s(),n(8,"div",9),d(9,"p-button",13),s()()}if(t&2){let e=m();o("formGroup",e.form),r(5),o("label",e.LoginFormEnum.roleSelect)("required",e.roleField),r(),o("options",e.roles)("listStyle",le(9,dt)),r(),o("errors",e.roleField.errors)("touched",e.roleField.touched)("dirty",e.roleField.dirty),r(2),o("icon",e.PrimeIcons.SIGN_IN)}}function ut(t,i){if(t&1){let e=_();n(0,"div",14)(1,"p-button",15),f("click",function(){v(e);let a=m();return h(a.redirectLogin())}),s()()}if(t&2){let e=m();r(),o("raised",!0)("icon",e.PrimeIcons.ARROW_LEFT)}}var Be=(()=>{let i=class i{constructor(){this.coreService=c(y),this.formBuilder=c(V),this.messageService=c(x),this.authService=c(F),this.routesService=c(j),this.roles=[],this.LoginFormEnum=B,this.PrimeIcons=b,this.buildForm()}ngOnInit(){this.roles=this.authService.roles}buildForm(){this.form=this.formBuilder.group({role:[null,[u.required]],fiscalYear:[null],unit:[null]})}onSubmit(){this.form.valid?this.selectRole():(this.form.markAllAsTouched(),this.messageService.errorsFields())}selectRole(){this.authService.role=this.roleField.value,this.authService.selectDashboard()}redirectLogin(){this.routesService.login()}get roleField(){return this.form.controls.role}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=S({type:i,selectors:[["app-role-select"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[1,"field","col-12"],["for","role","appLabel","",3,"label","required"],["id","role","formControlName","role","optionLabel","name",3,"options","listStyle"],["appErrorMessage","",3,"errors","touched","dirty"],["type","submit","label","Continuar",3,"icon"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","secondary","label","Regresar al Login",3,"click","raised","icon"]],template:function(a,p){a&1&&(n(0,"div",0)(1,"p-panel",1),C(2,pt,3,1,"ng-template",2)(3,ct,10,10,"ng-template",3)(4,ut,2,2,"ng-template",4),s()())},dependencies:[P,N,E,L,I,M,R,G,T,W,ye],styles:[`body{background-image:url(/assets/images/pages/auth/login/role.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();var ft=[{path:"login",component:Ge},{path:"password-reset",component:je},{path:"role-select",component:Be}],Oe=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=D({type:i}),i.\u0275inj=q({imports:[Q.forChild(ft),Q]});let t=i;return t})();function gt(t,i){if(t&1&&(n(0,"div",1),d(1,"app-progress-bar",12),s()),t&2){let e=m();r(),o("message",e.messageService.progressBarProcess)}}var di=(()=>{let i=class i{constructor(l,a,p,re,He,ze){this.authHttpService=l,this.authService=a,this.activatedRoute=p,this.coreService=re,this.formBuilder=He,this.messageService=ze,this.PrimeIcons=b,this.form=this.newForm()}ngOnInit(){}newForm(){return this.formBuilder.group({passwordConfirmation:[null,[u.required]],passwordNew:[null,[u.required,u.minLength(8)]],passwordOld:[null,[u.required]]},{validators:J.passwordMatchValidator})}onSubmit(){this.form.valid?this.changePassword():(this.form.markAllAsTouched(),this.messageService.errorsFields())}changePassword(){this.authHttpService.changePassword(this.authService.auth.id,this.form.value).subscribe(l=>{})}get passwordConfirmationField(){return this.form.controls.passwordConfirmation}get passwordNewField(){return this.form.controls.passwordNew}get passwordOldField(){return this.form.controls.passwordOld}};i.\u0275fac=function(a){return new(a||i)(k(O),k(F),k(pe),k(y),k(V),k(x))},i.\u0275cmp=S({type:i,selectors:[["app-password-change"]],decls:17,vars:18,consts:[[1,"p-fluid",3,"ngSubmit","formGroup"],[1,"field"],["for","passwordOld","appLabel","","label","Contrase\xF1a Anterior",3,"required"],["pPassword","","type","password","id","passwordOld","formControlName","passwordOld"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"formgrid","grid"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","passwordNew","label","Nueva Contrase\xF1a",3,"required"],["pPassword","","type","password","id","passwordNew","formControlName","passwordNew",3,"feedback"],["appLabel","","for","passwordConfirmation","label","Repita la Contrase\xF1a",3,"required"],["pPassword","","type","password","id","passwordConfirmation","formControlName","passwordConfirmation",3,"feedback"],["type","submit","label","Cambiar Contrase\xF1a",3,"icon","loading"],[3,"message"]],template:function(a,p){a&1&&(n(0,"form",0),f("ngSubmit",function(){return p.onSubmit()}),n(1,"div",1),d(2,"label",2)(3,"input",3)(4,"small",4),s(),n(5,"div",5)(6,"div",6),d(7,"label",7)(8,"input",8)(9,"small",4),s(),n(10,"div",6),d(11,"label",9)(12,"input",10)(13,"small",4),s()(),n(14,"div",1),d(15,"p-button",11),s(),C(16,gt,2,1,"div",1),s()),a&2&&(o("formGroup",p.form),r(2),o("required",p.passwordOldField),r(2),o("errors",p.passwordOldField.errors)("touched",p.passwordOldField.touched)("dirty",p.passwordOldField.dirty),r(3),o("required",p.passwordNewField),r(),o("feedback",!1),r(),o("errors",p.passwordNewField.errors)("touched",p.passwordNewField.touched)("dirty",p.passwordNewField.dirty),r(2),o("required",p.passwordConfirmationField),r(),o("feedback",!1),r(),o("errors",p.passwordConfirmationField.errors)("touched",p.passwordConfirmationField.touched)("dirty",p.passwordConfirmationField.dirty),r(2),o("icon",p.PrimeIcons.SAVE)("loading",p.coreService.isLoading),r(),g(16,p.coreService.isLoading?16:-1))},dependencies:[P,z,N,E,L,I,H,M,R,T,Ce],styles:[".loginForm[_ngcontent-%COMP%]{padding:5% 20% 20%}"]});let t=i;return t})();var Gi=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=D({type:i}),i.\u0275inj=q({imports:[Z,Oe,ve,Le,ge,Te,Ne,Fe,he,_e,fe,Ee,Pe,we,Ie,xe,be,Re]});let t=i;return t})();export{di as a,Gi as b};
