import{a as ge}from"./chunk-JNDTDOR7.js";import{Ga as de,La as ue,ia as le,ja as me,ka as se,la as ce,o as ae,qa as pe,za as _e}from"./chunk-2UPAKWSC.js";import{B as A,C as te,D as ie,G as ne,K as oe,j as V,k as S,l as x,m as T,n as Z,o as F,r as ee}from"./chunk-WPEGALUS.js";import{j as re}from"./chunk-CSO23DVT.js";import{k as j,o as K,r as q,s as z,u as J,v as Q,x as X}from"./chunk-ZFS7MCCM.js";import{B as D,Da as u,Ea as $,Fa as g,G as f,H as b,Hb as U,Ia as N,Ja as O,Ka as k,Pa as M,S as a,Ya as H,Za as W,ba as _,ca as P,da as c,ia as d,ja as w,ka as L,la as y,lb as Y,ma as m,na as s,oa as C,qb as G,r as R,sa as B,ta as v,ua as r,z as p}from"./chunk-3AQ5X5KI.js";var Ce=e=>({enabled:e});function fe(e,n){if(e&1&&(m(0,"div",14)(1,"h1"),u(2),s()()),e&2){let t=r();a(2),$(t.BreadcrumbEnum.AGREEMENTS)}}function be(e,n){if(e&1&&(m(0,"th",15),u(1),C(2,"p-sortIcon",17),s()),e&2){let t=n.$implicit;c("pSortableColumn",t.field),a(),g(" ",t.header," "),a(),c("field",t.field)}}function Ae(e,n){if(e&1&&(m(0,"tr"),L(1,be,3,3,"th",15,w),m(3,"th",16),u(4),s()()),e&2){let t=n.$implicit,i=r();a(),y(t),a(3),g(" ",i.TableEnum.ACTIONS," ")}}function he(e,n){if(e&1&&u(0),e&2){let t=r(2).$implicit,i=r().$implicit;g(" ",i[t.field].unit.name," ")}}function ve(e,n){if(e&1&&u(0),e&2){let t=r(2).$implicit,i=r().$implicit;g(" ",i[t.field].state.name," ")}}function Se(e,n){if(e&1&&_(0,he,1,1)(1,ve,1,1),e&2){let t,i=r().$implicit;d(0,(t=i.field)==="administrator"?0:t==="agreementState"?1:-1)}}function Ee(e,n){if(e&1&&(u(0),H(1,"date")),e&2){let t=r(4).$implicit;g(" ",W(1,1,t.endedAt)," ")}}function xe(e,n){if(e&1&&_(0,Ee,2,3),e&2){let t=r(3).$implicit;d(0,t.endedAt?0:-1)}}function Te(e,n){e&1&&C(0,"p-tag",20)}function Ie(e,n){if(e&1&&_(0,Te,1,0,"p-tag",20),e&2){let t=r(3).$implicit;d(0,t.suspendedAt?0:-1)}}function we(e,n){e&1&&C(0,"p-tag",21)}function Le(e,n){e&1&&C(0,"p-tag",22)}function ye(e,n){if(e&1&&_(0,we,1,0,"p-tag",21)(1,Le,1,0),e&2){let t=r(3).$implicit;d(0,t.enabled?0:1)}}function Be(e,n){if(e&1&&u(0),e&2){let t=r(2).$implicit,i=r().$implicit;g(" ",i[t.field]," ")}}function Ve(e,n){if(e&1&&_(0,xe,1,1)(1,Ie,1,1)(2,ye,2,1)(3,Be,1,1),e&2){let t,i=r().$implicit;d(0,(t=i.field)==="endedAt"?0:t==="isFinancing"?1:t==="enabled"?2:3)}}function Fe(e,n){if(e&1&&(m(0,"td"),_(1,Se,2,1)(2,Ve,4,1),s()),e&2){let t=n.$implicit,i=r().$implicit;a(),d(1,i[t.field]!=null&&i[t.field].id?1:-1),a(),d(2,i[t.field]!=null&&i[t.field].id?-1:2)}}function Re(e,n){if(e&1){let t=B();m(0,"tr",18),L(1,Fe,3,2,"td",null,w),m(3,"td",16)(4,"p-button",19),v("click",function(){let l=f(t).$implicit,o=r();return b(o.selectItem(l))}),s()()()}if(e&2){let t=n.$implicit,i=n.columns,l=n.rowIndex,o=r();c("pSelectableRow",t)("pSelectableRowIndex",l)("ngClass",M(4,Ce,!t.enabled)),a(),y(i),a(3),c("icon",o.PrimeIcons.ELLIPSIS_V)}}function De(e,n){if(e&1&&(m(0,"tr")(1,"td"),u(2),s()()),e&2){let t=n.$implicit,i=r();a(),P("colspan",t.length),a(),g(" ",i.messageService.paginatorNoRecordsFound," ")}}function Pe(e,n){}function $e(e,n){if(e&1&&C(0,"app-view",13),e&2){let t=r();c("id",t.selectedItem.id)}}var nt=(()=>{let n=class n{constructor(){this.authService=p(oe),this.coreService=p(q),this.agreementsHttpService=p(ne),this.agreementsService=p(X),this.router=p(U),this.breadcrumbService=p(J),this.PrimeIcons=j,this.IconButtonActionEnum=T,this.SeverityButtonActionEnum=Z,this.LabelButtonActionEnum=x,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=p(z),this.messageDialogService=p(Q),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ae(""),this.items=[],this.isVisibleAgreementView=!1,this.breadcrumbService.setItems([{label:F.AGREEMENTS}]),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(R(500)).subscribe(i=>{this.findAgreements()})}ngOnInit(){this.findAgreements()}findAgreements(){this.authService.role.code===V.NATIONAL_SUPERVISOR&&this.agreementsHttpService.findNationalAgreementsByOrigin().subscribe(i=>{this.items=i}),this.authService.role.code===V.INTERNATIONAL_SUPERVISOR&&this.agreementsHttpService.findInternationalAgreementsByOrigin().subscribe(i=>{this.items=i})}buildColumns(){this.columns=[{field:"name",header:A.name},{field:"internalNumber",header:A.internalNumber},{field:"number",header:A.number},{field:"administrator",header:ie.unit},{field:"endedAt",header:A.endedAt},{field:"agreementState",header:te.state},{field:"enabled",header:A.enabled}]}buildButtonActions(){this.buttonActions=[{id:S.VIEW,label:x.VIEW,icon:T.VIEW,command:()=>{this.redirectViewAgreement()}},{id:S.COMPLETE,label:x.COMPLETE,icon:T.COMPLETE,command:()=>{this.selectedItem?.id&&this.redirectCompleteForm(this.selectedItem)}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}redirectCompleteForm(i){this.router.navigate(["/core/agreements","register"])}redirectEditForm(i){this.router.navigate(["/core/agreements/update",i])}redirectViewAgreement(){this.messageDialogService.successCustom("Sitio en construcci\xF3n","Pronto estar\xE1 disponibel")}remove(i){}validateButtonActions(i){this.buildButtonActions(),i.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===S.COMPLETE),1),i.enabled||this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===S.VIEW),1)}paginate(i){}selectItem(i){this.agreementsHttpService.findOne(i.id).subscribe(l=>{this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i),this.agreementsService.agreement=l})}};n.\u0275fac=function(l){return new(l||n)},n.\u0275cmp=D({type:n,selectors:[["app-agreement-list"]],decls:15,vars:18,consts:[["dt",""],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Convenio",3,"visibleChange","visible","modal"],[3,"id"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex","ngClass"],[3,"click","icon"],["severity","danger","value","Suspendido",1,"mr-1"],["severity","info","value","Registrado"],["severity","danger","value","En Proceso"]],template:function(l,o){if(l&1){let E=B();m(0,"p-toolbar")(1,"div",1)(2,"p-button",2),v("click",function(){return f(E),b(o.redirectCreateForm())}),s(),m(3,"p-button",3),v("click",function(){return f(E),b(o.findAgreements())}),s()(),C(4,"div",4),s(),m(5,"p-table",5,0),_(7,fe,3,1,"ng-template",6)(8,Ae,5,1,"ng-template",7)(9,Re,5,6,"ng-template",8)(10,De,3,2,"ng-template",9)(11,Pe,0,0,"ng-template",10),s(),m(12,"app-button-action",11),v("isHide",function(h){return f(E),b(o.isButtonActions=!h)}),s(),m(13,"p-dialog",12),k("visibleChange",function(h){return f(E),O(o.isVisibleAgreementView,h)||(o.isVisibleAgreementView=h),b(h)}),_(14,$e,1,1,"app-view",13),s()}l&2&&(a(2),c("icon",o.IconButtonActionEnum.CREATE)("label",o.LabelButtonActionEnum.CREATE)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.CREATE),a(),c("icon",o.IconButtonActionEnum.SYNC)("label",o.LabelButtonActionEnum.SYNC)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.SYNC),a(2),c("value",o.items)("columns",o.columns)("paginator",!0)("rows",10)("loading",o.coreService.isLoading),a(7),c("buttonActions",o.buttonActions)("enabled",o.isButtonActions),a(),N("visible",o.isVisibleAgreementView),c("modal",!0),a(),d(14,o.selectedItem&&o.isVisibleAgreementView?14:-1))},dependencies:[Y,ue,K,pe,re,le,me,ce,se,_e,de,ge,G],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let e=n;return e})();export{nt as a};
