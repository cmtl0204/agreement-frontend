import{a as de}from"./chunk-QYFEBEA3.js";import{Ga as ce,La as pe,ia as oe,ja as re,ka as ae,la as le,o as ne,qa as me,za as se}from"./chunk-PBIOFTA5.js";import{B as A,C as X,D as Z,G as ee,K as te,j as B,k as S,l as x,m as T,n as J,o as F,r as Q}from"./chunk-4QCADNJD.js";import{j as ie}from"./chunk-CSO23DVT.js";import{k as Y,o as G,r as U,s as j,u as K,v as q,x as z}from"./chunk-ZFS7MCCM.js";import{B as N,Da as u,Ea as $,Fa as f,G as C,H as b,Hb as W,Ia as D,Ja as O,Ka as k,Pa as M,S as r,ba as d,ca as P,da as c,ia as _,ja as w,ka as y,la as L,lb as H,ma as m,na as s,oa as g,r as R,sa as V,ta as v,ua as a,z as p}from"./chunk-3AQ5X5KI.js";var _e=e=>({enabled:e});function ue(e,n){if(e&1&&(m(0,"div",14)(1,"h1"),u(2),s()()),e&2){let i=a();r(2),$(i.BreadcrumbEnum.AGREEMENTS)}}function ge(e,n){if(e&1&&(m(0,"th",15),u(1),g(2,"p-sortIcon",17),s()),e&2){let i=n.$implicit;c("pSortableColumn",i.field),r(),f(" ",i.header," "),r(),c("field",i.field)}}function fe(e,n){if(e&1&&(m(0,"tr"),y(1,ge,3,3,"th",15,w),m(3,"th",16),u(4),s()()),e&2){let i=n.$implicit,t=a();r(),L(i),r(3),f(" ",t.TableEnum.ACTIONS," ")}}function Ce(e,n){if(e&1&&u(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field].unit.name," ")}}function be(e,n){if(e&1&&u(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field].state.name," ")}}function Ae(e,n){if(e&1&&d(0,Ce,1,1)(1,be,1,1),e&2){let i,t=a().$implicit;_(0,(i=t.field)==="administrator"?0:i==="agreementState"?1:-1)}}function he(e,n){e&1&&g(0,"p-tag",20)}function ve(e,n){if(e&1&&d(0,he,1,0,"p-tag",20),e&2){let i=a(3).$implicit;_(0,i.suspendedAt?0:-1)}}function Se(e,n){e&1&&g(0,"p-tag",21)}function Ee(e,n){e&1&&g(0,"p-tag",22)}function xe(e,n){if(e&1&&d(0,Se,1,0,"p-tag",21)(1,Ee,1,0),e&2){let i=a(3).$implicit;_(0,i.enabled?0:1)}}function Te(e,n){if(e&1&&u(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field]," ")}}function Ie(e,n){if(e&1&&d(0,ve,1,1)(1,xe,2,1)(2,Te,1,1),e&2){let i,t=a().$implicit;_(0,(i=t.field)==="isFinancing"?0:i==="enabled"?1:2)}}function we(e,n){if(e&1&&(m(0,"td"),d(1,Ae,2,1)(2,Ie,3,1),s()),e&2){let i=n.$implicit,t=a().$implicit;r(),_(1,t[i.field]!=null&&t[i.field].id?1:-1),r(),_(2,t[i.field]!=null&&t[i.field].id?-1:2)}}function ye(e,n){if(e&1){let i=V();m(0,"tr",18),y(1,we,3,2,"td",null,w),m(3,"td",16)(4,"p-button",19),v("click",function(){let l=C(i).$implicit,o=a();return b(o.selectItem(l))}),s()()()}if(e&2){let i=n.$implicit,t=n.columns,l=n.rowIndex,o=a();c("pSelectableRow",i)("pSelectableRowIndex",l)("ngClass",M(4,_e,!i.enabled)),r(),L(t),r(3),c("icon",o.PrimeIcons.ELLIPSIS_V)}}function Le(e,n){if(e&1&&(m(0,"tr")(1,"td"),u(2),s()()),e&2){let i=n.$implicit,t=a();r(),P("colspan",i.length),r(),f(" ",t.messageService.paginatorNoRecordsFound," ")}}function Ve(e,n){}function Be(e,n){if(e&1&&g(0,"app-view",13),e&2){let i=a();c("id",i.selectedItem.id)}}var Xe=(()=>{let n=class n{constructor(){this.authService=p(te),this.coreService=p(U),this.agreementsHttpService=p(ee),this.agreementsService=p(z),this.router=p(W),this.breadcrumbService=p(K),this.PrimeIcons=Y,this.IconButtonActionEnum=T,this.SeverityButtonActionEnum=J,this.LabelButtonActionEnum=x,this.BreadcrumbEnum=F,this.TableEnum=Q,this.messageService=p(j),this.messageDialogService=p(q),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ne(""),this.items=[],this.isVisibleAgreementView=!1,this.breadcrumbService.setItems([{label:F.AGREEMENTS}]),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(R(500)).subscribe(t=>{this.findAgreements()})}ngOnInit(){this.findAgreements()}findAgreements(){this.authService.role.code===B.NATIONAL_SUPERVISOR&&this.agreementsHttpService.findNationalAgreementsByOrigin().subscribe(t=>{this.items=t}),this.authService.role.code===B.INTERNATIONAL_SUPERVISOR&&this.agreementsHttpService.findInternationalAgreementsByOrigin().subscribe(t=>{this.items=t})}buildColumns(){this.columns=[{field:"name",header:A.name},{field:"internalNumber",header:A.internalNumber},{field:"number",header:A.number},{field:"administrator",header:Z.unit},{field:"endedAt",header:A.endedAt},{field:"agreementState",header:X.state},{field:"enabled",header:A.enabled}]}buildButtonActions(){this.buttonActions=[{id:S.VIEW,label:x.VIEW,icon:T.VIEW,command:()=>{this.redirectViewAgreement()}},{id:S.COMPLETE,label:x.COMPLETE,icon:T.COMPLETE,command:()=>{this.selectedItem?.id&&this.redirectCompleteForm(this.selectedItem)}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}redirectCompleteForm(t){this.router.navigate(["/core/agreements","register"])}redirectEditForm(t){this.router.navigate(["/core/agreements/update",t])}redirectViewAgreement(){this.messageDialogService.successCustom("Sitio en construcci\xF3n","Pronto estar\xE1 disponibel")}remove(t){}validateButtonActions(t){this.buildButtonActions(),t.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===S.COMPLETE),1),t.enabled||this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===S.VIEW),1)}paginate(t){}selectItem(t){this.agreementsHttpService.findOne(t.id).subscribe(l=>{this.isButtonActions=!0,this.selectedItem=t,this.validateButtonActions(t),this.agreementsService.agreement=l})}};n.\u0275fac=function(l){return new(l||n)},n.\u0275cmp=N({type:n,selectors:[["app-agreement-list"]],decls:15,vars:18,consts:[["dt",""],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Convenio",3,"visibleChange","visible","modal"],[3,"id"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex","ngClass"],[3,"click","icon"],["severity","danger","value","Suspendido",1,"mr-1"],["severity","info","value","Registrado"],["severity","danger","value","En Proceso"]],template:function(l,o){if(l&1){let E=V();m(0,"p-toolbar")(1,"div",1)(2,"p-button",2),v("click",function(){return C(E),b(o.redirectCreateForm())}),s(),m(3,"p-button",3),v("click",function(){return C(E),b(o.findAgreements())}),s()(),g(4,"div",4),s(),m(5,"p-table",5,0),d(7,ue,3,1,"ng-template",6)(8,fe,5,1,"ng-template",7)(9,ye,5,6,"ng-template",8)(10,Le,3,2,"ng-template",9)(11,Ve,0,0,"ng-template",10),s(),m(12,"app-button-action",11),v("isHide",function(h){return C(E),b(o.isButtonActions=!h)}),s(),m(13,"p-dialog",12),k("visibleChange",function(h){return C(E),O(o.isVisibleAgreementView,h)||(o.isVisibleAgreementView=h),b(h)}),d(14,Be,1,1,"app-view",13),s()}l&2&&(r(2),c("icon",o.IconButtonActionEnum.CREATE)("label",o.LabelButtonActionEnum.CREATE)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.CREATE),r(),c("icon",o.IconButtonActionEnum.SYNC)("label",o.LabelButtonActionEnum.SYNC)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.SYNC),r(2),c("value",o.items)("columns",o.columns)("paginator",!0)("rows",10)("loading",o.coreService.isLoading),r(7),c("buttonActions",o.buttonActions)("enabled",o.isButtonActions),r(),D("visible",o.isVisibleAgreementView),c("modal",!0),r(),_(14,o.selectedItem&&o.isVisibleAgreementView?14:-1))},dependencies:[H,pe,G,me,ie,oe,re,le,ae,se,ce,de],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let e=n;return e})();export{Xe as a};
