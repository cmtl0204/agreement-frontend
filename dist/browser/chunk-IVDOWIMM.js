import{a as lt}from"./chunk-273YQJAH.js";import{b as it}from"./chunk-OQ6ZYBDZ.js";import{b as Ee}from"./chunk-TUXB6K7E.js";import{a as tt}from"./chunk-ACCJ57SK.js";import{c as nt,d as ot,f as rt}from"./chunk-LYLVYI3L.js";import{b as et}from"./chunk-ISADC5UE.js";import{c as Ie,e as Fe}from"./chunk-NARKSFTA.js";import{Ea as Je,Ga as Ke,Ja as Xe,P as Le,Q as Be,Ta as Ye,Wa as Ze,Y as we,Z as ke,_ as Ne,ba as Re,da as Ve,ga as Pe,na as ze,o as Ce,oa as je,pa as We,qa as $e,ta as He,va as Qe,w as Ae,x as Me,xa as Ue,z as Se,za as qe}from"./chunk-3YQNJSUG.js";import{e as be,j as xe,k as Te,m as Oe,n as De,r as Ge}from"./chunk-AV32RPSY.js";import{$ as I,H as O,I as y,J as D,K as k,L as de,M as E,N as ue,P as fe,da as ge,ga as ve,ha as he,k as w,ka as _e,ma as ye,o as S,p as le,r as me,s as ae,u as pe,v as se,x as ce}from"./chunk-UWAROY2D.js";import{$ as z,Aa as Q,Ba as U,Ca as u,E as v,Fa as q,H as s,Ha as J,Ia as K,J as x,Ja as X,K as h,La as g,Na as A,O as R,Ob as re,P as V,Rb as B,T as P,Xa as _,_ as r,bb as Y,hb as Z,ja as d,ka as f,la as l,oa as j,pa as T,qa as L,sa as W,ta as $,tb as ee,ua as a,ub as te,va as m,vb as ie,wa as c,wb as ne,xa as H,xb as oe,ya as G,za as C,zb as M}from"./chunk-EUOB27Q6.js";var ct=(e,t,n,o,i,p,b)=>({"p-timeline p-component":!0,"p-timeline-left":e,"p-timeline-right":t,"p-timeline-top":n,"p-timeline-bottom":o,"p-timeline-alternate":i,"p-timeline-vertical":p,"p-timeline-horizontal":b}),N=e=>({$implicit:e});function dt(e,t){e&1&&C(0)}function ut(e,t){e&1&&C(0)}function ft(e,t){if(e&1&&(H(0),d(1,ut,1,0,"ng-container",5),G()),e&2){let n=u().$implicit,o=u();r(),l("ngTemplateOutlet",o.markerTemplate)("ngTemplateOutletContext",_(2,N,n))}}function gt(e,t){e&1&&c(0,"div",10),e&2&&f("data-pc-section","marker")}function vt(e,t){e&1&&c(0,"div",11)}function ht(e,t){e&1&&C(0)}function _t(e,t){if(e&1&&(a(0,"div",3)(1,"div",4),d(2,dt,1,0,"ng-container",5),m(),a(3,"div",6),d(4,ft,2,4,"ng-container",7)(5,gt,1,1,"ng-template",null,0,Z)(7,vt,1,0,"div",8),m(),a(8,"div",9),d(9,ht,1,0,"ng-container",5),m()()),e&2){let n=t.$implicit,o=t.last,i=X(6),p=u();f("data-pc-section","event"),r(),f("data-pc-section","opposite"),r(),l("ngTemplateOutlet",p.oppositeTemplate)("ngTemplateOutletContext",_(11,N,n)),r(),f("data-pc-section","separator"),r(),l("ngIf",p.markerTemplate)("ngIfElse",i),r(3),l("ngIf",!o),r(),f("data-pc-section","content"),r(),l("ngTemplateOutlet",p.contentTemplate)("ngTemplateOutletContext",_(13,N,n))}}var mt=(()=>{class e{el;value;style;styleClass;align="left";layout="vertical";templates;contentTemplate;oppositeTemplate;markerTemplate;constructor(n){this.el=n}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(n=>{switch(n.getType()){case"content":this.contentTemplate=n.template;break;case"opposite":this.oppositeTemplate=n.template;break;case"marker":this.markerTemplate=n.template;break}})}static \u0275fac=function(o){return new(o||e)(z(P))};static \u0275cmp=x({type:e,selectors:[["p-timeline"]],contentQueries:function(o,i,p){if(o&1&&q(p,S,4),o&2){let b;J(b=K())&&(i.templates=b)}},hostAttrs:[1,"p-element"],inputs:{value:"value",style:"style",styleClass:"styleClass",align:"align",layout:"layout"},decls:2,vars:15,consts:[["marker",""],[3,"ngStyle","ngClass"],["class","p-timeline-event",4,"ngFor","ngForOf"],[1,"p-timeline-event"],[1,"p-timeline-event-opposite"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-timeline-event-separator"],[4,"ngIf","ngIfElse"],["class","p-timeline-event-connector",4,"ngIf"],[1,"p-timeline-event-content"],[1,"p-timeline-event-marker"],[1,"p-timeline-event-connector"]],template:function(o,i){o&1&&(a(0,"div",1),d(1,_t,10,15,"div",2),m()),o&2&&(T(i.styleClass),l("ngStyle",i.style)("ngClass",Y(7,ct,i.align==="left",i.align==="right",i.align==="top",i.align==="bottom",i.align==="alternate",i.layout==="vertical",i.layout==="horizontal")),f("data-pc-name","timeline")("data-pc-section","root"),r(),l("ngForOf",i.value))},dependencies:[ee,te,ie,oe,ne],styles:[`@layer primeng{.p-timeline{display:flex;flex-grow:1;flex-direction:column}.p-timeline-left .p-timeline-event-opposite{text-align:right}.p-timeline-left .p-timeline-event-content{text-align:left}.p-timeline-right .p-timeline-event{flex-direction:row-reverse}.p-timeline-right .p-timeline-event-opposite{text-align:left}.p-timeline-right .p-timeline-event-content{text-align:right}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(2n){flex-direction:row-reverse}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(odd) .p-timeline-event-opposite{text-align:right}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(odd) .p-timeline-event-content{text-align:left}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(2n) .p-timeline-event-opposite{text-align:left}.p-timeline-vertical.p-timeline-alternate .p-timeline-event:nth-child(2n) .p-timeline-event-content{text-align:right}.p-timeline-event{display:flex;position:relative;min-height:70px}.p-timeline-event:last-child{min-height:0}.p-timeline-event-opposite,.p-timeline-event-content{flex:1;padding:0 1rem;min-width:100px}.p-timeline-event-separator{flex:0;display:flex;align-items:center;flex-direction:column}.p-timeline-event-marker{display:flex;align-self:baseline}.p-timeline-event-connector{flex-grow:1}.p-timeline-horizontal{flex-direction:row}.p-timeline-horizontal .p-timeline-event{flex-direction:column;flex:1}.p-timeline-horizontal .p-timeline-event:last-child{flex:0}.p-timeline-horizontal .p-timeline-event-separator{flex-direction:row}.p-timeline-horizontal .p-timeline-event-connector{width:100%}.p-timeline-bottom .p-timeline-event{flex-direction:column-reverse}.p-timeline-horizontal.p-timeline-alternate .p-timeline-event:nth-child(2n){flex-direction:column-reverse}}
`],encapsulation:2,changeDetection:0})}return e})(),at=(()=>{class e{static \u0275fac=function(o){return new(o||e)};static \u0275mod=h({type:e});static \u0275inj=v({imports:[M,le]})}return e})();var bt=(e,t)=>t.id,xt=e=>({"background-color":e});function Tt(e,t){if(e&1&&c(0,"app-skeleton",0),e&2){let n=u();l("type",n.SkeletonEnum.CARD)}}function Ct(e,t){if(e&1&&(a(0,"span",8),c(1,"i"),m()),e&2){let n=t.$implicit;j(_(4,xt,n.color)),r(),T(n.icon)}}function At(e,t){if(e&1&&(a(0,"b"),g(1,"Campo:"),m(),g(2),c(3,"br"),a(4,"b"),g(5,"Valor anterior:"),m(),g(6),c(7,"br"),a(8,"b"),g(9,"Nuevo Valor:"),m(),g(10),c(11,"p-divider")),e&2){let n=t.$implicit;r(2),A(" ",n.path," "),r(4),A(" ",n.oldValue," "),r(4),A(" ",n.newValue," ")}}function Mt(e,t){if(e&1&&(a(0,"p-card",9),W(1,At,12,3,null,null,bt),m()),e&2){let n=t.$implicit;l("header",n.status)("subheader",n.date),r(),$(n.agreementLogDetails)}}function St(e,t){if(e&1){let n=Q();a(0,"p-toolbar")(1,"div",1)(2,"p-button",2),U("click",function(){R(n);let i=u();return V(i.downloadLogsByAgreement())}),m()(),c(3,"div",3),m(),a(4,"p-panel",4)(5,"p-timeline",5),d(6,Ct,2,6,"ng-template",6)(7,Mt,3,2,"ng-template",7),m()()}if(e&2){let n=u();r(2),l("icon",n.IconButtonActionEnum.DOWNLOAD)("label",n.LabelButtonActionEnum.DOWNLOAD)("loading",n.coreService.isLoading)("severity",n.SeverityButtonActionEnum.DOWNLOAD),r(2),l("header",n.AgreementLogEnum.header),r(),l("value",n.events)}}var pt=(()=>{let t=class t{constructor(){this.authService=s(ye),this.coreService=s(me),this.agreementsHttpService=s(ge),this.agreementLogsHttpService=s(he),this.agreementsService=s(ce),this.router=s(re),this.breadcrumbService=s(pe),this.PrimeIcons=w,this.IconButtonActionEnum=k,this.SeverityButtonActionEnum=de,this.LabelButtonActionEnum=D,this.BreadcrumbEnum=E,this.TableEnum=fe,this.messageService=s(ae),this.messageDialogService=s(se),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new Ce(""),this.items=[],this.events=[],this.isVisibleAgreementView=!1,this.SkeletonEnum=ue,this.AgreementLogEnum=I,this.breadcrumbService.setItems([{label:E.AGREEMENTS},{label:E.AGREEMENTS_LOG}]),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findAgreementLogsByAgreement()}findAgreementLogsByAgreement(){this.agreementLogsHttpService.findAgreementLogsByAgreement(this.id).subscribe(o=>{this.items=o,this.events=this.items.map(i=>({status:`${i.user.name} ${i.user.lastname}`,date:ve(i.registeredAt,"MM-dd-yyyy hh:mm:ss"),icon:w.ARROW_DOWN,color:"var(--primary-color)",agreementLogDetails:i.agreementLogDetails}))})}buildColumns(){this.columns=[{field:"registeredAt",header:I.registeredAt},{field:"user",header:I.user}]}buildButtonActions(){this.buttonActions=[{id:y.VIEW,label:D.VIEW,icon:k.VIEW,command:()=>{this.redirectCreateForm()}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}validateButtonActions(o){this.buildButtonActions(),o.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(i=>i.id===y.COMPLETE),1),o.enabled||(this.buttonActions.splice(this.buttonActions.findIndex(i=>i.id===y.VIEW),1),this.buttonActions.splice(this.buttonActions.findIndex(i=>i.id===y.EDIT),1))}selectItem(o){this.agreementsHttpService.findOne(o.id).subscribe(i=>{this.isButtonActions=!0,this.selectedItem=o,this.validateButtonActions(o),this.agreementsService.agreement=i})}downloadLogsByAgreement(){this.agreementLogsHttpService.downloadLogsByAgreement(this.id)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=x({type:t,selectors:[["app-log"]],inputs:{id:"id"},decls:2,vars:2,consts:[[3,"type"],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],[3,"header"],["align","alternate","styleClass","customized-timeline",3,"value"],["pTemplate","marker"],["pTemplate","content"],[1,"flex","w-2rem","h-2rem","align-items-center","justify-content-center","text-white","border-circle","z-1","shadow-1"],[3,"header","subheader"]],template:function(i,p){i&1&&d(0,Tt,1,1,"app-skeleton",0)(1,St,8,6),i&2&&(L(0,p.coreService.isLoading?0:-1),r(),L(1,p.coreService.isLoading?-1:1))},dependencies:[je,S,xe,ke,Oe,Le,We,mt]});let e=t;return e})();var Et=[{path:"",component:pt,canActivate:[Ee],data:{roles:[O.NATIONAL_SUPERVISOR,O.INTERNATIONAL_SUPERVISOR]}}],st=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=h({type:t}),t.\u0275inj=v({imports:[B.forChild(Et),B]});let e=t;return e})();var zi=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=h({type:t}),t.\u0275inj=v({providers:[_e],imports:[M,st,Me,Ze,Te,Ne,Fe,De,Se,Ie,be,we,Ge,Be,et,$e,Ue,Ve,ot,Re,rt,nt,lt,He,Qe,it,Ae,ze,Ke,Xe,Pe,Ye,qe,tt,Je,at]});let e=t;return e})();export{zi as LogModule};
