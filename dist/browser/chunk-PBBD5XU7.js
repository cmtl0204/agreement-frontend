import{a as jt,b as Yt}from"./chunk-RXAO53JB.js";import{b as Dt}from"./chunk-WTWFHCWF.js";import{a as Kt,b as qt}from"./chunk-AJT6KDO2.js";import"./chunk-567JBFQH.js";import"./chunk-ISADC5UE.js";import{d as Bt,e as Mt}from"./chunk-CWCRAML4.js";import{A as Ft,Aa as $t,B as De,C as be,Ga as xe,Ha as Gt,Ja as Ut,Ka as Wt,La as Ee,Q as tt,R as It,Xa as zt,ba as kt,d as St,fa as Pt,ha as q,i as ye,ia as ie,ja as ne,k as ae,ka as oe,m as Ce,n as fe,na as Vt,o as Lt,p as te,pa as re,q as Tt,qa as Nt,r as he,ra as it,t as Fe,ta as $e,ua as Rt,v as Ie,va as we,w as ve,wa as Ot,y as yt,za as Ht}from"./chunk-A5564HUG.js";import{j as K,k as At,m as de,n as wt}from"./chunk-UYRI6Q32.js";import{A as me,Ba as $,D as gt,E as ce,I as Ct,J as ze,K as st,L as D,M as S,N as A,O as z,P as F,Q as ft,S as ee,T as Re,ba as _e,ca as Ze,e as Xe,ea as ht,fa as Te,ga as w,ha as pe,ia as Me,ja as vt,k as R,ka as ue,la as Oe,o as H,r as U,s as X,sa as ge,ta as bt,u as Z,ua as et,v as W,va as xt,x as ut,ya as Et,z as se,za as He}from"./chunk-YDHQYZIO.js";import{Aa as x,Ba as b,Ca as o,E as je,H as _,J as O,Ja as We,K as Ye,La as p,Ma as B,Mb as Ne,Na as C,O as f,Oa as le,Ob as Qe,P as h,Pa as pt,Qa as P,Ra as V,Rb as at,Sa as N,Wa as Y,Xa as Je,_ as r,eb as y,fb as Ae,gb as k,ja as d,ka as J,la as c,oa as j,p as lt,pa as G,qa as g,ra as I,sa as L,ta as T,tb as dt,ua as l,va as m,w as Le,wa as u,yb as Q,zb as _t}from"./chunk-EUOB27Q6.js";var pi=t=>({enabled:t});function di(t,i){if(t&1&&(l(0,"div",13)(1,"h1"),p(2),m()()),t&2){let e=o();r(2),B(e.BreadcrumbEnum.AGREEMENTS)}}function _i(t,i){if(t&1&&(l(0,"th",14),p(1),u(2,"p-sortIcon",16),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function ui(t,i){if(t&1&&(l(0,"tr"),L(1,_i,3,3,"th",14,I),l(3,"th",15),p(4),m()()),t&2){let e=i.$implicit,n=o();r(),T(e),r(3),C(" ",n.TableEnum.ACTIONS," ")}}function gi(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field].unit.name," ")}}function Ci(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field].state.name," ")}}function fi(t,i){if(t&1&&d(0,gi,1,1)(1,Ci,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="administrator"?0:e==="agreementState"?1:-1)}}function hi(t,i){if(t&1&&(p(0),y(1,"customFormatDate")),t&2){let e=o(4).$implicit;C(" ",Ae(1,1,e.subscribedAt)," ")}}function vi(t,i){if(t&1&&d(0,hi,2,3),t&2){let e=o(3).$implicit;g(0,e.subscribedAt?0:-1)}}function bi(t,i){if(t&1&&(p(0),y(1,"customFormatDate")),t&2){let e=o(4).$implicit;C(" ",Ae(1,1,e.endedAt)," ")}}function xi(t,i){t&1&&p(0," Indefinido ")}function Ei(t,i){if(t&1&&d(0,bi,2,3)(1,xi,1,0),t&2){let e=o(3).$implicit;g(0,e.endedAt?0:1)}}function Si(t,i){if(t&1&&(p(0),y(1,"yesNo")),t&2){let e=o(3).$implicit;C(" ",Ae(1,1,e.isFinancing)," ")}}function Ai(t,i){t&1&&u(0,"p-tag",19)}function Li(t,i){t&1&&u(0,"p-tag",20)}function Ti(t,i){if(t&1&&d(0,Ai,1,0,"p-tag",19)(1,Li,1,0),t&2){let e=o(3).$implicit;g(0,e.enabled?0:1)}}function yi(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function Fi(t,i){if(t&1&&d(0,vi,1,1)(1,Ei,2,1)(2,Si,2,3)(3,Ti,2,1)(4,yi,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="subscribedAt"?0:e==="endedAt"?1:e==="isFinancing"?2:e==="enabled"?3:4)}}function Ii(t,i){if(t&1&&(l(0,"td"),d(1,fi,2,1)(2,Fi,5,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function Di(t,i){if(t&1){let e=x();l(0,"tr",17),L(1,Ii,3,2,"td",null,I),l(3,"td",15)(4,"p-button",18),b("click",function(){let a=f(e).$implicit,s=o();return h(s.selectItem(a))}),m()()()}if(t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex,s=o();c("pSelectableRow",e)("pSelectableRowIndex",a)("ngClass",Je(4,pi,!e.enabled)),r(),T(n),r(3),c("icon",s.PrimeIcons.ELLIPSIS_V)}}function wi(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function Bi(t,i){}function Mi(t,i){if(t&1&&u(0,"app-view",12),t&2){let e=o();c("id",e.selectedItem.id)}}var Qt=(()=>{let i=class i{constructor(){this.authService=_($),this.coreService=_(U),this.agreementsHttpService=_(Oe),this.agreementsService=_(ut),this.router=_(Qe),this.breadcrumbService=_(Z),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new te(""),this.items=[],this.isVisibleAgreementView=!1,this.breadcrumbService.setItems([{label:F.AGREEMENTS}]),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(n=>{this.findAgreements()})}ngOnInit(){this.findAgreements()}findAgreements(){this.authService.role.code===st.NATIONAL_MANAGER&&this.agreementsHttpService.findNationalManagerAgreementsByOrigin().subscribe(n=>{this.items=n}),this.authService.role.code===st.INTERNATIONAL_MANAGER&&this.agreementsHttpService.findInternationalManagerAgreementsByOrigin().subscribe(n=>{this.items=n})}buildColumns(){this.columns=[{field:"number",header:_e.number},{field:"internalNumber",header:_e.internalNumber},{field:"name",header:_e.name},{field:"administrator",header:ht.header},{field:"agreementState",header:Ze.state},{field:"subscribedAt",header:_e.subscribedAt},{field:"endedAt",header:_e.endedAt},{field:"isFinancing",header:_e.isFinancing},{field:"enabled",header:_e.enabled}]}buildButtonActions(){this.buttonActions=[{id:D.AGREEMENT,label:S.AGREEMENT,icon:A.AGREEMENT,command:()=>{this.selectedItem?.id&&this.redirectViewAgreement()}},{id:D.AGREEMENT_LOG,label:S.AGREEMENT_LOG,icon:A.AGREEMENT_LOG,command:()=>{this.selectedItem?.id&&this.redirectAgreementLogForm(this.selectedItem.id)}},{id:D.AGREEMENT_TRACKING_PERIOD,label:S.MANAGER_AGREEMENT_TRACKING_PERIOD,icon:A.MANAGER_AGREEMENT_TRACKING_PERIOD,command:()=>{this.selectedItem?.id&&this.redirectTrackingLogList(this.selectedItem.id)}},{id:D.AGREEMENT_CLOSING_MANAGEMENT_SUPERVISION,label:S.MANAGER_AGREEMENT_CLOSING_MANAGEMENT_SUPERVISION,icon:A.MANAGER_AGREEMENT_CLOSING_MANAGEMENT_SUPERVISION,command:()=>{this.selectedItem?.id&&this.redirectAgreementTerminationList(this.selectedItem.id)}},{id:D.MANAGER_AGREEMENT_CLOSED,label:S.MANAGER_AGREEMENT_CLOSED,icon:A.MANAGER_AGREEMENT_CLOSED,command:()=>{this.selectedItem?.id&&this.redirectClosedAgreement(this.selectedItem.id)}}]}validateButtonActions(n){this.buildButtonActions()}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}redirectViewAgreement(){this.isVisibleAgreementView=!0}redirectAgreementLogForm(n){this.router.navigate(["/core/agreements/log",n])}redirectTrackingLogList(n){this.router.navigate([`/core/${this.authService.role.code}/period-list`,n])}remove(n){}paginate(n){}selectItem(n){this.agreementsHttpService.findOne(n.id).subscribe(a=>{this.isButtonActions=!0,this.selectedItem=n,this.validateButtonActions(n),this.agreementsService.agreement=a})}redirectAgreementTerminationList(n){this.router.navigate([`/core/${this.authService.role.code}/agreement-termination-list`,n],{queryParams:{type:"closing"}})}redirectClosedAgreement(n){this.router.navigate([`/core/${this.authService.role.code}/closed-agreement`,n])}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-agreement-list"]],decls:14,vars:14,consts:[["dt",""],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Convenio",3,"visibleChange","visible","modal"],[3,"id"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex","ngClass"],[3,"click","icon"],["severity","info","value","Registrado"],["severity","danger","value","En Proceso"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar")(1,"div",1)(2,"p-button",2),b("click",function(){return f(E),h(s.redirectCreateForm())}),m()(),u(3,"div",3),m(),l(4,"p-table",4,0),d(6,di,3,1,"ng-template",5)(7,ui,5,1,"ng-template",6)(8,Di,5,6,"ng-template",7)(9,wi,3,2,"ng-template",8)(10,Bi,0,0,"ng-template",9),m(),l(11,"app-button-action",10),b("isHide",function(v){return f(E),h(s.isButtonActions=!v)}),m(),l(12,"p-dialog",11),N("visibleChange",function(v){return f(E),V(s.isVisibleAgreementView,v)||(s.isVisibleAgreementView=v),h(v)}),d(13,Mi,1,1,"app-view",12),m()}a&2&&(r(2),c("icon",s.IconButtonActionEnum.CREATE)("label",s.LabelButtonActionEnum.CREATE_AGREEMENT)("loading",s.coreService.isLoading)("severity",s.SeverityButtonActionEnum.CREATE),r(2),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading),r(7),c("buttonActions",s.buttonActions)("enabled",s.isButtonActions),r(),P("visible",s.isVisibleAgreementView),c("modal",!0),r(),g(13,s.selectedItem&&s.isVisibleAgreementView?13:-1))},dependencies:[dt,Ee,H,re,K,q,ie,oe,ne,Ht,xe,Kt,Et,He],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();function ki(t,i){if(t&1&&(l(0,"div",10)(1,"h2"),p(2),y(3,"customFormatDate"),y(4,"customFormatDate"),m()()),t&2){let e=o();r(2),pt(" ",e.period.name,": ",Ae(3,3,e.period.startedAt)," - ",Ae(4,5,e.period.endedAt)," ")}}function Pi(t,i){if(t&1&&(l(0,"th",11),p(1),u(2,"p-sortIcon",12),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function Vi(t,i){if(t&1&&(l(0,"tr"),L(1,Pi,3,3,"th",11,I),m()),t&2){let e=i.$implicit;r(),T(e)}}function Ni(t,i){if(t&1&&(u(0,"br"),l(1,"b"),p(2,"Comentario: "),m(),p(3)),t&2){let e=o(4).$implicit;r(3),C("",e.observation," ")}}function Ri(t,i){if(t&1&&(p(0),d(1,Ni,4,1)),t&2){let e=o(3).$implicit;le(" ",e.user.name," ",e.user.lastname," "),r(),g(1,e.observation?1:-1)}}function Oi(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;C(" ",e.state.name," ")}}function Hi(t,i){if(t&1&&d(0,Ri,2,3)(1,Oi,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="user"?0:e==="state"?1:-1)}}function $i(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(4).$implicit;C(" ",k(1,1,e.registeredAt,"dd/MM/yy - HH:mm")," ")}}function Gi(t,i){if(t&1&&d(0,$i,2,4),t&2){let e=o(3).$implicit;g(0,e.registeredAt?0:-1)}}function Ui(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function Wi(t,i){if(t&1&&d(0,Gi,1,1)(1,Ui,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="registeredAt"?0:1)}}function zi(t,i){if(t&1&&(l(0,"td"),d(1,Hi,2,1)(2,Wi,2,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function Ki(t,i){if(t&1&&(l(0,"tr",13),L(1,zi,3,2,"td",null,I),m()),t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex;c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n)}}function qi(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function ji(t,i){}var Ue=(()=>{let i=class i{constructor(){this.authService=_($),this.coreService=_(U),this.router=_(Qe),this.trackingLogsHttpService=_(ge),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.columns=[],this.search=new te(""),this.items=[],this.isVisibleAgreementView=!1,this.buildColumns()}ngOnInit(){this.items=this.period.trackingLogs}buildColumns(){this.columns=[{field:"state",header:pe.state},{field:"registeredAt",header:pe.registeredAt},{field:"user",header:pe.user}]}redirectAgreementLogForm(n){this.router.navigate(["/core/agreements/log",n])}downloadLog(){this.trackingLogsHttpService.downloadLog(this.period.id,this.trackingLogType)}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-tracking-log-list"]],inputs:{period:"period",trackingLogType:"trackingLogType"},decls:11,vars:9,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"flex"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar")(1,"div",1)(2,"p-button",2),b("click",function(){return f(E),h(s.downloadLog())}),m()(),u(3,"div",3),m(),l(4,"p-table",4,0),d(6,ki,5,7,"ng-template",5)(7,Vi,3,0,"ng-template",6)(8,Ki,3,2,"ng-template",7)(9,qi,3,2,"ng-template",8)(10,ji,0,0,"ng-template",9),m()}a&2&&(r(2),c("icon",s.IconButtonActionEnum.DOWNLOAD)("label",s.LabelButtonActionEnum.DOWNLOAD)("loading",s.coreService.isLoading)("severity",s.SeverityButtonActionEnum.SYNC),r(2),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading))},dependencies:[H,re,K,q,ie,oe,ne,Q,He],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var Ji=()=>({width:"50rem"});function Qi(t,i){if(t&1&&(l(0,"div",15)(1,"h2"),p(2),m()()),t&2){let e=o();r(2),B(e.BreadcrumbEnum.ADDITIONAL_DOCUMENTS)}}function Xi(t,i){if(t&1&&(l(0,"th",16),p(1),u(2,"p-sortIcon",17),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function Zi(t,i){if(t&1&&(l(0,"tr"),L(1,Xi,3,3,"th",16,I),m()),t&2){let e=i.$implicit;r(),T(e)}}function en(t,i){if(t&1&&p(0),t&2){let e=o(4).$implicit;le(" ",e.user.name," ",e.user.lastname," ")}}function tn(t,i){if(t&1&&d(0,en,1,2),t&2){let e=o(3).$implicit;g(0,e!=null&&e.user?0:-1)}}function nn(t,i){if(t&1&&d(0,tn,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="user"?0:-1)}}function on(t,i){if(t&1){let e=x();l(0,"span"),p(1),m(),l(2,"p-button",19),b("click",function(){let a=f(e).$implicit,s=o(5);return h(s.downloadFile(a))}),m(),u(3,"p-divider")}if(t&2){let e=i.$implicit,n=o(5);r(),C("",e.type.name,": "),r(),c("icon",n.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",n.SeverityButtonActionEnum.DOWNLOAD)}}function rn(t,i){if(t&1&&L(0,on,4,5,null,null,I),t&2){let e=o(3).$implicit;T(e==null?null:e.additionalDocuments)}}function ln(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;le(" ",e.name," ",e.sequence," ")}}function an(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;C(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function sn(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function mn(t,i){if(t&1&&d(0,rn,2,0)(1,ln,1,2)(2,an,2,4)(3,sn,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="additionalDocuments"?0:e==="name"?1:e==="uploadedAt"?2:3)}}function cn(t,i){if(t&1&&(l(0,"td"),d(1,nn,1,1)(2,mn,4,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function pn(t,i){if(t&1&&(l(0,"tr",18),L(1,cn,3,2,"td",null,I),m()),t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex;c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n)}}function dn(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function _n(t,i){}function un(t,i){if(t&1&&(u(0,"i"),l(1,"div",32),p(2),m()),t&2){let e=o(3);G(e.PrimeIcons.FILE_PDF),r(2),B(e.reportFileField.value==null?null:e.reportFileField.value.name)}}function gn(t,i){t&1&&(l(0,"div",25)(1,"p-messages",30),d(2,un,3,3,"ng-template",31),m()())}function Cn(t,i){if(t&1&&(u(0,"i"),l(1,"div",32),p(2),m()),t&2){let e=o(3);G(e.PrimeIcons.FILE_PDF),r(2),B(e.evidenceFileField.value==null?null:e.evidenceFileField.value.name)}}function fn(t,i){t&1&&(l(0,"div",25)(1,"p-messages",30),d(2,Cn,3,3,"ng-template",31),m()())}function hn(t,i){if(t&1){let e=x();l(0,"form",20)(1,"div",21),u(2,"label",22),l(3,"p-fileUpload",23,1),b("uploadHandler",function(a){f(e);let s=We(4),E=o();return h(E.uploadReportFile(a,s))}),m(),u(5,"small",24),m(),d(6,gn,3,0,"div",25),l(7,"div",21),u(8,"label",26),l(9,"p-fileUpload",27,1),b("uploadHandler",function(a){f(e);let s=We(4),E=o();return h(E.uploadEvidenceFile(a,s))}),m(),u(11,"small",24),m(),d(12,fn,3,0,"div",25),l(13,"div",25),u(14,"label",28)(15,"textarea",29)(16,"small",24),m()()}if(t&2){let e=o();c("formGroup",e.form),r(2),c("label",e.AdditionalDocumentEnum.reportFile)("required",e.reportFileField),r(),c("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),r(2),c("errors",e.reportFileField.errors)("touched",e.reportFileField.touched)("dirty",e.reportFileField.dirty),r(),g(6,e.reportFileField.value?6:-1),r(2),c("label",e.AdditionalDocumentEnum.evidenceFile)("required",e.evidenceFileField),r(),c("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),r(2),c("errors",e.evidenceFileField.errors)("touched",e.evidenceFileField.touched)("dirty",e.evidenceFileField.dirty),r(),g(12,e.evidenceFileField.value?12:-1),r(2),c("label",e.AdditionalDocumentEnum.detail)("required",e.detailField),r(2),c("errors",e.detailField.errors)("touched",e.detailField.touched)("dirty",e.detailField.dirty)}}function vn(t,i){if(t&1){let e=x();l(0,"p-button",33),b("click",function(){f(e);let a=o();return h(a.isVisibleFilesModal=!1)}),m(),l(1,"p-button",34),b("click",function(){f(e);let a=o();return h(a.onUpload())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("icon",e.IconButtonActionEnum.REPORT)("label",e.LabelButtonActionEnum.REPORT)("severity",e.SeverityButtonActionEnum.REPORT)}}var ei=(()=>{let i=class i{constructor(){this.authService=_($),this.coreService=_(U),this.formBuilder=_(ve),this.cataloguesHttpService=_(se),this.trackingLogsHttpService=_(ge),this.filesHttpService=_(ue),this.confirmationService=_(Xe),this.breadcrumbService=_(Z),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new te(""),this.items=[],this.formErrors=[],this.types=[],this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Te,this.CatalogueTrackingLogsStateEnum=ce,this.AdditionalDocumentEnum=Me,this.FileEnum=Re,this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(n=>{this.findAdditionalDocumentsByAgreement()})}ngOnInit(){this.findAdditionalDocumentsByAgreement(),this.loadTypes()}buildForm(){this.form=this.formBuilder.group({reportFile:[null],evidenceFile:[null],detail:[null,ae.required]})}findAdditionalDocumentsByAgreement(){this.trackingLogsHttpService.findExecutionAdditionalDocumentsByAgreement(this.agreementId).subscribe(n=>{this.items=n})}loadTypes(){this.types=this.cataloguesHttpService.findByType(me.PERIODS_TRACKING_LOG)}buildColumns(){this.columns=[{field:"name",header:Me.name},{field:"detail",header:Me.detail},{field:"additionalDocuments",header:Me.additionalDocuments},{field:"uploadedAt",header:Me.uploadedAt},{field:"user",header:Me.user}]}buildButtonActions(){this.buttonActions=[{id:D.TRACKING_LOG,label:S.TRACKING_LOG,icon:A.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}}]}validateButtonActions(n){this.buildButtonActions()}remove(n){this.confirmationService.confirm({key:"confirmDialog",message:"No se podr\xE1 recuperar la informaci\xF3n",header:"\xBFEst\xE1 seguro de eliminar?",icon:R.TRASH,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.trackingLogsHttpService.deleteAdditionalDocument(n).subscribe(a=>{this.findAdditionalDocumentsByAgreement()})}})}selectItem(n){this.isButtonActions=!0,this.selectedItem=n,this.validateButtonActions(n)}showFilesModal(){this.isVisibleFilesModal=!0}downloadFile(n){this.filesHttpService.downloadFile(n)}onUpload(){if(this.validateFilesForm()){let n=new FormData;n.append("report",this.reportFileField.value),n.append("evidence",this.evidenceFileField.value),n.append("detail",this.detailField.value),this.trackingLogsHttpService.createExecutionAdditionalDocument(this.agreementId,n).subscribe(a=>{this.findAdditionalDocumentsByAgreement(),this.isVisibleFilesModal=!1})}else this.messageDialogService.fieldErrors(this.formErrors)}validateFilesForm(){return this.formErrors=[],this.reportFileField.invalid&&this.formErrors.push(w.reportFile),this.evidenceFileField.invalid&&this.formErrors.push(w.evidenceFile),this.formErrors.length===0}uploadReportFile(n,a){this.reportFileField.patchValue(n.files[0]),a.clear()}uploadEvidenceFile(n,a){this.evidenceFileField.patchValue(n.files[0]),a.clear()}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}get detailField(){return this.form.controls.detail}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-additional-document-list"]],inputs:{agreementId:"agreementId"},decls:15,vars:12,consts:[["dt",""],["uploadFiles",""],[1,"p-toolbar-group-left"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Subir archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["key","confirmDialog"],[1,"flex"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[1,"ml-2",3,"click","icon","label","text","severity"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","report",3,"label","required"],["id","report","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","evidence",3,"label","required"],["id","evidence","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appLabel","","for","detail",3,"label","required"],["pInputTextarea","","id","detail","formControlName","detail"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar"),u(1,"div",2)(2,"div",3),m(),l(3,"p-table",4,0),d(5,Qi,3,1,"ng-template",5)(6,Zi,3,0,"ng-template",6)(7,pn,3,2,"ng-template",7)(8,dn,3,2,"ng-template",8)(9,_n,0,0,"ng-template",9),m(),l(10,"app-button-action",10),b("isHide",function(v){return f(E),h(s.isButtonActions=!v)}),m(),l(11,"p-dialog",11),N("visibleChange",function(v){return f(E),V(s.isVisibleFilesModal,v)||(s.isVisibleFilesModal=v),h(v)}),d(12,hn,17,28,"ng-template",12)(13,vn,2,7,"ng-template",13),m(),u(14,"p-confirmDialog",14)}a&2&&(r(3),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading),r(7),c("buttonActions",s.buttonActions)("enabled",s.isButtonActions),r(),j(Y(11,Ji)),P("visible",s.isVisibleFilesModal),c("modal",!0))},dependencies:[De,be,Ee,H,re,K,he,ye,Ce,fe,q,ie,oe,ne,Fe,Ie,xe,$e,it,de,we,Ut,Q],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var xn=()=>({width:"100%"}),ti=()=>({width:"35rem"});function En(t,i){if(t&1&&(l(0,"div",20)(1,"h1"),p(2),m()()),t&2){let e=o();r(2),B(e.BreadcrumbEnum.PERIODS_SUPERVISOR)}}function Sn(t,i){if(t&1&&(l(0,"th",21),p(1),u(2,"p-sortIcon",23),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function An(t,i){if(t&1&&(l(0,"tr"),L(1,Sn,3,3,"th",21,I),l(3,"th",22),p(4),m()()),t&2){let e=i.$implicit,n=o();r(),T(e),r(3),C(" ",n.TableEnum.ACTIONS," ")}}function Ln(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field].unit.name," ")}}function Tn(t,i){if(t&1&&d(0,Ln,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="administrator"?0:-1)}}function yn(t,i){if(t&1){let e=x();l(0,"span"),p(1),m(),l(2,"p-button",26),b("click",function(){let a=f(e).$implicit,s=o(5);return h(s.downloadFile(a))}),m(),u(3,"p-divider")}if(t&2){let e=i.$implicit,n=o(5);r(),C("",e.type.name,": "),r(),c("icon",n.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",n.SeverityButtonActionEnum.DOWNLOAD)}}function Fn(t,i){if(t&1&&L(0,yn,4,5,null,null,I),t&2){let e=o(3).$implicit;T(e==null?null:e.trackingLogDocuments)}}function In(t,i){if(t&1&&u(0,"i",28),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function Dn(t,i){if(t&1&&u(0,"i",29),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function wn(t,i){if(t&1&&d(0,In,1,2,"i",27)(1,Dn,1,2),t&2){let e=o(4).$implicit;g(0,e.trackingLog.state.code==="REPORTED"||e.trackingLog.state.code==="ACCEPTED"?0:1)}}function Bn(t,i){if(t&1&&u(0,"i",29),t&2){let e=o(5);G(e.PrimeIcons.CIRCLE_FILL)}}function Mn(t,i){if(t&1&&d(0,wn,2,1)(1,Bn,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog?0:1)}}function kn(t,i){if(t&1&&(p(0),u(1,"br"),p(2),y(3,"date"),u(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;C(" ",e.name," "),r(2),C(" ",k(3,3,e.startedAt,"d MMMM y")," - "),r(3),C(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function Pn(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;C(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function Vn(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;C(" ",e.trackingLog==null||e.trackingLog.state==null?null:e.trackingLog.state.name," ")}}function Nn(t,i){if(t&1&&p(0),t&2){let e=o(4).$implicit;le(" ",e.trackingLog.user.name," ",e.trackingLog.user.lastname," ")}}function Rn(t,i){if(t&1&&d(0,Nn,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog!=null&&e.trackingLog.user?0:-1)}}function On(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function Hn(t,i){if(t&1&&d(0,Fn,2,0)(1,Mn,2,1)(2,kn,7,9)(3,Pn,2,4)(4,Vn,1,1)(5,Rn,1,1)(6,On,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="files"?0:e==="trafficLight"?1:e==="name"?2:e==="uploadedAt"?3:e==="state"?4:e==="user"?5:6)}}function $n(t,i){if(t&1&&(l(0,"td"),d(1,Tn,1,1)(2,Hn,7,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function Gn(t,i){if(t&1){let e=x();l(0,"tr",24),L(1,$n,3,2,"td",null,I),l(3,"td",22)(4,"p-button",25),b("click",function(){let a=f(e).$implicit,s=o();return h(s.selectItem(a))}),m()()()}if(t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex,s=o();c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n),r(3),c("icon",s.PrimeIcons.ELLIPSIS_V)}}function Un(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function Wn(t,i){}function zn(t,i){if(t&1&&u(0,"app-tracking-log-list",12),t&2){let e=o();c("period",e.selectedItem)}}function Kn(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de rechazar, no podr\xE1 modificar su elecci\xF3n?"),m())}function qn(t,i){if(t&1){let e=x();l(0,"p-button",30),b("click",function(){f(e);let a=o();return h(a.isVisibleRefusedModal=!1)}),m(),l(1,"p-button",31),b("click",function(){f(e);let a=o();return h(a.refuseTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.REFUSED)("icon",e.IconButtonActionEnum.REFUSED)("severity",e.SeverityButtonActionEnum.REFUSED)}}function jn(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de aceptar, no podr\xE1 modificar su elecci\xF3n?"),m())}function Yn(t,i){if(t&1){let e=x();l(0,"p-button",30),b("click",function(){f(e);let a=o();return h(a.isVisibleAcceptedModal=!1)}),m(),l(1,"p-button",31),b("click",function(){f(e);let a=o();return h(a.acceptTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.ACCEPTED)("icon",e.IconButtonActionEnum.ACCEPTED)("severity",e.SeverityButtonActionEnum.REFUSED)}}var ii=(()=>{let i=class i{constructor(){this.activatedRoute=_(Ne),this.authService=_($),this.coreService=_(U),this.formBuilder=_(ve),this.cataloguesHttpService=_(se),this.trackingLogsHttpService=_(ge),this.filesHttpService=_(ue),this.breadcrumbService=_(Z),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new te(""),this.items=[],this.formErrors=[],this.types=[],this.trackingLogType="execution",this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.isVisibleRefusedModal=!1,this.isVisibleAcceptedModal=!1,this.AddendumEnum=Te,this.breadcrumbService.setItems([{label:F.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:F.PERIODS_SUPERVISOR}]),this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(n=>{this.findPeriodsByAgreement()})}ngOnInit(){this.findPeriodsByAgreement(),this.loadTypes()}buildForm(){this.form=this.formBuilder.group({reportFile:[null,ae.required],evidenceFile:[null],observation:[null,ae.required]})}findPeriodsByAgreement(){console.log(this.trackingLogType),this.trackingLogsHttpService.findPeriodsByAgreement(this.agreementId,this.trackingLogType).subscribe(n=>{this.items=n})}loadTypes(){this.types=this.cataloguesHttpService.findByType(me.PERIODS_TRACKING_LOG)}buildColumns(){this.columns=[{field:"name",header:w.reportPeriod},{field:"documentName",header:w.name},{field:"files",header:w.documentName},{field:"trafficLight",header:w.trafficLight},{field:"uploadedAt",header:w.uploadedAt},{field:"user",header:w.user},{field:"state",header:w.state}]}buildButtonActions(){this.buttonActions=[{id:D.TRACKING_LOG,label:S.TRACKING_LOG,icon:A.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}},{id:D.ACCEPTED,label:S.ACCEPTED,icon:A.ACCEPTED,command:()=>{this.isVisibleAcceptedModal=!0}},{id:D.REFUSED,label:S.REFUSED,icon:A.REFUSED,command:()=>{this.isVisibleRefusedModal=!0}}]}validateButtonActions(n){this.buildButtonActions(),(!n.trackingLog||n.trackingLog.state?.code===ce.ACCEPTED||n.trackingLog.state?.code===ce.REFUSED)&&(this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.ACCEPTED),1),this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.REFUSED),1))}selectItem(n){this.isButtonActions=!0,this.selectedItem=n,this.validateButtonActions(n)}downloadFile(n){this.filesHttpService.downloadFile(n)}refuseTrackingLogDocuments(){this.observationFileField.valid?this.trackingLogsHttpService.changeState(this.selectedItem.trackingLog.id,!1,this.observationFileField.value).subscribe(()=>{this.findPeriodsByAgreement(),this.isVisibleRefusedModal=!1}):(this.form.markAllAsTouched(),this.formErrors=[pe.observation],this.messageDialogService.fieldErrors(this.formErrors))}acceptTrackingLogDocuments(){this.trackingLogsHttpService.changeState(this.selectedItem.trackingLog.id,!0).subscribe(()=>{this.findPeriodsByAgreement(),this.isVisibleAcceptedModal=!1})}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}get observationFileField(){return this.form.controls.observation}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-period-list"]],inputs:{agreementId:"agreementId"},decls:25,vars:29,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],[3,"agreementId"],["header","Bit\xE1cora",3,"visibleChange","visible","modal"],["trackingLogType","execution",3,"period"],["header","Header",3,"visibleChange","visible","modal"],[1,"grid","p-fluid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","observation","label","Observaci\xF3n",3,"required"],["pInputTextarea","","id","observation","formControlName","observation"],["appErrorMessage","",3,"errors","touched","dirty"],["pTemplate","footer"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[3,"click","label","icon","text","severity"],[3,"click","label","icon","severity"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar"),u(1,"div",1)(2,"div",2),m(),l(3,"p-table",3,0),d(5,En,3,1,"ng-template",4)(6,An,5,1,"ng-template",5)(7,Gn,5,3,"ng-template",6)(8,Un,3,2,"ng-template",7)(9,Wn,0,0,"ng-template",8),m(),l(10,"app-button-action",9),b("isHide",function(v){return f(E),h(s.isButtonActions=!v)}),m(),u(11,"app-additional-document-list",10),l(12,"p-dialog",11),N("visibleChange",function(v){return f(E),V(s.isVisibleTrackingLogModal,v)||(s.isVisibleTrackingLogModal=v),h(v)}),d(13,zn,1,1,"app-tracking-log-list",12),m(),l(14,"p-dialog",13),N("visibleChange",function(v){return f(E),V(s.isVisibleRefusedModal,v)||(s.isVisibleRefusedModal=v),h(v)}),d(15,Kn,2,0,"ng-template",5),l(16,"form",14)(17,"div",15),u(18,"label",16)(19,"textarea",17)(20,"small",18),m()(),d(21,qn,2,7,"ng-template",19),m(),l(22,"p-dialog",13),N("visibleChange",function(v){return f(E),V(s.isVisibleAcceptedModal,v)||(s.isVisibleAcceptedModal=v),h(v)}),d(23,jn,2,0,"ng-template",5)(24,Yn,2,7,"ng-template",19),m()}a&2&&(r(3),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading),r(7),c("buttonActions",s.buttonActions)("enabled",s.isButtonActions),r(),c("agreementId",s.agreementId),r(),j(Y(26,xn)),P("visible",s.isVisibleTrackingLogModal),c("modal",!0),r(),g(13,s.isVisibleTrackingLogModal?13:-1),r(),j(Y(27,ti)),P("visible",s.isVisibleRefusedModal),c("modal",!0),r(2),c("formGroup",s.form),r(2),c("required",s.observationFileField),r(2),c("errors",s.observationFileField.errors)("touched",s.observationFileField.touched)("dirty",s.observationFileField.dirty),r(2),j(Y(28,ti)),P("visible",s.isVisibleAcceptedModal),c("modal",!0))},dependencies:[De,be,Ee,H,re,K,he,ye,Ce,fe,q,ie,oe,ne,Fe,Ie,xe,de,we,Ue,ei,Q],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var Jn=()=>({width:"100%"}),ni=()=>({width:"35rem"});function Qn(t,i){if(t&1&&(l(0,"div",19)(1,"h1"),p(2),m()()),t&2){let e=o();r(2),B(e.BreadcrumbEnum.PERIODS_CLOSING_SUPERVISOR)}}function Xn(t,i){if(t&1&&(l(0,"th",20),p(1),u(2,"p-sortIcon",22),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function Zn(t,i){if(t&1&&(l(0,"tr"),L(1,Xn,3,3,"th",20,I),l(3,"th",21),p(4),m()()),t&2){let e=i.$implicit,n=o();r(),T(e),r(3),C(" ",n.TableEnum.ACTIONS," ")}}function eo(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field].unit.name," ")}}function to(t,i){if(t&1&&d(0,eo,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="administrator"?0:-1)}}function io(t,i){if(t&1){let e=x();l(0,"span"),p(1),m(),l(2,"p-button",25),b("click",function(){let a=f(e).$implicit,s=o(5);return h(s.downloadFile(a))}),m(),u(3,"p-divider")}if(t&2){let e=i.$implicit,n=o(5);r(),C("",e.type.name,": "),r(),c("icon",n.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",n.SeverityButtonActionEnum.DOWNLOAD)}}function no(t,i){if(t&1&&L(0,io,4,5,null,null,I),t&2){let e=o(3).$implicit;T(e==null?null:e.trackingLogDocuments)}}function oo(t,i){if(t&1&&u(0,"i",27),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function ro(t,i){if(t&1&&u(0,"i",28),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function lo(t,i){if(t&1&&d(0,oo,1,2,"i",26)(1,ro,1,2),t&2){let e=o(4).$implicit;g(0,e.trackingLog.state.code==="REPORTED"||e.trackingLog.state.code==="ACCEPTED"?0:1)}}function ao(t,i){if(t&1&&u(0,"i",28),t&2){let e=o(5);G(e.PrimeIcons.CIRCLE_FILL)}}function so(t,i){if(t&1&&d(0,lo,2,1)(1,ao,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog?0:1)}}function mo(t,i){if(t&1&&(p(0),u(1,"br"),p(2),y(3,"date"),u(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;C(" ",e.name," "),r(2),C(" ",k(3,3,e.startedAt,"d MMMM y")," - "),r(3),C(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function co(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;C(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function po(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;C(" ",e.trackingLog==null||e.trackingLog.state==null?null:e.trackingLog.state.name," ")}}function _o(t,i){if(t&1&&p(0),t&2){let e=o(4).$implicit;le(" ",e.trackingLog.user.name," ",e.trackingLog.user.lastname," ")}}function uo(t,i){if(t&1&&d(0,_o,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog!=null&&e.trackingLog.user?0:-1)}}function go(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function Co(t,i){if(t&1&&d(0,no,2,0)(1,so,2,1)(2,mo,7,9)(3,co,2,4)(4,po,1,1)(5,uo,1,1)(6,go,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="files"?0:e==="trafficLight"?1:e==="name"?2:e==="uploadedAt"?3:e==="state"?4:e==="user"?5:6)}}function fo(t,i){if(t&1&&(l(0,"td"),d(1,to,1,1)(2,Co,7,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function ho(t,i){if(t&1){let e=x();l(0,"tr",23),L(1,fo,3,2,"td",null,I),l(3,"td",21)(4,"p-button",24),b("click",function(){let a=f(e).$implicit,s=o();return h(s.selectItem(a))}),m()()()}if(t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex,s=o();c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n),r(3),c("icon",s.PrimeIcons.ELLIPSIS_V)}}function vo(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function bo(t,i){}function xo(t,i){if(t&1&&u(0,"app-tracking-log-list",11),t&2){let e=o();c("period",e.selectedItem)}}function Eo(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de rechazar, no podr\xE1 modificar su elecci\xF3n?"),m())}function So(t,i){if(t&1){let e=x();l(0,"p-button",29),b("click",function(){f(e);let a=o();return h(a.isVisibleRefusedModal=!1)}),m(),l(1,"p-button",30),b("click",function(){f(e);let a=o();return h(a.refuseTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.REFUSED)("icon",e.IconButtonActionEnum.REFUSED)("severity",e.SeverityButtonActionEnum.REFUSED)}}function Ao(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de aceptar, no podr\xE1 modificar su elecci\xF3n?"),m())}function Lo(t,i){if(t&1){let e=x();l(0,"p-button",29),b("click",function(){f(e);let a=o();return h(a.isVisibleAcceptedModal=!1)}),m(),l(1,"p-button",30),b("click",function(){f(e);let a=o();return h(a.acceptTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.ACCEPTED)("icon",e.IconButtonActionEnum.ACCEPTED)("severity",e.SeverityButtonActionEnum.REFUSED)}}var oi=(()=>{let i=class i{constructor(){this.activatedRoute=_(Ne),this.authService=_($),this.coreService=_(U),this.formBuilder=_(ve),this.cataloguesHttpService=_(se),this.trackingLogsHttpService=_(ge),this.filesHttpService=_(ue),this.breadcrumbService=_(Z),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new te(""),this.items=[],this.formErrors=[],this.types=[],this.trackingLogType="closing",this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.isVisibleRefusedModal=!1,this.isVisibleAcceptedModal=!1,this.AddendumEnum=Te,this.breadcrumbService.setItems([{label:F.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:F.PERIODS_CLOSING_SUPERVISOR}]),this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(n=>{this.findPeriodsByAgreement()})}ngOnInit(){this.findPeriodsByAgreement(),this.loadTypes(),this.activatedRoute.queryParams.subscribe(n=>{this.trackingLogType=n.type})}buildForm(){this.form=this.formBuilder.group({reportFile:[null,ae.required],evidenceFile:[null],observation:[null,ae.required]})}findPeriodsByAgreement(){this.trackingLogsHttpService.findPeriodsByAgreement(this.agreementId,this.trackingLogType).subscribe(n=>{this.items=n})}loadTypes(){this.types=this.cataloguesHttpService.findByType(me.PERIODS_TRACKING_LOG)}buildColumns(){this.columns=[{field:"name",header:w.reportPeriod},{field:"documentName",header:w.name},{field:"files",header:w.documentName},{field:"trafficLight",header:w.trafficLight},{field:"uploadedAt",header:w.uploadedAt},{field:"user",header:w.user},{field:"state",header:w.state}]}buildButtonActions(){this.buttonActions=[{id:D.TRACKING_LOG,label:S.TRACKING_LOG,icon:A.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}},{id:D.ACCEPTED,label:S.ACCEPTED,icon:A.ACCEPTED,command:()=>{this.isVisibleAcceptedModal=!0}},{id:D.REFUSED,label:S.REFUSED,icon:A.REFUSED,command:()=>{this.isVisibleRefusedModal=!0}}]}validateButtonActions(n){this.buildButtonActions(),(!n.trackingLog||n.trackingLog.state?.code===ce.ACCEPTED||n.trackingLog.state?.code===ce.REFUSED)&&(this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.ACCEPTED),1),this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.REFUSED),1))}selectItem(n){this.isButtonActions=!0,this.selectedItem=n,this.validateButtonActions(n)}downloadFile(n){this.filesHttpService.downloadFile(n)}refuseTrackingLogDocuments(){this.observationFileField.valid?this.trackingLogsHttpService.changeState(this.selectedItem.trackingLog.id,!1,this.observationFileField.value).subscribe(()=>{this.findPeriodsByAgreement(),this.isVisibleRefusedModal=!1,this.observation=""}):(this.form.markAllAsTouched(),this.formErrors=["Observaci\xF3n"],this.messageDialogService.fieldErrors(this.formErrors))}acceptTrackingLogDocuments(){this.trackingLogsHttpService.changeState(this.selectedItem.trackingLog.id,!0).subscribe(()=>{this.findPeriodsByAgreement(),this.isVisibleAcceptedModal=!1})}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}get observationFileField(){return this.form.controls.observation}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-period-closing-list"]],inputs:{agreementId:"agreementId"},decls:24,vars:28,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Bit\xE1cora",3,"visibleChange","visible","modal"],["trackingLogType","closing",3,"period"],["header","Header",3,"visibleChange","visible","modal"],[1,"grid","p-fluid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","observation","label","Observaci\xF3n",3,"required"],["pInputTextarea","","id","observation","formControlName","observation"],["appErrorMessage","",3,"errors","touched","dirty"],["pTemplate","footer"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[3,"click","label","icon","text","severity"],[3,"click","label","icon","severity"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar"),u(1,"div",1)(2,"div",2),m(),l(3,"p-table",3,0),d(5,Qn,3,1,"ng-template",4)(6,Zn,5,1,"ng-template",5)(7,ho,5,3,"ng-template",6)(8,vo,3,2,"ng-template",7)(9,bo,0,0,"ng-template",8),m(),l(10,"app-button-action",9),b("isHide",function(v){return f(E),h(s.isButtonActions=!v)}),m(),l(11,"p-dialog",10),N("visibleChange",function(v){return f(E),V(s.isVisibleTrackingLogModal,v)||(s.isVisibleTrackingLogModal=v),h(v)}),d(12,xo,1,1,"app-tracking-log-list",11),m(),l(13,"p-dialog",12),N("visibleChange",function(v){return f(E),V(s.isVisibleRefusedModal,v)||(s.isVisibleRefusedModal=v),h(v)}),d(14,Eo,2,0,"ng-template",5),l(15,"form",13)(16,"div",14),u(17,"label",15)(18,"textarea",16)(19,"small",17),m()(),d(20,So,2,7,"ng-template",18),m(),l(21,"p-dialog",12),N("visibleChange",function(v){return f(E),V(s.isVisibleAcceptedModal,v)||(s.isVisibleAcceptedModal=v),h(v)}),d(22,Ao,2,0,"ng-template",5)(23,Lo,2,7,"ng-template",18),m()}a&2&&(r(3),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading),r(7),c("buttonActions",s.buttonActions)("enabled",s.isButtonActions),r(),j(Y(25,Jn)),P("visible",s.isVisibleTrackingLogModal),c("modal",!0),r(),g(12,s.isVisibleTrackingLogModal?12:-1),r(),j(Y(26,ni)),P("visible",s.isVisibleRefusedModal),c("modal",!0),r(2),c("formGroup",s.form),r(2),c("required",s.observationFileField),r(2),c("errors",s.observationFileField.errors)("touched",s.observationFileField.touched)("dirty",s.observationFileField.dirty),r(2),j(Y(27,ni)),P("visible",s.isVisibleAcceptedModal),c("modal",!0))},dependencies:[De,be,Ee,H,re,K,he,ye,Ce,fe,q,ie,oe,ne,Fe,Ie,xe,de,we,Ue,Q],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();function yo(t,i){t&1&&u(0,"div",10)}function Fo(t,i){if(t&1&&(l(0,"th",11),p(1),u(2,"p-sortIcon",12),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function Io(t,i){if(t&1&&(l(0,"tr"),L(1,Fo,3,3,"th",11,I),m()),t&2){let e=i.$implicit;r(),T(e)}}function Do(t,i){if(t&1&&(u(0,"br"),l(1,"b"),p(2,"Comentario: "),m(),p(3)),t&2){let e=o(4).$implicit;r(3),C("",e.observation," ")}}function wo(t,i){if(t&1&&(p(0),d(1,Do,4,1)),t&2){let e=o(3).$implicit;le(" ",e.user.name," ",e.user.lastname," "),r(),g(1,e.observation?1:-1)}}function Bo(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;C(" ",e.state.name," ")}}function Mo(t,i){if(t&1&&d(0,wo,2,3)(1,Bo,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="user"?0:e==="state"?1:-1)}}function ko(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(4).$implicit;C(" ",k(1,1,e.registeredAt,"dd/MM/yy - HH:mm")," ")}}function Po(t,i){if(t&1&&d(0,ko,2,4),t&2){let e=o(3).$implicit;g(0,e.registeredAt?0:-1)}}function Vo(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function No(t,i){if(t&1&&d(0,Po,1,1)(1,Vo,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="registeredAt"?0:1)}}function Ro(t,i){if(t&1&&(l(0,"td"),d(1,Mo,2,1)(2,No,2,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function Oo(t,i){if(t&1&&(l(0,"tr",13),L(1,Ro,3,2,"td",null,I),m()),t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex;c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n)}}function Ho(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function $o(t,i){}var ri=(()=>{let i=class i{constructor(){this.authService=_($),this.coreService=_(U),this.closingLogsHttpService=_(et),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.columns=[],this.search=new te(""),this.items=[],this.isVisibleAgreementView=!1,this.buildColumns()}ngOnInit(){this.findClosingLogsByAgreement()}buildColumns(){this.columns=[{field:"state",header:pe.state},{field:"registeredAt",header:pe.registeredAt},{field:"user",header:pe.user}]}findClosingLogsByAgreement(){this.closingLogsHttpService.findClosingLogsByAgreement(this.agreementId).subscribe(n=>{n&&(this.items=n)})}downloadLog(){this.closingLogsHttpService.downloadLog(this.agreementId)}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-closing-log-list"]],inputs:{agreementId:"agreementId"},decls:11,vars:9,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"flex"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"]],template:function(a,s){if(a&1){let E=x();l(0,"p-toolbar")(1,"div",1)(2,"p-button",2),b("click",function(){return f(E),h(s.downloadLog())}),m()(),u(3,"div",3),m(),l(4,"p-table",4,0),d(6,yo,1,0,"ng-template",5)(7,Io,3,0,"ng-template",6)(8,Oo,3,2,"ng-template",7)(9,Ho,3,2,"ng-template",8)(10,$o,0,0,"ng-template",9),m()}a&2&&(r(2),c("icon",s.IconButtonActionEnum.DOWNLOAD)("label",s.LabelButtonActionEnum.DOWNLOAD)("loading",s.coreService.isLoading)("severity",s.SeverityButtonActionEnum.SYNC),r(2),c("value",s.items)("columns",s.columns)("paginator",!0)("rows",10)("loading",s.coreService.isLoading))},dependencies:[H,re,K,q,ie,oe,ne,Q],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var Uo=(t,i)=>i.id,Wo=()=>({width:"50rem"}),zo=()=>({width:"100%"}),li=()=>({width:"35rem"});function Ko(t,i){t&1&&(l(0,"div",25),p(1," Previo a reportar la documentaci\xF3n en la secciones GESTI\xD3N DE CIERRE DE CONVENIO \xE9stos (reportes de avence de cierre) deber\xE1 contar con todos los reportes en estado ACEPTADO. "),m())}function qo(t,i){t&1&&(l(0,"p-messages",20),d(1,Ko,2,0,"ng-template",24),m())}function jo(t,i){if(t&1){let e=x();l(0,"p-button",26),b("click",function(){f(e);let a=o(2);return h(a.openFilesModal())}),m()}if(t&2){let e=o(2);c("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.CREATE_CLOSING_LOG)("loading",e.coreService.isLoading)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function Yo(t,i){if(t&1&&(l(0,"h2"),p(1),m(),d(2,qo,2,0,"p-messages",20),l(3,"p-toolbar")(4,"div",21),d(5,jo,1,4,"p-button",22),m(),u(6,"div",23),m()),t&2){let e=o();r(),B(e.BreadcrumbEnum.CLOSING_LOG_ADMINISTRATOR),r(),g(2,!e.validPeriodsClosing&&e.closingNotification&&(e.closingNotification.closeType==null?null:e.closingNotification.closeType.code)===e.CatalogueClosingNotificationsCloseTypesDocumentEnum.TERM?2:-1),r(3),g(5,e.items.length===0?5:-1)}}function Jo(t,i){if(t&1&&(l(0,"th",27),p(1),u(2,"p-sortIcon",29),m()),t&2){let e=i.$implicit;c("pSortableColumn",e.field),r(),C(" ",e.header," "),r(),c("field",e.field)}}function Qo(t,i){if(t&1&&(l(0,"tr"),L(1,Jo,3,3,"th",27,I),l(3,"th",28),p(4),m()()),t&2){let e=i.$implicit,n=o();r(),T(e),r(3),C(" ",n.TableEnum.ACTIONS," ")}}function Xo(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field].unit.name," ")}}function Zo(t,i){if(t&1&&p(0),t&2){let e=o(4).$implicit;le(" ",e.user.name," ",e.user.lastname," ")}}function er(t,i){if(t&1&&d(0,Zo,1,2),t&2){let e=o(3).$implicit;g(0,e!=null&&e.user?0:-1)}}function tr(t,i){if(t&1&&p(0),t&2){let e=o(3).$implicit;C(" ",e==null||e.state==null?null:e.state.name," ")}}function ir(t,i){if(t&1&&d(0,Xo,1,1)(1,er,1,1)(2,tr,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="administrator"?0:e==="user"?1:e==="state"?2:-1)}}function nr(t,i){if(t&1&&(l(0,"span"),p(1),m(),u(2,"p-divider")),t&2){let e=i.$implicit;r(),C("",e.type.name,": ")}}function or(t,i){if(t&1&&L(0,nr,3,1,null,null,I),t&2){let e=o(3).$implicit;T(e==null?null:e.closingLogDocuments)}}function rr(t,i){if(t&1){let e=x();l(0,"p-button",32),b("click",function(){let a=f(e).$implicit,s=o(6);return h(s.downloadFile(a))}),m(),u(1,"p-divider")}if(t&2){let e=i.$implicit,n=o(6);c("icon",n.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",n.SeverityButtonActionEnum.DOWNLOAD)}}function lr(t,i){if(t&1&&L(0,rr,2,4,null,null,I),t&2){let e=o(4).$implicit;T(e==null?null:e.closingLogDocuments)}}function ar(t,i){if(t&1&&d(0,lr,2,0),t&2){let e=o(3).$implicit;g(0,e!=null&&e.closingLogDocuments?0:-1)}}function sr(t,i){if(t&1&&u(0,"i",34),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function mr(t,i){if(t&1&&u(0,"i",35),t&2){let e=o(6);G(e.PrimeIcons.CIRCLE_FILL)}}function cr(t,i){if(t&1&&d(0,sr,1,2,"i",33)(1,mr,1,2),t&2){let e=o(4).$implicit;g(0,e.state.code==="REPORTED"||e.state.code==="ACCEPTED"?0:1)}}function pr(t,i){if(t&1&&u(0,"i",35),t&2){let e=o(5);G(e.PrimeIcons.CIRCLE_FILL)}}function dr(t,i){if(t&1&&d(0,cr,2,1)(1,pr,1,2),t&2){let e=o(3).$implicit;g(0,e.closingLogDocuments?0:1)}}function _r(t,i){if(t&1&&(p(0),u(1,"br"),p(2),y(3,"date"),u(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;C(" ",e.name," "),r(2),C(" ",k(3,3,e.startedAt,"d MMMM y")," - "),r(3),C(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function ur(t,i){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;C(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function gr(t,i){if(t&1&&p(0),t&2){let e=o(2).$implicit,n=o().$implicit;C(" ",n[e.field]," ")}}function Cr(t,i){if(t&1&&d(0,or,2,0)(1,ar,1,1)(2,dr,2,1)(3,_r,7,9)(4,ur,2,4)(5,gr,1,1),t&2){let e,n=o().$implicit;g(0,(e=n.field)==="closingLogDocumentsUpload"?0:e==="closingLogDocuments"?1:e==="trafficLight"?2:e==="name"?3:e==="uploadedAt"?4:5)}}function fr(t,i){if(t&1&&(l(0,"td"),d(1,ir,3,1)(2,Cr,6,1),m()),t&2){let e=i.$implicit,n=o().$implicit;r(),g(1,n[e.field]!=null&&n[e.field].id?1:-1),r(),g(2,n[e.field]!=null&&n[e.field].id?-1:2)}}function hr(t,i){if(t&1){let e=x();l(0,"tr",30),L(1,fr,3,2,"td",null,I),l(3,"td",28)(4,"p-button",31),b("click",function(){let a=f(e).$implicit,s=o();return h(s.selectItem(a))}),m()()()}if(t&2){let e=i.$implicit,n=i.columns,a=i.rowIndex,s=o();c("pSelectableRow",e)("pSelectableRowIndex",a),r(),T(n),r(3),c("icon",s.PrimeIcons.ELLIPSIS_V)}}function vr(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m()()),t&2){let e=i.$implicit,n=o();r(),J("colspan",e.length),r(),C(" ",n.messageService.paginatorNoRecordsFound," ")}}function br(t,i){}function xr(t,i){if(t&1&&(u(0,"i"),l(1,"div",25),p(2),m()),t&2){let e=o(2).$index,n=o(2);G(n.PrimeIcons.FILE_PDF),r(2),B(n.files[e].file.name)}}function Er(t,i){t&1&&(l(0,"div",16)(1,"p-messages",40),d(2,xr,3,3,"ng-template",24),m()())}function Sr(t,i){if(t&1){let e=x();l(0,"div",16)(1,"label",37),p(2),l(3,"b",38),p(4,"*"),m()(),l(5,"p-fileUpload",39,1),b("uploadHandler",function(a){let s=f(e).$implicit,E=We(6),M=o(2);return h(M.onUpload(a,E,s))}),m(),u(7,"small",19),m(),d(8,Er,3,0,"div",16)}if(t&2){let e=i.$implicit,n=i.$index,a=o(2);r(),c("for",e.id),r(),C(" ",e.name," "),r(3),c("chooseIcon",a.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",a.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",a.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),r(2),c("errors",a.reportFileField.errors)("touched",a.reportFileField.touched)("dirty",a.reportFileField.dirty),r(),g(8,a.files.length>n?8:-1)}}function Ar(t,i){if(t&1&&(l(0,"div",36),L(1,Sr,9,11,null,null,Uo),m()),t&2){let e=o();r(),T(e.closeTypes)}}function Lr(t,i){if(t&1){let e=x();l(0,"p-button",41),b("click",function(){f(e);let a=o();return h(a.closeModal())}),m(),l(1,"p-button",42),b("click",function(){f(e);let a=o();return h(a.onSubmit())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.UPLOAD)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function Tr(t,i){if(t&1&&u(0,"app-closing-log-list",13),t&2){let e=o();c("agreementId",e.agreementId)}}function yr(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de rechazar, no podr\xE1 modificar su elecci\xF3n?"),m())}function Fr(t,i){if(t&1){let e=x();l(0,"p-button",41),b("click",function(){f(e);let a=o();return h(a.isVisibleRefusedModal=!1)}),m(),l(1,"p-button",43),b("click",function(){f(e);let a=o();return h(a.refuseTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.REFUSED)("icon",e.IconButtonActionEnum.REFUSED)("severity",e.SeverityButtonActionEnum.REFUSED)}}function Ir(t,i){t&1&&(l(0,"h3"),p(1,"\xBFEst\xE1 seguro de aceptar, no podr\xE1 modificar su elecci\xF3n?"),m())}function Dr(t,i){if(t&1){let e=x();l(0,"p-button",41),b("click",function(){f(e);let a=o();return h(a.isVisibleAcceptedModal=!1)}),m(),l(1,"p-button",43),b("click",function(){f(e);let a=o();return h(a.acceptTrackingLogDocuments())}),m()}if(t&2){let e=o();c("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),c("label",e.LabelButtonActionEnum.ACCEPTED)("icon",e.IconButtonActionEnum.ACCEPTED)("severity",e.SeverityButtonActionEnum.REFUSED)}}var ai=(()=>{let i=class i{constructor(){this.activatedRoute=_(Ne),this.authService=_($),this.coreService=_(U),this.formBuilder=_(ve),this.cataloguesHttpService=_(se),this.trackingLogsHttpService=_(ge),this.closingLogsHttpService=_(et),this.agreementsHttpService=_(Oe),this.filesHttpService=_(ue),this.breadcrumbService=_(Z),this.PrimeIcons=R,this.IconButtonActionEnum=A,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=S,this.BreadcrumbEnum=F,this.TableEnum=ee,this.messageService=_(X),this.messageDialogService=_(W),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new te(""),this.items=[],this.formErrors=[],this.files=[],this.types=[],this.closeTypes=[],this.trackingLogType="execution",this.isVisibleRefusedModal=!1,this.isVisibleAcceptedModal=!1,this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Te,this.CatalogueTrackingLogsStateEnum=ce,this.CatalogueClosingNotificationsCloseTypesDocumentEnum=ze,this.FileEnum=Re,this.validPeriodsClosing=!1,this.validPeriodsExecution=!1,this.breadcrumbService.setItems([{label:F.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:F.PERIODS}]),this.buildForm(),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findClosingLogCurrentByAgreement(),this.findAgreement(this.agreementId),this.loadTypes(),this.loadTypesByCloseType(),setTimeout(()=>{this.validatePeriods()},500),this.activatedRoute.queryParams.subscribe(n=>{this.trackingLogType=n.type})}buildForm(){this.form=this.formBuilder.group({reportFile:[null,ae.required],evidenceFile:[null],observation:[null,ae.required]})}findAgreement(n){this.agreementsHttpService.findOne(n).subscribe(a=>{this.agreement=a})}findClosingLogCurrentByAgreement(){this.closingLogsHttpService.findClosingLogCurrentByAgreement(this.agreementId).subscribe(n=>{n&&(this.items=[n])})}loadTypes(){this.types=this.cataloguesHttpService.findByType(me.PERIODS_TRACKING_LOG)}loadTypesByCloseType(){this.closeTypes=this.cataloguesHttpService.findByParent(this.closingNotification?.closeType?.id)}createClosingLog(){let n=new FormData;for(let a of this.files)n.append("typeIds",a.type.id),n.append("files",a.file);this.closingLogsHttpService.createClosingLog(this.agreementId,n).subscribe(a=>{this.findClosingLogCurrentByAgreement(),this.isVisibleFilesModal=!1})}onUpload(n,a,s){let E=this.files.findIndex(M=>M.type?.id===s.id);E===-1?this.files.push({type:s,file:n.files[0]}):this.files[E]={type:s,file:n.files[0]},a.clear()}openFilesModal(){this.closingNotification?(this.loadTypesByCloseType(),lt(this.trackingLogsHttpService.validationPeriods(this.agreementId,"execution"),this.trackingLogsHttpService.validationPeriods(this.agreementId,"closing")).subscribe(n=>{if(n.length>0){if(this.validPeriodsExecution=n[0],this.validPeriodsClosing=n[1],!this.validPeriodsExecution){this.messageDialogService.errorCustom("Error de reportes ejecucion","Su mensaje va aqui");return}if(this.closingNotification.closeType?.code===ze.TERM&&!this.validPeriodsClosing){this.messageDialogService.errorCustom("Error de reportes cierre","Su mensaje va aqui");return}this.isVisibleFilesModal=!0}})):this.messageDialogService.errorCustom("No existe closing notification","Su mensaje va aqui")}onSubmit(){this.validateFilesForm()?this.createClosingLog():this.messageDialogService.fieldErrors(this.formErrors)}buildColumns(){this.columns=[{field:"closingLogDocumentsUpload",header:w.documentName},{field:"closingLogDocuments",header:w.fileName},{field:"trafficLight",header:w.trafficLight},{field:"uploadedAt",header:w.uploadedAt},{field:"user",header:w.user},{field:"state",header:w.state}]}buildButtonActions(){this.buttonActions=[{id:D.TRACKING_LOG,label:S.TRACKING_LOG,icon:A.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}},{id:D.ACCEPTED,label:S.ACCEPTED,icon:A.ACCEPTED,command:()=>{this.isVisibleAcceptedModal=!0}},{id:D.REFUSED,label:S.REFUSED,icon:A.REFUSED,command:()=>{this.isVisibleRefusedModal=!0}}]}validateButtonActions(n){this.buildButtonActions(),(!n||n.state?.code===ce.ACCEPTED||n.state?.code===ce.REFUSED)&&(this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.ACCEPTED),1),this.buttonActions.splice(this.buttonActions.findIndex(a=>a.id===D.REFUSED),1))}remove(n){}selectItem(n){this.isButtonActions=!0,this.selectedItem=n,this.validateButtonActions(n)}showFilesModal(n){this.selectedItem=n,this.isVisibleFilesModal=!0}downloadFile(n){this.filesHttpService.downloadFile(n)}refuseTrackingLogDocuments(){this.observationFileField.valid?this.closingLogsHttpService.changeState(this.selectedItem.id,!1,this.observationFileField.value).subscribe(()=>{this.findClosingLogCurrentByAgreement(),this.isVisibleRefusedModal=!1,this.observationFileField.reset()}):(this.form.markAllAsTouched(),this.formErrors=[pe.observation],this.messageDialogService.fieldErrors(this.formErrors))}acceptTrackingLogDocuments(){this.closingLogsHttpService.changeState(this.selectedItem.id,!0).subscribe(()=>{this.findClosingLogCurrentByAgreement(),this.isVisibleAcceptedModal=!1})}validateFilesForm(){return this.formErrors=[],this.closeTypes.forEach(n=>{this.files.find(s=>s.type?.id===n?.id)||this.formErrors.push(n.name)}),this.formErrors.length===0}closeModal(){this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)}validatePeriods(){this.validPeriodsClosing=!1,this.validPeriodsExecution=!1,this.closingNotification&&this.closingNotification.closeType?.code===ze.TERM&&lt(this.trackingLogsHttpService.validationPeriods(this.agreementId,"execution"),this.trackingLogsHttpService.validationPeriods(this.agreementId,"closing")).subscribe(n=>{n.length>0&&(this.validPeriodsExecution=n[0],this.validPeriodsClosing=n[1])})}validatePeriodsClosing(){this.validPeriodsClosing=!1,this.closingNotification&&this.closingNotification.closeType?.code===ze.TERM&&this.trackingLogsHttpService.validationPeriods(this.agreementId,"closing").subscribe(n=>{this.validPeriodsClosing=n})}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}get observationFileField(){return this.form.controls.observation}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-closing-log-current"]],inputs:{agreementId:"agreementId",closingNotification:"closingNotification"},decls:24,vars:31,consts:[["dt",""],["uploadFiles",""],["dataKey","id","styleClass","p-datatable-striped",3,"value","columns","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Subir Archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["header","Bit\xE1cora de seguimiento al cierre del Convenio",3,"visibleChange","visible","modal"],[3,"agreementId"],["header","Header",3,"visibleChange","visible","modal"],[1,"grid","p-fluid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","observation","label","Observaci\xF3n",3,"required"],["pInputTextarea","","id","observation","formControlName","observation"],["appErrorMessage","",3,"errors","touched","dirty"],["severity","error"],[1,"p-toolbar-group-left"],[3,"icon","label","loading","severity"],[1,"p-toolbar-group-right"],["pTemplate",""],[1,"ml-2"],[3,"click","icon","label","loading","severity"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[1,"p-fluid","grid"],[3,"for"],[1,"p-error"],["id","report","mode","basic","chooseLabel","Cargar","invalidFileSizeMessageDetail","","name","files[]","accept",".pdf,.rar,.zip",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["severity","info"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"],[3,"click","label","icon","severity"]],template:function(a,s){if(a&1){let E=x();l(0,"p-table",2,0),d(2,Yo,7,3,"ng-template",3)(3,Qo,5,1,"ng-template",4)(4,hr,5,3,"ng-template",5)(5,vr,3,2,"ng-template",6)(6,br,0,0,"ng-template",7),m(),l(7,"app-button-action",8),b("isHide",function(v){return f(E),h(s.isButtonActions=!v)}),m(),l(8,"p-dialog",9),N("visibleChange",function(v){return f(E),V(s.isVisibleFilesModal,v)||(s.isVisibleFilesModal=v),h(v)}),d(9,Ar,3,0,"ng-template",10)(10,Lr,2,7,"ng-template",11),m(),l(11,"p-dialog",12),N("visibleChange",function(v){return f(E),V(s.isVisibleTrackingLogModal,v)||(s.isVisibleTrackingLogModal=v),h(v)}),d(12,Tr,1,1,"app-closing-log-list",13),m(),l(13,"p-dialog",14),N("visibleChange",function(v){return f(E),V(s.isVisibleRefusedModal,v)||(s.isVisibleRefusedModal=v),h(v)}),d(14,yr,2,0,"ng-template",4),l(15,"form",15)(16,"div",16),u(17,"label",17)(18,"textarea",18)(19,"small",19),m()(),d(20,Fr,2,7,"ng-template",11),m(),l(21,"p-dialog",14),N("visibleChange",function(v){return f(E),V(s.isVisibleAcceptedModal,v)||(s.isVisibleAcceptedModal=v),h(v)}),d(22,Ir,2,0,"ng-template",4)(23,Dr,2,7,"ng-template",11),m()}a&2&&(c("value",s.items)("columns",s.columns)("loading",s.coreService.isLoading),r(7),c("buttonActions",s.buttonActions)("enabled",s.isButtonActions),r(),j(Y(27,Wo)),P("visible",s.isVisibleFilesModal),c("modal",!0),r(3),j(Y(28,zo)),P("visible",s.isVisibleTrackingLogModal),c("modal",!0),r(),g(12,s.isVisibleTrackingLogModal?12:-1),r(),j(Y(29,li)),P("visible",s.isVisibleRefusedModal),c("modal",!0),r(2),c("formGroup",s.form),r(2),c("required",s.observationFileField),r(2),c("errors",s.observationFileField.errors)("touched",s.observationFileField.touched)("dirty",s.observationFileField.dirty),r(2),j(Y(30,li)),P("visible",s.isVisibleAcceptedModal),c("modal",!0))},dependencies:[De,be,Ee,H,re,K,he,ye,Ce,fe,q,ie,oe,ne,Fe,Ie,xe,$e,it,de,we,ri,Q],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var Mr=t=>[t];function kr(t,i){if(t&1&&u(0,"app-period-closing-list",0),t&2){let e=o();c("agreementId",e.agreementId)}}function Pr(t,i){if(t&1&&(l(0,"tr")(1,"th"),p(2),m(),l(3,"th"),p(4),m(),l(5,"th"),p(6),m(),l(7,"th"),p(8),m(),l(9,"th"),p(10),m()()),t&2){let e=o(3);r(2),B(e.ClosingNotificationEnum.closeType2),r(2),B(e.ClosingNotificationEnum.closeDetail),r(2),B(e.ClosingNotificationEnum.closedAt),r(2),B(e.ClosingNotificationEnum.registeredAt),r(2),B(e.ClosingNotificationEnum.user)}}function Vr(t,i){if(t&1&&(l(0,"tr")(1,"td"),p(2),m(),l(3,"td"),p(4),m(),l(5,"td"),p(6),y(7,"customFormatDate"),m(),l(8,"td"),p(9),y(10,"date"),m(),l(11,"td"),p(12),m()()),t&2){let e=i.$implicit;r(2),B(e.closeType==null?null:e.closeType.name),r(2),B(e.closeDetail),r(2),B(Ae(7,5,e.closedAt)),r(3),B(k(10,7,e.registeredAt,"dd/MM/yyyy HH:mm")),r(3),B(e.user.name+" "+e.user.lastname)}}function Nr(t,i){if(t&1&&(l(0,"p-table",4),d(1,Pr,11,5,"ng-template",5)(2,Vr,13,10,"ng-template",6),m()),t&2){let e=o(2);c("value",Je(2,Mr,e.closingNotification))("loading",e.coreService.isLoading)}}function Rr(t,i){if(t&1&&(l(0,"form",2),d(1,Nr,3,4,"p-table",4),m()),t&2){let e=o();r(),g(1,(e.closingNotification.closeType==null?null:e.closingNotification.closeType.code)!==e.CatalogueClosingNotificationsCloseTypeEnum.TERM?1:-1)}}var si=(()=>{let i=class i{constructor(){this.authService=_($),this.breadcrumbService=_(Z),this.agreementsHttpService=_(Oe),this.confirmationService=_(Xe),this.closingNotificationsHttpService=_(bt),this.cataloguesHttpService=_(se),this.coreService=_(U),this.messageDialogService=_(W),this.formBuilder=_(ve),this.Validators=ae,this.closeTypes=[],this.AgreementFormEnum=_e,this.AgreementStateEnum=Ze,this.SkeletonEnum=ft,this.ClosingNotificationEnum=vt,this.PrimeIcons=R,this.CatalogueAgreementsTypeEnum=gt,this.CatalogueClosingNotificationsCloseTypeEnum=Ct,this.breadcrumbService.setItems([{label:F.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:F.CLOSING_NOTIFICATION}])}ngOnInit(){this.loadCloseTypes(),this.findClosingNotificationByAgreement()}findClosingNotificationByAgreement(){this.closingNotificationsHttpService.findClosingNotificationByAgreement(this.agreementId).subscribe(n=>{this.closingNotification=n})}loadCloseTypes(){this.closeTypes=this.cataloguesHttpService.findByType(me.CLOSING_NOTIFICATIONS_CLOSE_TYPE)}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-agreement-termination-list"]],inputs:{agreementId:"agreementId"},decls:7,vars:4,consts:[[3,"agreementId"],["header","NOTIFICACI\xD3N INICIO DEL PROCESO DE CIERRE DEL CONVENIO"],[1,"p-fluid","grid"],[3,"agreementId","closingNotification"],["dataKey","id","styleClass","p-datatable-striped",3,"value","loading"],["pTemplate","header"],["pTemplate","body"]],template:function(a,s){a&1&&(d(0,kr,1,1,"app-period-closing-list",0),l(1,"p-panel",1),d(2,Rr,2,1,"form",2),m(),u(3,"p-divider"),l(4,"p-panel"),u(5,"app-closing-log-current",3),m(),p(6,`
fi
`)),a&2&&(g(0,s.closingNotification&&(s.closingNotification.closeType==null?null:s.closingNotification.closeType.code)===s.CatalogueClosingNotificationsCloseTypeEnum.TERM?0:-1),r(2),g(2,s.closingNotification?2:-1),r(3),c("agreementId",s.agreementId)("closingNotification",s.closingNotification))},dependencies:[H,he,fe,Lt,q,de,tt,oi,ai,Q,He]});let t=i;return t})();var Or=(t,i)=>i.id;function Hr(t,i){t&1&&(l(0,"h2"),p(1," Registro de Cierre del Convenio "),m())}function $r(t,i){if(t&1){let e=x();l(0,"p-checkbox",6),N("ngModelChange",function(a){f(e);let s=o(2);return V(s.checked,a)||(s.checked=a),h(a)}),m()}if(t&2){let e=o(2);P("ngModel",e.checked),c("binary",!0)("disabled",e.checkedClosingDate)}}function Gr(t,i){if(t&1){let e=x();u(0,"p-divider",5),l(1,"p-button",7),b("click",function(){f(e);let a=o(2);return h(a.closeAgreement())}),m()}if(t&2){let e=o(2);r(),c("disabled",!e.checked)}}function Ur(t,i){if(t&1&&(l(0,"div",3),d(1,$r,1,3,"p-checkbox",4),u(2,"p-divider",5),p(3," Registrar de cierre del convenio "),d(4,Gr,2,1),m()),t&2){let e=o();r(),g(1,e.closedAgreement?1:-1),r(3),g(4,e.checkedClosingDate?-1:4)}}function Wr(t,i){t&1&&(l(0,"h2"),p(1," Comunicado registro del cierre del Convenio "),m(),l(2,"p"),p(3," Memorando de notificaci\xF3n de registro de informaci\xF3n y cierre del convenio Informe t\xE9cnico de validaci\xF3n del registro del cierre de los convenios naciones o internacionales (seg\xFAn corresponda) "),m())}function zr(t,i){if(t&1){let e=x();l(0,"div",9),u(1,"label",10),l(2,"p-fileUpload",11,0),b("uploadHandler",function(a){f(e);let s=o(3);return h(s.uploadFile(a))}),m()()}if(t&2){let e=o(3);r(),c("label",e.fileType==null?null:e.fileType.name),r(),c("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0)}}function Kr(t,i){if(t&1){let e=x();p(0),u(1,"p-divider"),p(2),l(3,"p-button",12),b("click",function(){let a=f(e).$implicit,s=o(4);return h(s.download(a))}),m()}if(t&2){let e=i.$implicit,n=o(4);C(" ",e==null||e.type==null?null:e.type.name," "),r(2),C(" ",e.name," "),r(),c("icon",n.IconButtonActionEnum.DOWNLOAD)("pTooltip",n.LabelButtonActionEnum.DOWNLOAD)("severity",n.SeverityButtonActionEnum.DOWNLOAD)}}function qr(t,i){if(t&1&&(l(0,"div",9),L(1,Kr,4,5,null,null,Or),m()),t&2){let e=o(3);r(),T(e.closedAgreement.files)}}function jr(t,i){if(t&1&&d(0,zr,4,6,"div",9)(1,qr,3,0,"div",9),t&2){let e=o(2);g(0,e.closedAgreement.files.length===0?0:-1),r(),g(1,e.closedAgreement.files?1:-1)}}function Yr(t,i){if(t&1&&(l(0,"div",8),d(1,jr,2,2),m()),t&2){let e=o();r(),g(1,e.closedAgreement?1:-1)}}var mi=(()=>{let i=class i{constructor(){this.checked=!1,this.checkedClosingDate=!0,this.authService=_($),this.breadcrumbService=_(Z),this.closedAgreementsHttpService=_(xt),this.cataloguesHttpService=_(se),this.filesHttpService=_(ue),this.PrimeIcons=R,this.FileEnum=Re,this.IconButtonActionEnum=A,this.LabelButtonActionEnum=S,this.SeverityButtonActionEnum=z,this.breadcrumbService.setItems([{label:F.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:F.PERIODS}])}ngOnInit(){this.findClosedAgreementByAgreement(),this.loadFileType()}loadFileType(){this.fileType=this.cataloguesHttpService.findByCode("CLOSED_AGREEMENT",me.CLOSED_AGREEMENTS_DOCUMENT),console.log(this.fileType)}closeAgreement(){this.closedAgreementsHttpService.updateClose(this.agreementId).subscribe(()=>{this.checked=!0,this.findClosedAgreementByAgreement()})}findClosedAgreementByAgreement(){this.checkedClosingDate=!0,this.closedAgreementsHttpService.findClosedAgreementByAgreement(this.agreementId).subscribe(n=>{n&&(n?.closingDate&&(this.checked=!0,this.closedAgreement=n),n?.closingDate||(this.checkedClosingDate=!1))})}uploadFile(n){let a=new FormData;a.append("file",n.files[0]),this.closedAgreementsHttpService.uploadFile(this.closedAgreement.id,a).subscribe(s=>{this.findClosedAgreementByAgreement()})}download(n){this.filesHttpService.downloadFile(n)}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=O({type:i,selectors:[["app-closed-agreement"]],inputs:{agreementId:"agreementId"},decls:7,vars:0,consts:[["uploadFiles",""],["pTemplate","header"],["pTemplate","content"],[1,"card","flex"],[3,"ngModel","binary","disabled"],["layout","vertical"],[3,"ngModelChange","ngModel","binary","disabled"],["label","Registrar","severity","success",3,"click","disabled"],[1,"p-fluid","grid"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","file",3,"label"],["id","file","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],[3,"click","icon","pTooltip","severity"]],template:function(a,s){a&1&&(l(0,"p-panel"),d(1,Hr,2,0,"ng-template",1)(2,Ur,5,2,"ng-template",2),m(),u(3,"p-divider"),l(4,"p-panel"),d(5,Wr,4,0,"ng-template",1)(6,Yr,2,1,"ng-template",2),m())},dependencies:[be,St,H,K,Ce,Tt,$e,de,tt,Bt],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=i;return t})();var Jr=[{path:"agreement-list",component:Qt},{path:"period-list/:agreementId",component:ii},{path:"tracking-log-list",component:Ue},{path:"agreement-termination-list/:agreementId",component:si},{path:"closed-agreement/:agreementId",component:mi}],ci=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=Ye({type:i}),i.\u0275inj=je({imports:[at.forChild(Jr),at]});let t=i;return t})();var ks=(()=>{let i=class i{};i.\u0275fac=function(a){return new(a||i)},i.\u0275mod=Ye({type:i}),i.\u0275inj=je({imports:[_t,ci,zt,Nt,At,Pt,Vt,Dt,$t,yt,Ft,Gt,qt,jt,Yt,Rt,wt,Ot,Wt,It,kt,Mt]});let t=i;return t})();export{ks as NationalManagerModule};
