import{c as Lt}from"./chunk-HC6AD4SO.js";import{a as Ae,b as je}from"./chunk-B43VRK7P.js";import{a as Se,b as pi,d as di}from"./chunk-SVUN7SRO.js";import{b as Ot}from"./chunk-KQ4M7MM7.js";import{a as Fe,b as Pt}from"./chunk-R6B2I7DW.js";import"./chunk-VBZFO5L5.js";import{a as ui,b as ci,c as fi,d as hi,f as _i}from"./chunk-PTZGCJQQ.js";import{b as mi}from"./chunk-OKUVFNC3.js";import{c as Nt,e as qt}from"./chunk-MLBKMZAI.js";import{A as R,Aa as ti,B as q,Fa as ii,Ga as he,Ha as ni,Ia as ri,Ja as oi,Ka as ai,N as Bt,P as se,Q as kt,Qa as li,Ra as Ue,Sa as si,U as qe,V as Mt,W as Rt,X as Ht,Z as Gt,_ as $t,ba as He,c as Tt,ca as Ut,d as ae,da as xe,e as St,ea as jt,ha as Wt,i as Q,ia as me,ja as pe,k as u,m as H,n as L,oa as zt,q as P,qa as Qt,ra as Kt,s as M,sa as Ge,t as Re,ta as $e,u as G,ua as Yt,v as V,va as Te,w as Dt,wa as Xt,x as wt,y as fe,ya as Zt,z as Vt,za as ei}from"./chunk-2UPAKWSC.js";import{A as rt,B as F,C as ot,D as we,E as Ve,F as Ft,G as ue,H as xt,K as ce,a as yt,b as k,c as D,f as Ct,g as ke,h as it,i as It,j as de,l as ie,m as ne,n as j,o as nt,p as W,r as re,u as Le,v as oe,x as ge,y as z,z as Pe}from"./chunk-WPEGALUS.js";import{e as Me,j as le,k as At,p as Jt}from"./chunk-CSO23DVT.js";import{e as Ne,k as $,o as O,p as tt,r as U,s as bt,u as vt,v as w,w as te,x as Et}from"./chunk-ZFS7MCCM.js";import{B as A,Ba as Oe,C as Ie,Da as c,Ea as E,Fa as S,G as f,Ga as ct,H as h,Ha as Ze,Hb as gt,Ia as X,Ja as Z,Ka as ee,Kb as et,M as x,Oa as T,S as r,ba as _,c as dt,da as l,ga as J,ha as De,ia as I,ja as _e,k as Y,ka as B,la as N,ma as s,na as m,oa as d,sa as y,sb as Be,ta as b,ua as p,ub as ft,v as ut,vb as ht,w as Ce,y as Xe,yb as _t,z as g}from"./chunk-3AQ5X5KI.js";function Pi(t,a){if(t&1&&(s(0,"div",10)(1,"label"),c(2,"Plazo total del convenio:"),m()(),s(3,"div",11),d(4,"label",12)(5,"app-form-help-field",13)(6,"p-calendar",14)(7,"small",4),m(),s(8,"div",11),d(9,"label",15)(10,"p-inputNumber",16)(11,"small",4),m(),s(12,"div",11),d(13,"label",17)(14,"p-inputNumber",18)(15,"small",4),m(),s(16,"div",11),d(17,"label",19)(18,"p-inputNumber",20)(19,"small",4),m()),t&2){let e=p();r(4),l("label",e.AgreementFormEnum.endedAt)("required",e.endedAtField),r(2),l("iconDisplay","input")("showIcon",!0)("minDate",e.startedAtField.value),r(),l("errors",e.endedAtField.errors)("touched",e.endedAtField.touched)("dirty",e.endedAtField.dirty),r(2),l("label",e.AgreementFormEnum.yearTerm)("required",e.yearTermField),r(),l("showButtons",!0)("min",0)("useGrouping",!1),r(),l("errors",e.yearTermField.errors)("touched",e.yearTermField.touched)("dirty",e.yearTermField.dirty),r(2),l("label",e.AgreementFormEnum.monthTerm)("required",e.monthTermField),r(),l("showButtons",!0)("min",0),r(),l("errors",e.monthTermField.errors)("touched",e.monthTermField.touched)("dirty",e.monthTermField.dirty),r(2),l("label",e.AgreementFormEnum.dayTerm)("required",e.dayTermField),r(),l("showButtons",!0)("min",0),r(),l("errors",e.dayTermField.errors)("touched",e.dayTermField.touched)("dirty",e.dayTermField.dirty)}}function Mi(t,a){if(t&1&&(s(0,"div",10),d(1,"label",21),s(2,"textarea",22),c(3,"      "),m(),d(4,"small",4),m()),t&2){let e=p();r(),l("label",e.AgreementFormEnum.endedReason)("required",e.endedReasonField),r(3),l("errors",e.endedReasonField.errors)("touched",e.endedReasonField.touched)("dirty",e.endedReasonField.dirty)}}var Ei=(()=>{let a=class a{constructor(){this.coreService=g(U),this.formBuilder=g(V),this.cataloguesHttpService=g(k),this.messageDialogService=g(w),this.formOutput=new x,this.formErrorsOutput=new x,this.nextOutput=new x,this.prevOutput=new x,this.formErrors=[],this.Validators=u,this.SkeletonEnum=W,this.AgreementFormEnum=F,this.buildForm()}ngOnInit(){this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({subscribedAt:[null,u.required],startedAt:[null,u.required],isFinishDate:[null,u.required],endedAt:[null],endedReason:[null],yearTerm:[null],monthTerm:[null],dayTerm:[null]}),this.checkValueChanges()}patchValueForm(){let v=this.formInput,{endedAt:i,startedAt:o,subscribedAt:n}=v,C=dt(v,["endedAt","startedAt","subscribedAt"]);this.form.patchValue(C),o&&this.startedAtField.setValue(je(o)),n&&this.subscribedAtField.setValue(je(n)),i&&this.endedAtField.setValue(je(i))}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()}),this.isFinishDateField.valueChanges.subscribe(i=>{i?(this.endedAtField.setValidators(u.required),this.yearTermField.setValidators(u.required),this.monthTermField.setValidators(u.required),this.dayTermField.setValidators(u.required),this.endedReasonField.clearValidators(),this.endedReasonField.reset()):i===!1&&(this.endedReasonField.setValidators(u.required),this.yearTermField.clearValidators(),this.monthTermField.clearValidators(),this.dayTermField.clearValidators(),this.endedAtField.clearValidators(),this.endedAtField.reset(),this.yearTermField.reset(),this.monthTermField.reset(),this.dayTermField.reset()),this.endedReasonField.updateValueAndValidity(),this.endedAtField.updateValueAndValidity(),this.yearTermField.updateValueAndValidity(),this.monthTermField.updateValueAndValidity(),this.dayTermField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.subscribedAtField.invalid&&this.formErrors.push(F.subscribedAt),this.startedAtField.invalid&&this.formErrors.push(F.startedAt),this.isFinishDateField.invalid&&this.formErrors.push(F.isFinishDate),this.endedAtField.invalid&&this.formErrors.push(F.endedAt),this.endedReasonField.invalid&&this.formErrors.push(F.endedReason),this.yearTermField.invalid&&this.formErrors.push(F.yearTerm),this.monthTermField.invalid&&this.formErrors.push(F.monthTerm),this.dayTermField.invalid&&this.formErrors.push(F.dayTerm),this.formErrorsOutput.emit(this.formErrors)}get subscribedAtField(){return this.form.controls.subscribedAt}get startedAtField(){return this.form.controls.startedAt}get isFinishDateField(){return this.form.controls.isFinishDate}get endedAtField(){return this.form.controls.endedAt}get endedReasonField(){return this.form.controls.endedReason}get yearTermField(){return this.form.controls.yearTerm}get monthTermField(){return this.form.controls.monthTerm}get dayTermField(){return this.form.controls.dayTerm}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-agreement-date"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput",nextOutput:"nextOutput",prevOutput:"prevOutput"},decls:15,vars:23,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","subscribedAt",3,"label","required"],["id","subscribedAt","formControlName","subscribedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","startedAt",3,"label","required"],["id","startedAt","formControlName","startedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon","minDate"],[1,"field","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","isFinishDate",3,"label","required"],["id","isFinishDate","formControlName","isFinishDate",1,"ml-2"],[1,"field","col-12"],[1,"field","col-12","xl:col-3","lg:col-3","md:col-3","sm:col-12"],["appLabel","","for","endedAt",3,"label","required"],["content","Esto es un mensaje de prueba"],["id","endedAt","formControlName","endedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon","minDate"],["appLabel","","for","yearTerm",3,"label","required"],["id","yearTerm","formControlName","yearTerm",3,"showButtons","min","useGrouping"],["appLabel","","for","monthTerm",3,"label","required"],["id","monthTerm","formControlName","monthTerm",3,"showButtons","min"],["appLabel","","for","dayTerm",3,"label","required"],["id","dayTerm","formControlName","dayTerm",3,"showButtons","min"],["appLabel","","for","endedReason",3,"label","required"],["pInputTextarea","","id","endedReason","formControlName","endedReason","rows","5","cols","30",2,"resize","none"]],template:function(o,n){o&1&&(s(0,"form",0)(1,"div",1),d(2,"label",2)(3,"p-calendar",3)(4,"small",4),m(),s(5,"div",1),d(6,"label",5)(7,"p-calendar",6)(8,"small",4),m(),s(9,"div",7),d(10,"label",8)(11,"p-inputSwitch",9)(12,"small",4),m(),_(13,Pi,20,30)(14,Mi,5,5,"div",10),m()),o&2&&(l("formGroup",n.form),r(2),l("label",n.AgreementFormEnum.subscribedAt)("required",n.subscribedAtField),r(),l("iconDisplay","input")("showIcon",!0),r(),l("errors",n.subscribedAtField.errors)("touched",n.subscribedAtField.touched)("dirty",n.subscribedAtField.dirty),r(2),l("label",n.AgreementFormEnum.startedAt)("required",n.startedAtField),r(),l("iconDisplay","input")("showIcon",!0)("minDate",n.subscribedAtField.value),r(),l("errors",n.startedAtField.errors)("touched",n.startedAtField.touched)("dirty",n.startedAtField.dirty),r(2),l("label",n.AgreementFormEnum.isFinishDate)("required",n.isFinishDateField),r(2),l("errors",n.isFinishDateField.errors)("touched",n.isFinishDateField.touched)("dirty",n.isFinishDateField.dirty),r(),I(13,n.isFinishDateField.value?13:-1),r(),I(14,n.isFinishDateField.value===!1?14:-1))},dependencies:[P,Q,H,L,M,G,R,q,Ue,xe,Gt,Te,Se]});let t=a;return t})();var Hi=()=>["Esto es un listado 1","Esto es un listado 2","Esto es un listado 3"],We=()=>["Ayuda 1","Ayuda 2","Ayuda 3"];function Gi(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function $i(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Ui(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function ji(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Wi(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function zi(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Qi(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Ki(t,a){if(t&1&&(s(0,"div",26)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Yi(t,a){if(t&1&&(s(0,"div",22),d(1,"label",27)(2,"app-form-help-field",6),s(3,"p-dropdown",28),_(4,Qi,3,1,"ng-template",15)(5,Ki,3,1,"ng-template",16),m(),d(6,"small",4),m()),t&2){let e=p();r(),l("label",e.AgreementFormEnum.specialType)("required",e.specialTypeField),r(),l("content",T(7,We)),r(),l("options",e.specialTypes),r(3),l("errors",e.specialTypeField.errors)("touched",e.specialTypeField.touched)("dirty",e.specialTypeField.dirty)}}var yi=(()=>{let a=class a{constructor(){this.authService=g(ce),this.agreementsHttpService=g(ue),this.cataloguesHttpService=g(k),this.coreService=g(U),this.formBuilder=g(V),this.messageDialogService=g(w),this.Validators=u,this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.origins=[],this.specialTypes=[],this.states=[],this.types=[],this.AgreementFormEnum=F,this.AgreementStateEnum=ot,this.SkeletonEnum=W,this.buildForm()}ngOnInit(){this.loadStates(),this.loadOrigins(),this.loadTypes(),this.loadSpecialTypes(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({agreementState:this.agreementStateForm,name:[null,[u.required]],internalNumber:[null,{validators:u.required,asyncValidators:Lt(this.agreementsHttpService),updateOn:"blur"}],number:[null,[u.required]],objective:[null,[u.required]],origin:[null,[u.required]],specialType:[null],type:[null,[u.required]]}),this.checkValueChanges()}patchValueForm(){this.form.patchValue(this.formInput)}get agreementStateForm(){return this.formBuilder.group({state:[null,u.required]})}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()}),this.typeField.valueChanges.subscribe(i=>{i&&i.code===Ct.SPECIAL?this.specialTypeField.setValidators(u.required):this.specialTypeField.clearValidators(),this.specialTypeField.reset(),this.specialTypeField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.stateField.invalid&&this.formErrors.push(ot.state),this.nameField.invalid&&this.formErrors.push(F.name),this.internalNumberField.invalid&&this.formErrors.push(F.internalNumber),this.internalNumberField.hasError("agreementExists")&&this.messageDialogService.errorCustom("Convenio ya existe","El n\xFAmero interno de convenio ya se encuentra registrado"),this.numberField.invalid&&this.formErrors.push(F.number),this.objectiveField.invalid&&this.formErrors.push(F.objective),this.originField.invalid&&this.formErrors.push(F.origin),this.typeField.invalid&&this.formErrors.push(F.type),this.specialTypeField.invalid&&this.formErrors.push(F.specialType),this.formErrorsOutput.emit(this.formErrors)}loadStates(){this.states=this.cataloguesHttpService.findByType(D.AGREEMENT_STATES_STATE),this.states=this.states.filter(i=>i.code===It.CURRENT)}loadOrigins(){this.origins=this.cataloguesHttpService.findByType(D.AGREEMENTS_ORIGIN)}loadTypes(){this.types=this.cataloguesHttpService.findByType(D.AGREEMENTS_TYPE)}loadSpecialTypes(){this.specialTypes=this.cataloguesHttpService.findByType(D.AGREEMENTS_SPECIAL_TYPE)}get agreementStateFormField(){return this.form.controls.agreementState}get stateField(){return this.agreementStateFormField.controls.state}get nameField(){return this.form.controls.name}get internalNumberField(){return this.form.controls.internalNumber}get numberField(){return this.form.controls.number}get originField(){return this.form.controls.origin}get typeField(){return this.form.controls.type}get objectiveField(){return this.form.controls.objective}get specialTypeField(){return this.form.controls.specialType}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-basic-data"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:42,vars:49,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-3","lg:col-3","md:col-6","sm:col-12"],["appLabel","","for","internalNumber",3,"label","required"],["id","number","formControlName","internalNumber",3,"useGrouping"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","number",3,"label","required"],[3,"content"],["pInputText","","id","internalNumber","formControlName","number"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","name",3,"label","required"],["content","Esto es un mensaje de prueba"],["pInputText","","id","name","formControlName","name"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["appLabel","","for","origin",3,"label","required"],["id","origin","formControlName","origin","dataKey","id","placeholder","Selecione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["formGroupName","agreementState",1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["appLabel","","for","state",3,"label","required"],["id","state","formControlName","state","dataKey","id","placeholder","Seleccione",3,"options"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","dataKey","id","placeholder","Selecione",3,"options"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12","xl:col-offset-8"],[1,"field","col-12"],["appLabel","","for","objective",3,"label","required"],["pInputTextarea","","id","objective","formControlName","objective","rows","6","cols","30"],[1,"flex","align-items-center","gap-2"],["appLabel","","for","specialType",3,"label","required"],["id","specialType","formControlName","specialType","dataKey","id","placeholder","Selecione",3,"options"]],template:function(o,n){o&1&&(s(0,"form",0)(1,"div",1),d(2,"label",2)(3,"p-inputNumber",3)(4,"small",4),m(),s(5,"div",1),d(6,"label",5)(7,"app-form-help-field",6)(8,"input",7)(9,"small",4),m(),s(10,"div",8),d(11,"label",9)(12,"app-form-help-field",10)(13,"input",11)(14,"small",4),m(),s(15,"div",12),d(16,"label",13)(17,"app-form-help-field",6),s(18,"p-dropdown",14),_(19,Gi,3,1,"ng-template",15)(20,$i,3,1,"ng-template",16),m(),d(21,"small",4),m(),s(22,"div",17),d(23,"label",18)(24,"app-form-help-field",6),s(25,"p-dropdown",19),_(26,Ui,3,1,"ng-template",15)(27,ji,3,1,"ng-template",16),m(),d(28,"small",4),m(),s(29,"div",12),d(30,"label",20)(31,"app-form-help-field",6),s(32,"p-dropdown",21),_(33,Wi,3,1,"ng-template",15)(34,zi,3,1,"ng-template",16),m(),d(35,"small",4),m(),_(36,Yi,7,8,"div",22),s(37,"div",23),d(38,"label",24)(39,"app-form-help-field",10)(40,"textarea",25)(41,"small",4),m()()),o&2&&(l("formGroup",n.form),r(2),l("label",n.AgreementFormEnum.internalNumber)("required",n.internalNumberField),r(),l("useGrouping",!1),r(),l("errors",n.internalNumberField.errors)("touched",n.internalNumberField.touched)("dirty",n.internalNumberField.dirty),r(2),l("label",n.AgreementFormEnum.number)("required",n.numberField),r(),l("content",T(45,Hi)),r(2),l("errors",n.numberField.errors)("touched",n.numberField.touched)("dirty",n.numberField.dirty),r(2),l("label",n.AgreementFormEnum.name)("required",n.nameField),r(3),l("errors",n.nameField.errors)("touched",n.nameField.touched)("dirty",n.nameField.dirty),r(2),l("label",n.AgreementFormEnum.origin)("required",n.originField),r(),l("content",T(46,We)),r(),l("options",n.origins),r(3),l("errors",n.originField.errors)("touched",n.originField.touched)("dirty",n.originField.dirty),r(2),l("label",n.AgreementStateEnum.state)("required",n.stateField),r(),l("content",T(47,We)),r(),l("options",n.states),r(3),l("errors",n.stateField.errors)("touched",n.stateField.touched)("dirty",n.stateField.dirty),r(2),l("label",n.AgreementFormEnum.type)("required",n.typeField),r(),l("content",T(48,We)),r(),l("options",n.types),r(3),l("errors",n.typeField.errors)("touched",n.typeField.touched)("dirty",n.typeField.dirty),r(),I(36,n.specialTypeField.hasValidator(n.Validators.required)?36:-1),r(2),l("label",n.AgreementFormEnum.objective)("required",n.objectiveField),r(3),l("errors",n.objectiveField.errors)("touched",n.objectiveField.touched)("dirty",n.objectiveField.dirty))},dependencies:[P,Q,H,L,M,G,Re,R,q,O,Ue,fe,He,xe,Te]});let t=a;return t})();var Ii=(t,a)=>a.field,lt=()=>({width:"50rem"}),Xi=()=>({"max-height":"300px"}),Zi=()=>({"max-height":"150px"});function en(t,a){if(t&1){let e=y();s(0,"h4"),c(1,"Ministerio de Turismo:"),m(),s(2,"p-button",11),b("click",function(){f(e);let o=p();return h(o.showInternalInstitutionModal())}),m()}if(t&2){let e=p();r(2),l("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function tn(t,a){if(t&1&&(s(0,"th",14),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function nn(t,a){if(t&1&&(s(0,"tr"),B(1,tn,2,2,"th",14,Ii),s(3,"th"),c(4),m()()),t&2){let e=p(3);r(),N(e.internalInstitutionsColumns),r(3),E(e.TableEnum.ACTIONS)}}function rn(t,a){if(t&1&&(s(0,"ul"),c(1),m()),t&2){let e=a.$implicit;r(),S(" ",e.position.name," ")}}function on(t,a){if(t&1){let e=y();s(0,"tr")(1,"td"),c(2),m(),s(3,"td"),c(4),m(),s(5,"td"),B(6,rn,2,1,"ul",null,_e),m(),s(8,"td")(9,"div",15)(10,"p-button",16),b("click",function(){let o=f(e).rowIndex,n=p(3);return h(n.deleteInternalInstitution(o))}),m()()()()}if(t&2){let e=a.$implicit,i=p(3);r(2),E(e.personType.name),r(2),E(e.name),r(2),N(e.internalInstitutionDetails),r(4),l("icon",i.PrimeIcons.TRASH)("severity",i.SeverityButtonActionEnum.DELETE)}}function an(t,a){if(t&1&&(s(0,"p-table",12),_(1,nn,5,1,"ng-template",0)(2,on,11,4,"ng-template",13),m()),t&2){let e=p(2);l("value",e.formInput.internalInstitutions)("columns",e.internalInstitutionsColumns)}}function ln(t,a){if(t&1&&_(0,an,3,2,"p-table",12),t&2){let e=p();I(0,e.formInput.internalInstitutions.length>0?0:-1)}}function sn(t,a){if(t&1){let e=y();s(0,"h4"),c(1,"Contraparte:"),m(),s(2,"p-button",11),b("click",function(){f(e);let o=p();return h(o.showExternalInstitutionModal())}),m()}if(t&2){let e=p();r(2),l("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function mn(t,a){if(t&1&&(s(0,"th",14),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function pn(t,a){if(t&1&&(s(0,"tr")(1,"th"),c(2),m(),B(3,mn,2,2,"th",14,Ii),s(5,"th"),c(6),m()()),t&2){let e=a.$implicit,i=p(3);r(2),E(i.TableEnum.ACTIONS),r(),N(e),r(3),E(i.TableEnum.ACTIONS)}}function dn(t,a){if(t&1){let e=y();s(0,"li",18)(1,"p-button",19),b("click",function(){let o=f(e).$index,n=p().rowIndex,C=p(3);return h(C.deleteExternalInstitutionDetail(n,o))}),m(),c(2),m()}if(t&2){let e=a.$implicit,i=p(4);r(),l("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),r(),ct(" ",e.position," / ",e.unit," ")}}function un(t,a){if(t&1){let e=y();s(0,"tr")(1,"td")(2,"p-button",17),b("click",function(){let o=f(e).rowIndex,n=p(3);return h(n.deleteExternalInstitution(o))}),m()(),s(3,"td"),c(4),m(),s(5,"td"),c(6),m(),s(7,"td")(8,"ul"),B(9,dn,3,5,"li",18,_e),m()(),s(11,"td")(12,"p-button",17),b("click",function(){let o=f(e).rowIndex,n=p(3);return h(n.showExternalInstitutionDetailModal(o))}),m()()()}if(t&2){let e=a.$implicit,i=p(3);r(2),l("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),r(2),E(e.personType.name),r(2),E(e.name),r(3),N(e.externalInstitutionDetails),r(3),l("icon",i.IconButtonActionEnum.ADD)("severity",i.SeverityButtonActionEnum.ADD)("pTooltip",i.LabelButtonActionEnum.ADD)}}function cn(t,a){if(t&1&&(s(0,"p-table",12),_(1,pn,7,2,"ng-template",0)(2,un,13,8,"ng-template",13),m()),t&2){let e=p(2);l("value",e.formInput.externalInstitutions)("columns",e.externalInstitutionsColumns)}}function fn(t,a){if(t&1&&_(0,cn,3,2,"p-table",12),t&2){let e=p();I(0,e.formInput.externalInstitutions.length>0?0:-1)}}function hn(t,a){if(t&1){let e=y();s(0,"p-button",20),b("click",function(){f(e);let o=p();return h(o.isVisibleInternalInstitutionForm=!1)}),m(),s(1,"p-button",21),b("click",function(){f(e);let o=p();return h(o.addInternalInstitution())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function _n(t,a){if(t&1&&(s(0,"form",3)(1,"div",4),d(2,"label",22)(3,"p-listbox",23)(4,"small",7),m(),s(5,"div",4),d(6,"label",24)(7,"input",25)(8,"small",7),m()(),s(9,"form",3)(10,"div",26),d(11,"label",27)(12,"input",28)(13,"small",7),m(),s(14,"div",26),d(15,"label",29)(16,"input",30)(17,"small",7),m()()),t&2){let e=p();l("formGroup",e.externalInstitutionForm),r(2),l("label",e.ExternalInstitutionsFormEnum.personType)("required",e.externalInstitutionPersonTypeField),r(),l("options",e.externalPersonTypes)("listStyle",T(24,Zi)),r(),l("errors",e.externalInstitutionPersonTypeField.errors)("touched",e.externalInstitutionPersonTypeField.touched)("dirty",e.externalInstitutionPersonTypeField.dirty),r(2),l("label",e.ExternalInstitutionsFormEnum.name)("required",e.externalInstitutionNameField),r(2),l("errors",e.externalInstitutionNameField.errors)("touched",e.externalInstitutionNameField.touched)("dirty",e.externalInstitutionNameField.dirty),r(),l("formGroup",e.externalInstitutionDetailForm),r(2),l("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),r(2),l("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),r(2),l("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),r(2),l("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function gn(t,a){if(t&1){let e=y();s(0,"p-button",20),b("click",function(){f(e);let o=p();return h(o.isVisibleExternalInstitutionForm=!1)}),m(),s(1,"p-button",21),b("click",function(){f(e);let o=p();return h(o.addExternalInstitution())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function bn(t,a){if(t&1&&(s(0,"form",3)(1,"div",4),d(2,"label",31)(3,"input",32)(4,"small",7),m(),s(5,"div",4),d(6,"label",33)(7,"input",34)(8,"small",7),m()()),t&2){let e=p();l("formGroup",e.externalInstitutionDetailForm),r(2),l("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),r(2),l("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),r(2),l("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),r(2),l("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function vn(t,a){if(t&1){let e=y();s(0,"p-button",20),b("click",function(){f(e);let o=p();return h(o.isVisibleExternalInstitutionDetailForm=!1)}),m(),s(1,"p-button",35),b("click",function(){f(e);let o=p();return h(o.addExternalInstitutionDetail())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var Fi=(()=>{let a=class a{constructor(){this.authService=g(ce),this.cataloguesHttpService=g(k),this.coreService=g(U),this.formBuilder=g(V),this.messageDialogService=g(w),this.formInput=te(),this.formOutput=new x,this.formErrorsOutput=new x,this.externalInstitutionsColumns=[],this.internalInstitutionsColumns=[],this.formErrors=[],this.isVisibleExternalInstitutionDetailForm=!1,this.isVisibleInternalInstitutionForm=!1,this.isVisibleExternalInstitutionForm=!1,this.index=-1,this.internalPersonTypes=[],this.externalPersonTypes=[],this.positions=[],this.ExternalInstitutionsFormEnum=z,this.InternalInstitutionsFormEnum=ge,this.SkeletonEnum=W,this.PrimeIcons=$,this.SeverityButtonActionEnum=j,this.LabelButtonActionEnum=ie,this.IconButtonActionEnum=ne,this.AgreementFormEnum=F,this.TableEnum=re,this.buildForm(),this.buildExternalInstitutionForm(),this.buildInternalInstitutionForm(),this.buildExternalInstitutionDetailForm(),this.buildInternalInstitutionDetailForm(),this.buildExternalInstitutionsColumns(),this.buildInternalInstitutionsColumns(),this.checkValueChanges()}ngOnInit(){this.loadInternalPersonTypes(),this.loadExternalPersonTypes(),this.loadPositions(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({internalInstitutions:this.formBuilder.array([],u.required),externalInstitutions:this.formBuilder.array([],u.required)})}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()})}validateForm(){this.formErrors=[],this.formInput.internalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Mintur"),this.formInput.externalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Contraparte"),this.formErrorsOutput.emit(this.formErrors)}buildInternalInstitutionForm(){this.internalInstitutionForm=this.formBuilder.group({name:["Ministerio de Turismo"],personType:[null,[u.required]]})}buildInternalInstitutionDetailForm(){this.internalInstitutionDetailForm=this.formBuilder.group({position:[null,[u.required]],unit:[null]})}buildExternalInstitutionForm(){this.externalInstitutionForm=this.formBuilder.group({personType:[null,[u.required]],name:[null,[u.required,u.pattern(Ae())]]})}buildExternalInstitutionDetailForm(){this.externalInstitutionDetailForm=this.formBuilder.group({position:[null,[u.required]],unit:[null,[u.required,u.pattern(Ae())]]})}buildInternalInstitutionsColumns(){this.internalInstitutionsColumns=[{field:"personType",header:ge.personType},{field:"name",header:ge.name},{field:"position",header:ge.position}]}buildExternalInstitutionsColumns(){this.externalInstitutionsColumns=[{field:"personType",header:z.personType},{field:"name",header:z.name},{field:"position",header:`${z.unit} / ${z.position}`}]}addInternalInstitution(){this.internalInstitutionPersonTypeField.patchValue(this.internalPersonTypes.find(i=>i.code===it.PUBLIC)),this.internalInstitutionNameField.patchValue("Ministerio de Turismo"),this.validateInternalInstitutionForm()&&this.validateInternalInstitutionDetailForm()?(this.formInput.internalInstitutions.push(this.internalInstitutionForm.value),this.form.patchValue(this.formInput),this.index=this.formInput.internalInstitutions.length-1,this.addInternalInstitutionDetail(),this.internalInstitutionForm.reset(),this.isVisibleInternalInstitutionForm=!1):(this.internalInstitutionForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addInternalInstitutionDetail(){this.validateInternalInstitutionDetailForm()?(this.formInput?.internalInstitutions&&(this.formInput?.internalInstitutions[this.index].internalInstitutionDetails?this.formInput.internalInstitutions[this.index].internalInstitutionDetails.push(this.internalInstitutionDetailForm.value):this.formInput.internalInstitutions[this.index].internalInstitutionDetails=[this.internalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.internalInstitutionDetailPositionField.reset()):(this.internalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitution(){this.validateExternalInstitutionForm()&&this.validateExternalInstitutionDetailForm()?(this.formInput.externalInstitutions.push(this.externalInstitutionForm.value),this.form.patchValue(this.formInput),this.index=this.formInput.externalInstitutions.length-1,this.addExternalInstitutionDetail(),this.externalInstitutionForm.reset(),this.isVisibleExternalInstitutionForm=!1):(this.externalInstitutionForm.markAllAsTouched(),this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitutionDetail(){this.validateExternalInstitutionDetailForm()?(this.formInput?.externalInstitutions&&(this.formInput?.externalInstitutions[this.index].externalInstitutionDetails?this.formInput.externalInstitutions[this.index].externalInstitutionDetails.push(this.externalInstitutionDetailForm.value):this.formInput.externalInstitutions[this.index].externalInstitutionDetails=[this.externalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.isVisibleExternalInstitutionDetailForm=!1,this.externalInstitutionDetailForm.reset()):(this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}showExternalInstitutionModal(){this.isVisibleExternalInstitutionForm=!0}showExternalInstitutionDetailModal(i){this.isVisibleExternalInstitutionDetailForm=!0,this.index=i}deleteExternalInstitution(i){if(this.formInput.obligations.some(o=>o.institutionName===this.formInput.externalInstitutions[i].name)){this.messageDialogService.errorCustom("Existe obligaciones asignadas","Por favor elimine primero las obligaciones");return}if(this.formInput.financings.some(o=>o.institutionName===this.formInput.externalInstitutions[i].name)){this.messageDialogService.errorCustom("Existe financiamientos asignados","Por favor elimine primero los financiamientos");return}this.formInput.externalInstitutions.splice(i,1),this.form.patchValue(this.formInput)}deleteInternalInstitutionDetail(i,o){this.formInput.internalInstitutions[i].internalInstitutionDetails.splice(o,1)}deleteInternalInstitution(i){this.formInput.internalInstitutions.splice(i,1),this.form.patchValue(this.formInput)}deleteExternalInstitutionDetail(i,o){this.formInput.externalInstitutions[i].externalInstitutionDetails.splice(o,1),this.formInput.externalInstitutions[i].externalInstitutionDetails.length===0&&this.formInput.externalInstitutions.splice(i,1)}validateExternalInstitutionForm(){return this.formErrors=[],this.externalInstitutionNameField.invalid&&this.formErrors.push(z.name),this.externalInstitutionPersonTypeField.invalid&&this.formErrors.push(z.personType),this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(z.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(z.position),this.formInput.externalInstitutions&&this.formInput.externalInstitutions?.findIndex(i=>i.name===this.externalInstitutionNameField.value)>-1&&this.formErrors.push("Ya existe la instituci\xF3n"),this.formErrors.length===0}validateExternalInstitutionDetailForm(){return this.formErrors=[],this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(z.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(z.position),this.formErrors.length===0}validateInternalInstitutionForm(){return this.formErrors=[],this.internalInstitutionPersonTypeField.invalid&&this.formErrors.push(ge.personType),this.formErrors.length===0}validateInternalInstitutionDetailForm(){return this.formErrors=[],this.internalInstitutionDetailPositionField.invalid&&this.formErrors.push(ge.position),this.internalInstitutionDetailForm.valid&&this.formErrors.length===0}loadInternalPersonTypes(){this.internalPersonTypes=this.cataloguesHttpService.findByType(D.INTERNAL_INSTITUTIONS_PERSON_TYPE),this.internalInstitutionPersonTypeField.patchValue(this.internalPersonTypes.find(i=>i.code===it.PUBLIC))}loadExternalPersonTypes(){this.externalPersonTypes=this.cataloguesHttpService.findByType(D.EXTERNAL_INSTITUTIONS_PERSON_TYPE)}loadPositions(){this.positions=this.cataloguesHttpService.findByType(D.INTERNAL_INSTITUTIONS_POSITION)}save(){this.formOutput.emit(this.form.value)}showInternalInstitutionModal(){if(this.formInput.internalInstitutions.length>0){this.messageDialogService.errorCustom("No puede agregar","Solo se puede agregar 1 cargo");return}this.isVisibleInternalInstitutionForm=!0}get internalInstitutionsField(){return this.form.get("internalInstitutions")}get externalInstitutionsField(){return this.form.get("externalInstitutions")}get internalInstitutionNameField(){return this.internalInstitutionForm.controls.name}get internalInstitutionPersonTypeField(){return this.internalInstitutionForm.controls.personType}get internalInstitutionDetailPositionField(){return this.internalInstitutionDetailForm.controls.position}get externalInstitutionNameField(){return this.externalInstitutionForm.controls.name}get externalInstitutionPersonTypeField(){return this.externalInstitutionForm.controls.personType}get externalInstitutionDetailUnitField(){return this.externalInstitutionDetailForm.controls.unit}get externalInstitutionDetailPositionField(){return this.externalInstitutionDetailForm.controls.position}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-appearer"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:19,vars:26,consts:[["pTemplate","header"],["pTemplate","content"],["header","Agregar",3,"visibleChange","visible","modal","maximizable"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","internalPosition",3,"label","required"],["id","internalPosition","formControlName","position","optionLabel","name",3,"options","filter","listStyle"],["appErrorMessage","",3,"errors","touched","dirty"],["pTemplate","footer"],["header","Agregar",3,"visibleChange","visible","modal"],["header","Contraparte",3,"visibleChange","visible","modal"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"button-group"],[3,"click","icon","severity"],[3,"click","icon","severity","pTooltip"],[1,"mt-1"],[1,"ml-1",3,"click","icon","severity","pTooltip"],[3,"click","label","icon","text","severity"],[3,"click","icon","severity","label"],["appLabel","","for","externalPersonType",3,"label","required"],["id","externalPersonType","formControlName","personType","optionLabel","name",3,"options","listStyle"],["appLabel","","for","name",3,"label","required"],["pInputText","","id","name","formControlName","name"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","externalPosition2",3,"label","required"],["pInputText","","id","externalPosition2","formControlName","position"],["appLabel","","for","unit2",3,"label","required"],["pInputText","","id","unit2","formControlName","unit"],["appLabel","","for","externalPosition1",3,"label","required"],["pInputText","","id","externalPosition1","formControlName","position"],["appLabel","","for","unit1",3,"label","required"],["pInputText","","id","unit1","formControlName","unit"],[3,"click","label","icon","severity"]],template:function(o,n){o&1&&(s(0,"p-panel"),_(1,en,3,3,"ng-template",0)(2,ln,1,1,"ng-template",1),m(),s(3,"p-panel"),_(4,sn,3,3,"ng-template",0)(5,fn,1,1,"ng-template",1),m(),s(6,"p-dialog",2),ee("visibleChange",function(v){return Z(n.isVisibleInternalInstitutionForm,v)||(n.isVisibleInternalInstitutionForm=v),v}),s(7,"form",3)(8,"div",4),d(9,"label",5)(10,"p-listbox",6)(11,"small",7),m()(),_(12,hn,2,7,"ng-template",8),m(),s(13,"p-dialog",9),ee("visibleChange",function(v){return Z(n.isVisibleExternalInstitutionForm,v)||(n.isVisibleExternalInstitutionForm=v),v}),_(14,_n,18,25,"ng-template",1)(15,gn,2,7,"ng-template",8),m(),s(16,"p-dialog",10),ee("visibleChange",function(v){return Z(n.isVisibleExternalInstitutionDetailForm,v)||(n.isVisibleExternalInstitutionDetailForm=v),v}),_(17,bn,9,11,"ng-template",1)(18,vn,2,7,"ng-template",8),m()),o&2&&(r(6),J(T(22,lt)),X("visible",n.isVisibleInternalInstitutionForm),l("modal",!0)("maximizable",!0),r(),l("formGroup",n.internalInstitutionDetailForm),r(2),l("label",n.InternalInstitutionsFormEnum.position)("required",n.internalInstitutionDetailPositionField),r(),l("options",n.positions)("filter",!0)("listStyle",T(23,Xi)),r(),l("errors",n.internalInstitutionDetailPositionField.errors)("touched",n.internalInstitutionDetailPositionField.touched)("dirty",n.internalInstitutionDetailPositionField.dirty),r(2),J(T(24,lt)),X("visible",n.isVisibleExternalInstitutionForm),l("modal",!0),r(3),J(T(25,lt)),X("visible",n.isVisibleExternalInstitutionDetailForm),l("modal",!0))},dependencies:[P,Q,H,L,M,G,R,q,ae,O,le,fe,se,me,pe,he,Fe],styles:[".button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem}"]});let t=a;return t})();var mt=(()=>{let a=class a{constructor(i,o){this.httpClient=i,this.messageService=o,this.API_URL=`${yt.API_URL}/users`}create(i){let o=`${this.API_URL}`;return this.httpClient.post(o,i).pipe(Y(n=>(this.messageService.success(n),n.data)))}findUsers(i=0,o=""){let n=this.API_URL,C=new ft().append("pagination","true"),v=new ht().append("page",i).append("search",o).append("limit","2");return this.httpClient.get(n,{headers:C,params:v}).pipe(Y(Je=>Je))}findOne(i){let o=`${this.API_URL}/${i}`;return this.httpClient.get(o).pipe(Y(n=>n.data))}findAllUsersLDAP(){let i=`${this.API_URL}/ldap`;return this.httpClient.get(i).pipe(Y(o=>o.data))}update(i,o){let n=`${this.API_URL}/${i}`;return this.httpClient.put(n,o).pipe(Y(C=>(this.messageService.success(C),C.data)))}reactivate(i){let o=`${this.API_URL}/${i}/reactivate`;return this.httpClient.put(o,null).pipe(Y(n=>(this.messageService.success(n),n.data)))}remove(i){let o=`${this.API_URL}/${i}`;return this.httpClient.delete(o).pipe(Y(n=>(this.messageService.success(n),n.data)))}removeAll(i){let o=`${this.API_URL}/remove-all`;return this.httpClient.patch(o,i).pipe(Y(n=>(this.messageService.success(n),n.data)))}suspend(i){let o=`${this.API_URL}/${i}/suspend`;return this.httpClient.put(o,null).pipe(Y(n=>(this.messageService.success(n),n.data)))}findCatalogues(){let i=`${this.API_URL}/catalogues`;return this.httpClient.get(i).pipe(Y(o=>o.data))}};a.\u0275fac=function(o){return new(o||a)(Xe(_t),Xe(bt))},a.\u0275prov=ut({token:a,factory:a.\u0275fac,providedIn:"root"});let t=a;return t})();function yn(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Cn(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function In(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function Fn(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),E(e.name)}}function xn(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),Ze("",e.name," ",e.lastname," (",e.email,")")}}function Tn(t,a){if(t&1&&(s(0,"div",14)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;r(2),Ze("",e.name," ",e.lastname," (",e.email,")")}}var xi=(()=>{let a=class a{constructor(){this.coreService=g(U),this.cataloguesHttpService=g(k),this.formBuilder=g(V),this.messageDialogService=g(w),this.usersHttpService=g(mt),this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.Validators=u,this.units=[],this.positions=[],this.users=[],this.SkeletonEnum=W,this.AgreementFormEnum=F,this.AdministratorFormEnum=we,this.buildForm()}ngOnInit(){this.loadPositions(),this.loadUnits(),this.loadUsers(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({administrator:this.administratorForm}),this.checkValueChanges()}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()})}get administratorForm(){return this.formBuilder.group({unit:[null,u.required],position:[null,u.required],user:[null,u.required]})}validateForm(){this.formErrors=[],this.unitField.invalid&&this.formErrors.push(we.unit),this.positionField.invalid&&this.formErrors.push(we.position),this.userField.invalid&&this.formErrors.push(we.user),this.formErrorsOutput.emit(this.formErrors)}loadPositions(){this.positions=this.cataloguesHttpService.findByType(D.ADMINISTRATORS_POSITION)}loadUnits(){this.units=this.cataloguesHttpService.findByType(D.ADMINISTRATORS_UNIT)}loadUsers(){this.usersHttpService.findAllUsersLDAP().subscribe(i=>{this.users=i})}get administratorFormField(){return this.form.controls.administrator}get unitField(){return this.administratorFormField.controls.unit}get positionField(){return this.administratorFormField.controls.position}get userField(){return this.administratorFormField.controls.user}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-agreement-administrator"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:21,vars:22,consts:[[1,"p-fluid","grid",3,"formGroup"],["formGroupName","administrator",1,"col-12"],[1,"grid"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","unit",3,"label","required"],["id","unit","formControlName","unit","dataKey","id","placeholder","Seleccione","filterBy","name",3,"options","filter"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","position",3,"label","required"],["id","position","formControlName","position","dataKey","id","filterBy","name","placeholder","Seleccione",3,"options","filter"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","user",3,"label","required"],["id","user","formControlName","user","dataKey","email","placeholder","Seleccione","filterBy","email,lastname,name",3,"options","filter"],[1,"flex","align-items-center","gap-2"]],template:function(o,n){o&1&&(s(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),d(4,"label",4),s(5,"p-dropdown",5),_(6,yn,3,1,"ng-template",6)(7,Cn,3,1,"ng-template",7),m(),d(8,"small",8),m(),s(9,"div",3),d(10,"label",9),s(11,"p-dropdown",10),_(12,In,3,1,"ng-template",6)(13,Fn,3,1,"ng-template",7),m(),d(14,"small",8),m(),s(15,"div",11),d(16,"label",12),s(17,"p-dropdown",13),_(18,xn,3,3,"ng-template",6)(19,Tn,3,3,"ng-template",7),m(),d(20,"small",8),m()()()()),o&2&&(l("formGroup",n.form),r(4),l("label",n.AdministratorFormEnum.unit)("required",n.unitField),r(),l("options",n.units)("filter",!0),r(3),l("errors",n.unitField.errors)("touched",n.unitField.touched)("dirty",n.unitField.dirty),r(2),l("label",n.AdministratorFormEnum.position)("required",n.positionField),r(),l("options",n.positions)("filter",!0),r(3),l("errors",n.positionField.errors)("touched",n.positionField.touched)("dirty",n.positionField.dirty),r(2),l("label",n.AdministratorFormEnum.user)("required",n.userField),r(),l("options",n.users)("filter",!0),r(3),l("errors",n.userField.errors)("touched",n.userField.touched)("dirty",n.userField.dirty))},dependencies:[P,H,L,M,G,Re,R,q,O,He]});let t=a;return t})();var An=(t,a)=>a.field,Ti=()=>({width:"50rem"}),pt=()=>({"max-height":"150px"});function Dn(t,a){if(t&1){let e=y();s(0,"h4"),c(1),m(),s(2,"p-button",4),b("click",function(){f(e);let o=p();return h(o.showObligationModal())}),m()}if(t&2){let e=p();r(),S("",e.ObligationForEnum.header,":"),r(),l("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function wn(t,a){if(t&1&&(s(0,"th",7),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function Vn(t,a){if(t&1&&(s(0,"tr")(1,"th"),c(2),m(),B(3,wn,2,2,"th",7,An),s(5,"th"),c(6),m()()),t&2){let e=a.$implicit,i=p(3);r(2),S(" ",i.TableEnum.ACTIONS," "),r(),N(e),r(3),S(" ",i.TableEnum.ACTIONS," ")}}function On(t,a){if(t&1){let e=y();s(0,"li",9)(1,"p-button",11),b("click",function(){let o=f(e).$index,n=p().rowIndex,C=p(3);return h(C.deleteObligationDetail(n,o))}),m(),c(2),m()}if(t&2){let e=a.$implicit,i=p(4);r(),l("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),r(),S(" ",e.description," ")}}function Bn(t,a){if(t&1){let e=y();s(0,"tr")(1,"td")(2,"p-button",8),b("click",function(){let o=f(e).rowIndex,n=p(3);return h(n.deleteObligation(o))}),m()(),s(3,"td"),c(4),m(),s(5,"td"),c(6),m(),s(7,"td")(8,"ul"),B(9,On,3,4,"li",9,_e),m()(),s(11,"td")(12,"div",10)(13,"p-button",8),b("click",function(){let o=f(e).rowIndex,n=p(3);return h(n.showObligationDetailModal(o))}),m()()()()}if(t&2){let e=a.$implicit,i=p(3);r(2),l("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),r(2),E(e.institutionName),r(2),E(e.type==null?null:e.type.name),r(3),N(e.obligationDetails),r(4),l("icon",i.IconButtonActionEnum.ADD)("severity",i.SeverityButtonActionEnum.ADD)("pTooltip",i.LabelButtonActionEnum.ADD)}}function Nn(t,a){if(t&1&&(s(0,"p-table",5),_(1,Vn,7,2,"ng-template",0)(2,Bn,14,8,"ng-template",6),m()),t&2){let e=p(2);l("value",e.formInput.obligations)("columns",e.columns)}}function kn(t,a){if(t&1&&_(0,Nn,3,2,"p-table",5),t&2){let e=p();I(0,e.formInput.obligations.length>0?0:-1)}}function Ln(t,a){if(t&1&&d(0,"p-listbox",21),t&2){let e=p(3);l("options",e.formInput.externalInstitutions)("filter",!0)("listStyle",T(3,pt))}}function Pn(t,a){if(t&1&&d(0,"p-listbox",22),t&2){let e=p(3);l("options",e.institutions)("multiple",!0)("filter",!0)("listStyle",T(4,pt))}}function Mn(t,a){if(t&1&&(s(0,"div",13),d(1,"label",20),_(2,Ln,1,4,"p-listbox",21)(3,Pn,1,5,"p-listbox",22),d(4,"small",16),m()),t&2){let e=p(2);r(),l("label",e.ObligationForEnum.institutionName)("required",e.obligationInstitutionNameField),r(),I(2,e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.EXTERNAL?2:-1),r(),I(3,e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.JOIN?3:-1),r(),l("errors",e.obligationInstitutionNameField.errors)("touched",e.obligationInstitutionNameField.touched)("dirty",e.obligationInstitutionNameField.dirty)}}function Rn(t,a){if(t&1&&(s(0,"form",12)(1,"div",13),d(2,"label",14)(3,"p-listbox",15)(4,"small",16),m(),s(5,"div",13)(6,"form",17),d(7,"label",18)(8,"textarea",19)(9,"small",16),m()(),_(10,Mn,5,7,"div",13),m()),t&2){let e=p();l("formGroup",e.obligationForm),r(2),l("label",e.ObligationForEnum.type)("required",e.obligationTypeField),r(),l("options",e.obligationTypes)("listStyle",T(15,pt)),r(),l("errors",e.obligationTypeField.errors)("touched",e.obligationTypeField.touched)("dirty",e.obligationTypeField.dirty),r(2),l("formGroup",e.obligationDetailForm),r(),l("label",e.ObligationDetailForEnum.description)("required",e.obligationDetailDescriptionField),r(2),l("errors",e.obligationDetailDescriptionField.errors)("touched",e.obligationDetailDescriptionField.touched)("dirty",e.obligationDetailDescriptionField.dirty),r(),I(10,e.obligationTypeField.value&&(e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.EXTERNAL||e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.JOIN)?10:-1)}}function qn(t,a){if(t&1){let e=y();s(0,"p-button",23),b("click",function(){f(e);let o=p();return h(o.isVisibleObligationForm=!1)}),m(),s(1,"p-button",24),b("click",function(){f(e);let o=p();return h(o.addObligation())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Hn(t,a){if(t&1&&(s(0,"form",12)(1,"div",13),d(2,"label",25)(3,"textarea",26)(4,"small",16),m()()),t&2){let e=p();l("formGroup",e.obligationDetailForm),r(2),l("label",e.ObligationDetailForEnum.description)("required",e.obligationDetailDescriptionField),r(2),l("errors",e.obligationDetailDescriptionField.errors)("touched",e.obligationDetailDescriptionField.touched)("dirty",e.obligationDetailDescriptionField.dirty)}}function Gn(t,a){if(t&1){let e=y();s(0,"p-button",23),b("click",function(){f(e);let o=p();return h(o.isVisibleObligationDetailForm=!1)}),m(),s(1,"p-button",24),b("click",function(){f(e);let o=p();return h(o.addObligationDetail())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var Si=(()=>{let a=class a{constructor(){this.formBuilder=g(V),this.messageDialogService=g(w),this.formInput=te(),this.formOutput=new x,this.formErrorsOutput=new x,this.cataloguesHttpService=g(k),this.coreService=g(U),this.obligationTypes=[],this.institutions=[],this.SkeletonEnum=W,this.SeverityButtonActionEnum=j,this.PrimeIcons=$,this.formErrors=[],this.IconButtonActionEnum=ne,this.LabelButtonActionEnum=ie,this.CatalogueObligationsTypeEnum=ke,this.TableEnum=re,this.isVisibleObligationForm=!1,this.isVisibleObligationDetailForm=!1,this.ObligationForEnum=Pe,this.ObligationDetailForEnum=rt,this.columns=[],this.index=-1,this.buildForm(),this.buildObligationForm(),this.buildObligationDetailForm(),this.buildColumns(),this.checkValueChanges()}ngOnInit(){this.loadObligationTypes(),this.loadInstitutions(),this.patchValueForm(),this.validateForm()}buildColumns(){this.columns=[{field:"institutionName",header:Pe.institutionName},{field:"type",header:Pe.type},{field:"obligations",header:rt.description}]}buildForm(){this.form=this.formBuilder.group({obligations:this.formBuilder.array([],u.required)})}buildObligationForm(){this.obligationForm=this.formBuilder.group({institutionName:[null,[u.required]],type:[null,[u.required]]})}buildObligationDetailForm(){this.obligationDetailForm=this.formBuilder.group({description:[null,[u.required]]})}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.obligationTypeField.valueChanges.subscribe(i=>{this.obligationInstitutionNameField.reset(),i&&i.code===ke.INTERNAL&&this.formInput.internalInstitutions&&this.obligationInstitutionNameField.setValue(this.formInput.internalInstitutions[0].name)})}validateForm(){this.formErrors=[],this.formInput.obligations?.length===0&&this.formErrors.push("Obligaciones"),this.formErrorsOutput.emit(this.formErrors)}validateObligationForm(){return this.formErrors=[],this.obligationTypeField.invalid&&this.formErrors.push(this.ObligationForEnum.type),this.obligationInstitutionNameField.invalid&&this.formErrors.push(this.ObligationForEnum.institutionName),this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}validateObligationDetailForm(){return this.formErrors=[],this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}loadObligationTypes(){this.obligationTypes=this.cataloguesHttpService.findByType(D.OBLIGATIONS_TYPE)}loadInstitutions(){this.institutions=[];let i=[],o=[];this.formInput.internalInstitutions&&(i=this.formInput.internalInstitutions.map(n=>n.name)),this.formInput.externalInstitutions&&(o=this.formInput.externalInstitutions.map(n=>n.name)),this.institutions=i.concat(o)}addObligation(){if(this.validateObligationForm()){let i=this.obligationForm.value;if(i.institutionName=i.institutionName.toString(),i.obligationDetails=[this.obligationDetailForm.value],this.obligationTypeField.value.code===ke.JOIN&&this.obligationInstitutionNameField.value.length<2){this.messageDialogService.errorCustom("M\xEDnimo requerido","Debe seleccionar al menos 2 (dos) Instituciones");return}if(this.formInput.obligations.findIndex(o=>o.institutionName===i.institutionName)>-1){this.messageDialogService.errorCustom("Duplicado","La Instituci\xF3n ya est\xE1 registrada, intente con otra por favor");return}this.formInput.obligations.push(i),this.form.patchValue(this.formInput),this.obligationForm.reset(),this.obligationDetailForm.reset(),this.isVisibleObligationForm=!1}else this.obligationForm.markAllAsTouched(),this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}addObligationDetail(){this.validateObligationDetailForm()?(this.formInput.obligations&&(this.formInput.obligations[this.index].obligationDetails?this.formInput.obligations[this.index].obligationDetails?.push(this.obligationDetailForm.value):this.formInput.obligations[this.index].obligationDetails=[this.obligationDetailForm.value]),this.form.patchValue(this.formInput),this.obligationDetailForm.reset(),this.isVisibleObligationDetailForm=!1):(this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}deleteObligation(i){this.formInput.obligations?.splice(i,1),this.form.patchValue(this.formInput)}deleteObligationDetail(i,o){this.formInput.obligations[i].obligationDetails?.splice(o,1),this.formInput.obligations[i].obligationDetails.length===0&&this.formInput.obligations.splice(i,1),this.form.patchValue(this.formInput)}showObligationModal(){this.isVisibleObligationForm=!0}showObligationDetailModal(i){this.isVisibleObligationDetailForm=!0,this.index=i}get obligationInstitutionNameField(){return this.obligationForm.controls.institutionName}get obligationTypeField(){return this.obligationForm.controls.type}get obligationDetailDescriptionField(){return this.obligationDetailForm.controls.description}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-obligation"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:9,vars:10,consts:[["pTemplate","header"],["pTemplate","content"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","footer"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","severity","pTooltip"],[1,"mt-1"],[1,"button-group"],["size","small",3,"click","icon","severity","pTooltip"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","optionLabel","name",3,"options","listStyle"],["appErrorMessage","",3,"errors","touched","dirty"],[3,"formGroup"],["appLabel","","for","description",3,"label","required"],["pInputTextarea","","id","description","formControlName","description"],["appLabel","","for","institutionName",3,"label","required"],["id","institutionName","formControlName","institutionName","optionLabel","name","optionValue","name",3,"options","filter","listStyle"],["formControlName","institutionName",3,"options","multiple","filter","listStyle"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"],["appLabel","","for","descriptionEdit",3,"label","required"],["pInputTextarea","","id","descriptionEdit","formControlName","description"]],template:function(o,n){o&1&&(s(0,"p-panel"),_(1,Dn,3,4,"ng-template",0)(2,kn,1,1,"ng-template",1),m(),s(3,"p-dialog",2),ee("visibleChange",function(v){return Z(n.isVisibleObligationForm,v)||(n.isVisibleObligationForm=v),v}),_(4,Rn,11,16,"ng-template",1)(5,qn,2,7,"ng-template",3),m(),s(6,"p-dialog",2),ee("visibleChange",function(v){return Z(n.isVisibleObligationDetailForm,v)||(n.isVisibleObligationDetailForm=v),v}),_(7,Hn,5,6,"ng-template",1)(8,Gn,2,7,"ng-template",3),m()),o&2&&(r(3),J(T(8,Ti)),X("visible",n.isVisibleObligationForm),l("modal",!0),r(3),J(T(9,Ti)),X("visible",n.isVisibleObligationDetailForm),l("modal",!0))},dependencies:[P,Q,H,L,M,G,R,q,ae,O,le,se,Te,me,pe,he,Fe]});let t=a;return t})();var Un=(t,a)=>a.field,jn=()=>({width:"50rem"}),Wn=()=>({"max-height":"150px"});function zn(t,a){if(t&1){let e=y();s(0,"p-button",9),b("click",function(){f(e);let o=p(3);return h(o.showFinancingModal())}),m()}if(t&2){let e=p(3);l("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Qn(t,a){if(t&1&&(s(0,"h4"),c(1),m(),_(2,zn,1,3,"p-button",8)),t&2){let e=p(2);r(),S("",e.FinancingsFormEnum.header,":"),r(),I(2,e.isFinancingField.value?2:-1)}}function Kn(t,a){if(t&1&&(s(0,"th",12),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function Yn(t,a){if(t&1&&(s(0,"tr"),B(1,Kn,2,2,"th",12,Un),s(3,"th",13),c(4),m()()),t&2){let e=a.$implicit,i=p(4);r(),N(e),r(3),S(" ",i.TableEnum.ACTIONS," ")}}function Jn(t,a){if(t&1){let e=y();s(0,"tr")(1,"td"),c(2),m(),s(3,"td"),c(4),m(),s(5,"td"),c(6),m(),s(7,"td"),c(8),m(),s(9,"td")(10,"p-button",14),b("click",function(){let o=f(e).rowIndex,n=p(4);return h(n.deleteFinancing(o))}),m()()()}if(t&2){let e=a.$implicit,i=p(4);r(2),E(e.institutionName),r(2),E(e.budget),r(2),E(e.paymentMethod),r(2),E(e.source),r(2),l("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)}}function Xn(t,a){if(t&1&&(s(0,"p-table",10),_(1,Yn,5,1,"ng-template",7)(2,Jn,11,7,"ng-template",11),m()),t&2){let e=p(3);l("value",e.formInput.financings)("columns",e.financingsColumns)}}function Zn(t,a){if(t&1&&_(0,Xn,3,2,"p-table",10),t&2){let e=p(2);I(0,e.isFinancingField.value&&e.formInput.financings.length>0?0:-1)}}function er(t,a){t&1&&(s(0,"p-panel"),_(1,Qn,3,2,"ng-template",7)(2,Zn,1,1,"ng-template",5),m())}function tr(t,a){if(t&1&&(s(0,"form",15)(1,"div",16),d(2,"label",17)(3,"p-inputNumber",18)(4,"small",19),m(),s(5,"div",16),d(6,"label",20)(7,"input",21)(8,"small",19),m(),s(9,"div",16),d(10,"label",22)(11,"input",23)(12,"small",19),m(),s(13,"div",1),d(14,"label",24)(15,"p-listbox",25)(16,"small",19),m()()),t&2){let e=p();l("formGroup",e.financingForm),r(2),l("label",e.FinancingsFormEnum.budget)("required",e.budgetField),r(),l("minFractionDigits",2)("maxFractionDigits",2),r(),l("errors",e.budgetField.errors)("touched",e.budgetField.touched)("dirty",e.budgetField.dirty),r(2),l("label",e.FinancingsFormEnum.paymentMethod)("required",e.paymentMethodField),r(2),l("errors",e.paymentMethodField.errors)("touched",e.paymentMethodField.touched)("dirty",e.paymentMethodField.dirty),r(2),l("label",e.FinancingsFormEnum.source)("required",e.sourceField),r(2),l("errors",e.sourceField.errors)("touched",e.sourceField.touched)("dirty",e.sourceField.dirty),r(2),l("label",e.FinancingsFormEnum.institutionName)("required",e.institutionNameField),r(),l("options",e.combinedInstitutions)("filter",!0)("listStyle",T(26,Wn)),r(),l("errors",e.institutionNameField.errors)("touched",e.institutionNameField.touched)("dirty",e.institutionNameField.dirty)}}function ir(t,a){if(t&1){let e=y();s(0,"p-button",26),b("click",function(){f(e);let o=p();return h(o.isVisibleFinancingForm=!1)}),m(),s(1,"p-button",27),b("click",function(){f(e);let o=p();return h(o.addFinancing())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var Ai=(()=>{let a=class a{constructor(){this.authService=g(ce),this.cataloguesHttpService=g(k),this.coreService=g(U),this.formBuilder=g(V),this.messageDialogService=g(w),this.financingsColumns=[],this.formInput=te(),this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.combinedInstitutions=[],this.AgreementFormEnum=F,this.SeverityButtonActionEnum=j,this.IconButtonActionEnum=ne,this.LabelButtonActionEnum=ie,this.FinancingsFormEnum=oe,this.SkeletonEnum=W,this.TableEnum=re,this.isVisibleFinancingForm=!1,this.buildForm(),this.buildFinancingForm(),this.buildFinancingsColumns(),this.checkValueChanges()}ngOnInit(){this.loadCombineInstitutions(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({isFinancing:[null,[u.required]],financings:this.formBuilder.array([],u.required)})}buildFinancingForm(){this.financingForm=this.formBuilder.group({institutionName:[null,[u.required]],budget:[null,[u.required,u.pattern(/^\d+(\.\d{2,2})?$/)]],paymentMethod:[null,[u.required,u.pattern(Ae())]],source:[null,[u.required,u.pattern(Ae())]]})}buildFinancingsColumns(){this.financingsColumns=[{field:"institutionName",header:oe.institutionName},{field:"budget",header:oe.budget},{field:"paymentMethod",header:oe.paymentMethod},{field:"source",header:oe.source}]}addFinancing(){if(this.validateFinancingForm()){if(this.formInput.financings.findIndex(i=>i.institutionName===this.financingForm.value.institutionName)>-1){this.messageDialogService.errorCustom("La entidad ya est\xE1 registrada","Intente con otra por favor");return}this.formInput.financings.push(this.financingForm.value),this.form.patchValue(this.formInput),this.financingForm.reset(),this.isVisibleFinancingForm=!1}else this.financingForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}deleteFinancing(i){this.formInput.financings.splice(i,1),this.form.patchValue(this.formInput)}loadCombineInstitutions(){this.combinedInstitutions=[];let i=[],o=[];this.formInput.internalInstitutions&&(i=this.formInput.internalInstitutions.map(n=>n.name)),this.formInput.externalInstitutions&&(o=this.formInput.externalInstitutions.map(n=>n.name)),this.combinedInstitutions=i.concat(o)}validateForm(){this.formErrors=[],this.isFinancingField.value&&this.formInput.financings&&this.formInput.financings.length===0&&this.formErrors.push("Financiamientos"),this.formErrorsOutput.emit(this.formErrors)}validateFinancingForm(){return this.formErrors=[],this.institutionNameField.invalid&&this.formErrors.push(oe.institutionName),this.budgetField.invalid&&this.formErrors.push(oe.budget),this.paymentMethodField.invalid&&this.formErrors.push(oe.paymentMethod),this.sourceField.invalid&&this.formErrors.push(oe.source),this.formErrors.length===0}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.isFinancingField.valueChanges.subscribe(i=>{this.formInput.isFinancing=i,i?(this.institutionNameField.setValidators(u.required),this.budgetField.setValidators(u.required),this.paymentMethodField.setValidators(u.required),this.sourceField.setValidators(u.required)):(this.institutionNameField.clearValidators(),this.budgetField.clearValidators(),this.paymentMethodField.clearValidators(),this.sourceField.clearValidators()),this.financingForm.reset(),this.institutionNameField.updateValueAndValidity(),this.budgetField.updateValueAndValidity(),this.paymentMethodField.updateValueAndValidity(),this.sourceField.updateValueAndValidity()})}showFinancingModal(){this.isVisibleFinancingForm=!0}get isFinancingField(){return this.form.controls.isFinancing}get institutionNameField(){return this.financingForm.controls.institutionName}get budgetField(){return this.financingForm.controls.budget}get paymentMethodField(){return this.financingForm.controls.paymentMethod}get sourceField(){return this.financingForm.controls.source}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-financing"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:8,vars:9,consts:[[1,"p-fluid","grid","text-center",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","",3,"label","required"],["formControlName","isFinancing",1,"ml-2"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["pTemplate","header"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"text-center"],[3,"click","icon","severity","pTooltip"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","","for","budget",3,"label","required"],["id","budget","formControlName","budget","mode","decimal",3,"minFractionDigits","maxFractionDigits"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","paymentMethod",3,"label","required"],["pInputText","","id","paymentMethod","formControlName","paymentMethod"],["appLabel","","for","source",3,"label","required"],["pInputText","","id","source","formControlName","source"],["appLabel","","for","combinedInstitution",3,"label","required"],["id","combinedInstitution","formControlName","institutionName",3,"options","filter","listStyle"],[3,"click","label","icon","text","severity"],[3,"click","label","icon","severity"]],template:function(o,n){o&1&&(s(0,"form",0)(1,"div",1),d(2,"label",2)(3,"p-inputSwitch",3),m()(),_(4,er,3,0,"p-panel"),s(5,"p-dialog",4),ee("visibleChange",function(v){return Z(n.isVisibleFinancingForm,v)||(n.isVisibleFinancingForm=v),v}),_(6,tr,17,27,"ng-template",5)(7,ir,2,7,"ng-template",6),m()),o&2&&(l("formGroup",n.form),r(2),l("label",n.AgreementFormEnum.isFinancing)("required",n.isFinancingField),r(2),I(4,n.isFinancingField.value?4:-1),r(),J(T(8,jn)),X("visible",n.isVisibleFinancingForm),l("modal",!0))},dependencies:[P,Q,H,L,M,G,R,q,ae,O,le,fe,se,xe,me,pe,he,Se,Fe]});let t=a;return t})();var lr=(t,a)=>a.id,sr=(t,a)=>a.field;function mr(t,a){if(t&1&&(d(0,"i"),s(1,"div",11),c(2),m()),t&2){let e=p().$implicit,i=p();De(i.PrimeIcons.FILE_PDF),r(2),S(" ",e.name," ")}}function pr(t,a){if(t&1){let e=y();s(0,"div",3),d(1,"label",4),s(2,"p-messages",5),_(3,mr,3,3,"ng-template",6),m()(),s(4,"div",7),d(5,"label",8)(6,"p-divider"),s(7,"p-fileUpload",9,0),b("uploadHandler",function(o){let n=f(e).$implicit,C=Oe(8),v=p();return h(v.uploadFile(o,C,n))}),m(),d(9,"small",10),m()}if(t&2){let e=p();r(),l("label",e.FileFormEnum.type)("required",e.typeField),r(4),l("label",e.FileFormEnum.myFile)("required",e.fileField),r(2),l("chooseIcon",e.PrimeIcons.UPLOAD)("auto",!0)("customUpload",!0),r(2),l("errors",e.fileField.errors)("touched",e.fileField.touched)("dirty",e.fileField.dirty)}}function dr(t,a){if(t&1&&(s(0,"th",14),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function ur(t,a){if(t&1&&(s(0,"tr"),B(1,dr,2,2,"th",14,sr),s(3,"th"),c(4),m()()),t&2){let e=a.$implicit,i=p(2);r(),N(e),r(3),E(i.TableEnum.ACTIONS)}}function cr(t,a){if(t&1){let e=y();s(0,"tr")(1,"td"),c(2),m(),s(3,"td"),c(4),m(),s(5,"td")(6,"p-button",15),b("click",function(){let o=f(e),n=o.$implicit,C=o.rowIndex,v=p(2);return h(v.removeFile(C,n))}),m()()()}if(t&2){let e=a.$implicit,i=p(2);r(2),E(e.type.name),r(2),E(e.name),r(2),l("icon",i.IconButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)}}function fr(t,a){if(t&1&&(s(0,"p-table",2),_(1,ur,5,1,"ng-template",12)(2,cr,7,5,"ng-template",13),m()),t&2){let e=p();l("value",e.formInput.enablingDocuments)("columns",e.columns)}}var Di=(()=>{let a=class a{constructor(){this.formInput=te(),this.formOutput=new x,this.formErrorsOutput=new x,this.cataloguesHttpService=g(k),this.messageDialogService=g(w),this.filesHttpService=g(Ft),this.agreementsHttpService=g(ue),this.confirmationService=g(Ne),this.formBuilder=g(V),this.formErrors=[],this.LabelButtonActionEnum=ie,this.IconButtonActionEnum=ne,this.FileFormEnum=Le,this.TableEnum=re,this.SeverityButtonActionEnum=j,this.PrimeIcons=$,this.types=[],this.typesClone=[],this.columns=[],this.buildForm(),this.buildFileForm(),this.buildColumns()}ngOnInit(){this.loadTypes(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({files:this.formBuilder.array([],u.required)}),this.checkValuesChange()}buildFileForm(){this.fileForm=this.formBuilder.group({type:[null,u.required],myFile:[null,u.required]}),this.checkValuesChange()}checkValuesChange(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()})}buildColumns(){this.columns=[{field:"type",header:Le.type},{field:"name",header:Le.name}]}loadTypes(){this.types=this.cataloguesHttpService.findByType(D.AGREEMENTS_ENABLING_DOCUMENT),this.typesClone=this.cataloguesHttpService.findByType(D.AGREEMENTS_ENABLING_DOCUMENT);for(let i=0;i<this.formInput.enablingDocuments.length;i++){let o=this.types.findIndex(n=>n.id===this.formInput.enablingDocuments[i].type?.id);this.types.splice(o,1)}}validateForm(){this.formErrors=[],this.formInput.enablingDocuments.length<2&&this.formErrors.push(`Debe cargar los ${this.types.length} tipos de archivos`),this.formErrorsOutput.emit(this.formErrors)}validateFileForm(i,o){return this.formErrors=[],this.formInput.enablingDocuments.findIndex(n=>n.type?.id===o.id)>-1&&this.formErrors.push(`${o.name} ya se encuentra cargado`),this.formInput.enablingDocuments.findIndex(n=>n.name===i.name)>-1&&this.formErrors.push(`El archivo ${i.name} ya se encuentra cargado`),this.formErrors.length===0}uploadFile(i,o,n){let C=i.files[0];if(this.validateFileForm(C,n)){let v=new FormData;v.append("file",C),v.append("typeId",n.id),this.agreementsHttpService.uploadEnablingDocument(this.formInput.id,v).subscribe(Je=>{this.formInput.enablingDocuments.push({id:Je.id,name:C.name,type:n});let Ni=this.types.findIndex(ki=>ki.id===n.id);this.types.splice(Ni,1),this.form.patchValue(this.formInput)})}else this.messageDialogService.fieldErrors(this.formErrors),this.form.markAllAsTouched();o.clear()}removeFile(i,o){this.filesHttpService.remove(o.id).subscribe(n=>{this.formInput.enablingDocuments.splice(i,1),this.types.push(o.type),this.form.patchValue(this.formInput.enablingDocuments)})}get typeField(){return this.fileForm.controls.type}get fileField(){return this.fileForm.controls.myFile}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-document"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:4,vars:2,consts:[["uploadFiles",""],[1,"p-fluid","grid",3,"formGroup"],["styleClass","p-datatable-striped",3,"value","columns"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","",3,"label","required"],["severity","info"],["pTemplate",""],[1,"field","col-12","xl:col-2","lg:col-2","md:col-2","sm:col-12"],["appLabel","","for","file",3,"label","required"],["id","file","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf","maxFileSize","1000000",3,"uploadHandler","chooseIcon","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"ml-2"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","pTooltip","severity"]],template:function(o,n){o&1&&(s(0,"form",1),B(1,pr,10,10,null,null,lr),m(),_(3,fr,3,2,"p-table",2)),o&2&&(l("formGroup",n.fileForm),r(),N(n.types),r(2),I(3,n.formInput.enablingDocuments.length>0?3:-1))},dependencies:[P,L,M,R,q,ae,O,le,qe,$e,Ge,me,pe]});let t=a;return t})();var _r=(t,a)=>a.field,gr=()=>({width:"50rem"});function br(t,a){if(t&1&&(s(0,"p"),d(1,"p-tag",8),m()),t&2){let e=p();r(),l("severity",e.SeverityButtonActionEnum.DELETE)}}function vr(t,a){if(t&1){let e=y();s(0,"p-button",11),b("click",function(){f(e);let o=p(3);return h(o.showAddendumModal())}),m()}if(t&2){let e=p(3);l("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Er(t,a){if(t&1&&(s(0,"h4"),c(1),m(),_(2,vr,1,3,"p-button",10)),t&2){let e=p(2);r(),S("",e.AddendumEnum.header,":"),r(),I(2,e.isAddendumField.value?2:-1)}}function yr(t,a){if(t&1&&(s(0,"th",14),c(1),m()),t&2){let e=a.$implicit;l("pSortableColumn",e.field),r(),S(" ",e.header," ")}}function Cr(t,a){if(t&1&&(s(0,"tr"),B(1,yr,2,2,"th",14,_r),s(3,"th"),c(4),m()()),t&2){let e=a.$implicit,i=p(4);r(),N(e),r(3),E(i.TableEnum.ACTIONS)}}function Ir(t,a){if(t&1&&c(0),t&2){let e=a.$implicit;S(" ",e.name," ")}}function Fr(t,a){if(t&1){let e=y();s(0,"tr")(1,"td"),c(2),m(),s(3,"td"),B(4,Ir,1,1,null,null,_e),m(),s(6,"td")(7,"p-button",15),b("click",function(){let o=f(e).$implicit,n=p(4);return h(n.deleteAddendum(o.id))}),m()()()}if(t&2){let e=a.$implicit,i=p(4);r(2),E(e.description),r(2),N(e.files),r(3),l("icon",i.IconButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)}}function xr(t,a){if(t&1&&(s(0,"p-table",12),_(1,Cr,5,1,"ng-template",9)(2,Fr,8,4,"ng-template",13),m()),t&2){let e=p(3);l("value",e.formInput.addendums)("columns",e.columns)}}function Tr(t,a){if(t&1&&_(0,xr,3,2,"p-table",12),t&2){let e=p(2);I(0,e.formInput.addendums.length>0?0:-1)}}function Sr(t,a){t&1&&(s(0,"p-panel"),_(1,Er,3,2,"ng-template",9)(2,Tr,1,1,"ng-template",6),m())}function Ar(t,a){if(t&1&&(d(0,"i"),s(1,"div",25),c(2),m()),t&2){let e=p(3);De(e.PrimeIcons.FILE_PDF),r(2),E(e.fileField.value==null?null:e.fileField.value.name)}}function Dr(t,a){t&1&&(s(0,"div",20)(1,"p-messages",23),_(2,Ar,3,3,"ng-template",24),m()())}function wr(t,a){if(t&1){let e=y();s(0,"div",16)(1,"div",2),d(2,"label",17)(3,"input",18)(4,"small",19),m(),s(5,"div",20),d(6,"label",21),s(7,"p-fileUpload",22,0),b("uploadHandler",function(o){f(e);let n=Oe(8),C=p();return h(C.uploadAddendumFile(o,n))}),m(),d(9,"small",19),m(),_(10,Dr,3,0,"div",20),m()}if(t&2){let e=p();l("formGroup",e.addendumForm),r(2),l("label",e.AddendumEnum.description)("required",e.descriptionField),r(2),l("errors",e.descriptionField.errors)("touched",e.descriptionField.touched)("dirty",e.descriptionField.dirty),r(2),l("label",e.AddendumEnum.file)("required",e.fileField),r(),l("chooseIcon",e.PrimeIcons.UPLOAD)("auto",!0)("customUpload",!0),r(2),l("errors",e.fileField.errors)("touched",e.fileField.touched)("dirty",e.fileField.dirty),r(),I(10,e.fileField.value?10:-1)}}function Vr(t,a){if(t&1){let e=y();s(0,"p-button",26),b("click",function(){f(e);let o=p();return h(o.isVisibleAddendumForm=!1)}),m(),s(1,"p-button",27),b("click",function(){f(e);let o=p();return h(o.onUpload())}),m()}if(t&2){let e=p();l("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),r(),l("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var wi=(()=>{let a=class a{constructor(){this.formInput=te(),this.formOutput=new x,this.formErrorsOutput=new x,this.agreementsHttpService=g(ue),this.addendumsHttpService=g(xt),this.cataloguesHttpService=g(k),this.messageDialogService=g(w),this.formBuilder=g(V),this.formErrors=[],this.LabelButtonActionEnum=ie,this.IconButtonActionEnum=ne,this.AddendumEnum=Ve,this.AgreementFormEnum=F,this.TableEnum=re,this.SeverityButtonActionEnum=j,this.PrimeIcons=$,this.types=[],this.columns=[],this.isVisibleAddendumForm=!1,this.yesNo=[],this.buildForm(),this.buildAddendumForm(),this.buildFileForm(),this.checkValuesChange(),this.buildColumns(),this.yesNo=[{label:"Si",value:!0},{label:"No",value:!1}]}ngOnInit(){this.loadTypes(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput),this.formInput.addendums.length>0?this.isAddendumField.disable():this.isAddendumField.enable()}buildForm(){this.form=this.formBuilder.group({isAddendum:[!1],addendums:this.formBuilder.array([],u.required)})}buildAddendumForm(){this.addendumForm=this.formBuilder.group({description:[null],file:[null]})}buildFileForm(){this.fileForm=this.formBuilder.group({type:[null,u.required],myFile:[null,u.required]}),this.checkValuesChange()}checkValuesChange(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.isAddendumField.valueChanges.subscribe(i=>{this.formInput.isAddendum=i,i?(this.descriptionField.setValidators(u.required),this.fileField.setValidators(u.required)):(this.descriptionField.clearValidators(),this.fileField.clearValidators()),this.descriptionField.updateValueAndValidity()})}buildColumns(){this.columns=[{field:"description",header:Ve.description},{field:"file",header:Ve.file}]}loadTypes(){this.types=this.cataloguesHttpService.findByType(D.AGREEMENTS_ADDENDUM_DOCUMENT)}validateForm(){this.formErrors=[],this.formErrorsOutput.emit(this.formErrors)}validateAddendumForm(){return this.formErrors=[],this.descriptionField.invalid&&this.formErrors.push(Ve.description),this.formErrors.length===0}uploadAddendumFile(i,o){this.fileField.patchValue({file:i.files[0],name:i.files[0].name,type:this.types[0]}),o.clear()}onUpload(){if(this.validateAddendumForm()){let i=new FormData;i.append("file",this.fileField.value.file),i.append("typeId",this.fileField.value.type.id),i.append("description",this.descriptionField.value),this.agreementsHttpService.uploadAddendum(this.formInput.id,i).subscribe(o=>{this.formInput.addendums.push({id:o.id,description:this.descriptionField.value,files:[{file:this.fileField.value.file,name:this.fileField.value.name}]}),this.form.patchValue(this.formInput),this.addendumForm.reset(),this.isVisibleAddendumForm=!1,this.formInput.addendums.length>0&&this.isAddendumField.disable()})}else this.messageDialogService.fieldErrors(this.formErrors),this.form.markAllAsTouched(),this.addendumForm.markAllAsTouched()}showAddendumModal(){this.isVisibleAddendumForm=!0}deleteAddendum(i){this.addendumsHttpService.remove(i).subscribe(o=>{let n=this.formInput.addendums.findIndex(C=>C.id===i);this.formInput.addendums.splice(n,1),this.form.patchValue(this.formInput),this.formInput.addendums.length===0&&this.isAddendumField.enable()})}get isAddendumField(){return this.form.controls.isAddendum}get descriptionField(){return this.addendumForm.controls.description}get fileField(){return this.addendumForm.controls.file}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-addendum"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:11,vars:10,consts:[["uploadFiles",""],[1,"p-fluid","grid","text-center",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","",3,"label","required"],["formControlName","isAddendum",1,"ml-2"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["value","Debe eliminar todas las adendas antes de poder cambiar de opci\xF3n",1,"ml-2",3,"severity"],["pTemplate","header"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","pTooltip","severity"],[1,"p-fluid","grid",3,"formGroup"],["appLabel","","for","description",3,"label","required"],["pInputText","","type","text","id","description","formControlName","description"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","file",3,"label","required"],["id","file","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf","maxFileSize","1000000",3,"uploadHandler","chooseIcon","auto","customUpload"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(o,n){o&1&&(s(0,"h3"),c(1,`La secci\xF3n que se muestra a continuaci\xF3n no es de car\xE1cter obligatorio, sin embargo, si se ha realizado una adenda o modificatorio al convenio, por favor complete los siguientes campos:
`),m(),s(2,"form",1)(3,"div",2),d(4,"label",3)(5,"p-inputSwitch",4),_(6,br,2,1,"p"),m()(),_(7,Sr,3,0,"p-panel"),s(8,"p-dialog",5),ee("visibleChange",function(v){return Z(n.isVisibleAddendumForm,v)||(n.isVisibleAddendumForm=v),v}),_(9,wr,11,15,"ng-template",6)(10,Vr,2,7,"ng-template",7),m()),o&2&&(r(2),l("formGroup",n.form),r(2),l("label",n.AgreementFormEnum.isAddendum)("required",n.isAddendumField),r(2),I(6,n.formInput.addendums.length>0?6:-1),r(),I(7,n.formInput.isAddendum?7:-1),r(),J(T(9,gr)),X("visible",n.isVisibleAddendumForm),l("modal",!0))},dependencies:[P,Q,H,L,M,G,R,q,ae,O,le,fe,se,$e,Ge,me,pe,he,Se,ei]});let t=a;return t})();function Br(t,a){if(t&1){let e=y();s(0,"p-toolbar")(1,"div",8),d(2,"app-header-form",9),m(),s(3,"div",10)(4,"app-form-button-action",11),b("submit",function(){let o=f(e).nextCallback,n=p(2);return h(n.validateFormAgreement(o))})("cancel",function(){f(e);let o=p(2);return h(o.redirectAgreementList())}),m()()(),d(5,"p-divider"),s(6,"div",12)(7,"p-panel",13)(8,"app-basic-data",14),b("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.basicDataErrors=o)})("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))}),m()(),s(9,"p-panel",15)(10,"app-agreement-date",14),b("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.agreementDateErrors=o)})("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))}),m()(),s(11,"p-panel",16)(12,"app-agreement-administrator",17),b("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.agreementAdministratorErrors=o)})("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))}),m()(),s(13,"p-panel",18)(14,"app-appearer",14),b("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.appearerErrors=o)})("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))}),m()()(),s(15,"p-toolbar")(16,"div",8),d(17,"app-header-form",9),m(),s(18,"div",10)(19,"app-form-button-action",19),b("submit",function(){let o=f(e).nextCallback,n=p(2);return h(n.validateFormAgreement(o))}),m()()()}if(t&2){let e=p(2);r(2),l("icon",e.PrimeIcons.PENCIL),r(2),l("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!0),r(4),l("formInput",e.form.value),r(2),l("formInput",e.form.value),r(2),l("formInput",e.form.value),r(2),l("formInput",e.form.value),r(3),l("icon",e.PrimeIcons.PENCIL),r(2),l("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1)}}function Nr(t,a){if(t&1){let e=y();s(0,"p-toolbar")(1,"div",8),d(2,"app-header-form",9),m(),s(3,"div",10)(4,"app-form-button-action",20),b("submit",function(){let o=f(e).nextCallback,n=p(2);return h(n.validateFormObligation(o))})("cancel",function(){let o=f(e).prevCallback;return h(o.emit())}),m()()(),d(5,"p-divider"),s(6,"app-obligation",14),b("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.obligationErrors=o)})("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))}),m()}if(t&2){let e=p(2);r(2),l("icon",e.PrimeIcons.PENCIL),r(2),l("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!0),r(2),l("formInput",e.form.value)}}function kr(t,a){if(t&1){let e=y();s(0,"p-toolbar")(1,"div",8),d(2,"app-header-form",9),m(),s(3,"div",10)(4,"app-form-button-action",21),b("submit",function(){let o=f(e).nextCallback,n=p(2);return h(n.onSubmitAgreement(o))})("cancel",function(){let o=f(e).prevCallback;return h(o.emit())}),m()()(),d(5,"p-divider"),s(6,"app-financing",22),b("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))})("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.financingErrors=o)}),m()}if(t&2){let e=p(2);r(2),l("icon",e.PrimeIcons.PENCIL),r(2),l("isVisibleCancelButton",!0),r(2),l("formInput",e.form.value)}}function Lr(t,a){if(t&1){let e=y();s(0,"p-toolbar")(1,"div",8),d(2,"app-header-form",9),m(),s(3,"div",10)(4,"app-form-button-action",19),b("submit",function(){let o=f(e).nextCallback,n=p(2);return h(n.onSubmitDocuments(o))}),m()()(),d(5,"p-divider"),s(6,"app-document",22),b("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))})("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.documentErrors=o)}),m()}if(t&2){let e=p(2);r(2),l("icon",e.PrimeIcons.PENCIL),r(2),l("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1),r(2),l("formInput",e.form.value)}}function Pr(t,a){if(t&1){let e=y();s(0,"p-toolbar")(1,"div",8),d(2,"app-header-form",9),m(),s(3,"div",10)(4,"app-form-button-action",23),b("submit",function(){f(e);let o=p(2);return h(o.finish())}),m()()(),d(5,"p-divider"),s(6,"app-addendum",22),b("formOutput",function(o){f(e);let n=p(2);return h(n.save(o))})("formErrorsOutput",function(o){f(e);let n=p(2);return h(n.documentErrors=o)}),m()}if(t&2){let e=p(2);r(2),l("icon",e.PrimeIcons.PENCIL),r(2),l("severitySubmitButton",e.SeverityButtonActionEnum.ADD)("isVisibleCancelButton",!1),r(2),l("formInput",e.form.value)}}function Mr(t,a){if(t&1&&(s(0,"p-stepper",0)(1,"p-stepperPanel",2),_(2,Br,20,10,"ng-template",3),m(),s(3,"p-stepperPanel",4),_(4,Nr,7,4,"ng-template",3),m(),s(5,"p-stepperPanel",5),_(6,kr,7,3,"ng-template",3),m(),s(7,"p-stepperPanel",6),_(8,Lr,7,4,"ng-template",3),m(),s(9,"p-stepperPanel",7),_(10,Pr,7,4,"ng-template",3),m()()),t&2){let e=p();l("linear",!0)("activeStep",e.activeStep)}}var Vi=(()=>{let a=class a{constructor(){this.authService=g(ce),this.agreementsService=g(Et),this.agreementsHttpService=g(ue),this.breadcrumbService=g(vt),this.confirmationService=g(Ne),this.formBuilder=g(V),this.messageDialogService=g(w),this.router=g(gt),this.SeverityButtonActionEnum=j,this.PrimeIcons=$,this.formErrors=[],this.basicDataErrors=[],this.agreementDateErrors=[],this.agreementAdministratorErrors=[],this.appearerErrors=[],this.obligationErrors=[],this.financingErrors=[],this.documentErrors=[],this.activeStep=0,this.breadcrumbService.setItems([{label:nt.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:nt.AGREEMENTS_REGISTER}]),this.buildForm()}ngOnInit(){this.agreementsService.agreementStorage&&(this.form.patchValue(this.agreementsService.agreementStorage),this.idField.value&&(this.activeStep=3),this.enablingDocumentsField.value.length==2&&this.enablingDocumentsField.value.every(i=>i.id)&&(this.activeStep=4))}buildForm(){this.form=this.formBuilder.group({id:[null],agreementState:[null],name:[null],internalNumber:[null],number:[null],origin:[null],type:[null],specialType:[null],internalInstitutions:[[]],externalInstitutions:[[]],subscribedAt:[new Date],startedAt:[new Date],isFinishDate:[!0],endedAt:[null],endedReason:[null],yearTerm:[null],monthTerm:[null],dayTerm:[null],objective:[null],administrator:[null],obligations:[[]],isFinancing:[!1],financings:[[]],isAddendum:[!1],addendums:[[]],enablingDocuments:[[]],enabled:[!1]})}get validateForms(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.agreementAdministratorErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors=this.formErrors.concat(this.financingErrors),this.formErrors.length===0}validateFormAgreement(i){this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.agreementAdministratorErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors.length===0?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}validateFormObligation(i){this.formErrors=[],this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors.length===0?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}get validateFormDocument(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.documentErrors),this.formErrors.length===0}onSubmitAgreement(i){this.validateForms?this.register(i):this.messageDialogService.fieldErrors(this.formErrors)}onSubmitDocuments(i){this.validateFormDocument?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}save(i){this.form.patchValue(i),this.agreementsService.agreement=this.form.value}register(i){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:$.TIMES_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.agreementsHttpService.register(this.agreementsService.agreement).subscribe(o=>{this.agreementsService.agreement=o,this.form.patchValue(o),i.emit()})}})}registerDocuments(i){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:$.TIMES_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{let o=new FormData;for(let n of this.enablingDocumentsField.value)o.append("typeIds",n.type.id),o.append("files",n.file);this.idField.valid&&this.agreementsHttpService.uploadEnablingDocuments(this.idField.value,o).subscribe(n=>{this.form.patchValue(n),this.agreementsService.agreement=n,i.emit()})}})}finish(){this.agreementsHttpService.finish(this.idField.value).subscribe(i=>{this.agreementsService.clearAgreement(),this.authService.role.code===de.NATIONAL_SUPERVISOR&&this.router.navigate(["/core/national-supervisor/agreement-list"]),this.authService.role.code===de.INTERNATIONAL_SUPERVISOR&&this.router.navigate(["/core/international-supervisor/agreement-list"])})}redirectAgreementList(){this.authService.role.code===de.NATIONAL_SUPERVISOR&&this.router.navigate(["/core/national-supervisor/agreement-list"]),this.authService.role.code===de.INTERNATIONAL_SUPERVISOR&&this.router.navigate(["/core/international-supervisor/agreement-list"])}get idField(){return this.form.controls.id}get enablingDocumentsField(){return this.form.controls.enablingDocuments}get enabledField(){return this.form.controls.enabled}};a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=A({type:a,selectors:[["app-register"]],decls:2,vars:1,consts:[["orientation","horizontal",3,"linear","activeStep"],["key","confirmDialog"],["header","Convenio"],["pTemplate","content"],["header","Obligaciones"],["header","Financiamiento"],["header","Documentos Habilitantes"],["header","Adendas"],[1,"p-toolbar-group-left"],["label","Registro",3,"icon"],[1,"p-toolbar-group-right"],["labelSubmitButton","Siguiente",3,"submit","cancel","iconSubmitButton","isVisibleCancelButton"],[1,"p-fluid","grid"],["header","Datos B\xE1sicos",1,"col-12"],[3,"formErrorsOutput","formOutput","formInput"],["header","Fechas del Convenio",1,"col-12"],["header","Administrador del Convenio",1,"col-12"],[1,"col-12",3,"formErrorsOutput","formOutput","formInput"],["header","Comparecientes",1,"col-12"],["labelSubmitButton","Siguiente",3,"submit","iconSubmitButton","isVisibleCancelButton"],["labelSubmitButton","Siguiente","labelCancelButton","Regresar",3,"submit","cancel","iconSubmitButton","isVisibleCancelButton"],["labelSubmitButton","Guardar","labelCancelButton","Regresar",3,"submit","cancel","isVisibleCancelButton"],[3,"formOutput","formErrorsOutput","formInput"],["labelSubmitButton","Finalizar",3,"submit","severitySubmitButton","isVisibleCancelButton"]],template:function(o,n){o&1&&(_(0,Mr,11,2,"p-stepper",0),d(1,"p-confirmDialog",1)),o&2&&I(0,n.form.value?0:-1)},dependencies:[ri,O,li,qe,se,Qt,ci,ui,oi,Ei,yi,Fi,xi,Si,Ai,Di,wi]});let t=a;return t})();var Rr=[{path:"",component:Vi,canActivate:[Ot],data:{roles:[de.NATIONAL_SUPERVISOR,de.INTERNATIONAL_SUPERVISOR]}}],Oi=(()=>{let a=class a{};a.\u0275fac=function(o){return new(o||a)},a.\u0275mod=Ie({type:a}),a.\u0275inj=Ce({imports:[et.forChild(Rr),et]});let t=a;return t})();var Bi=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=Ie({type:t});static \u0275inj=Ce({imports:[Be,tt,St,Me,Bt,Ht,Tt,tt]})}return t})();var bs=(()=>{let a=class a{};a.\u0275fac=function(o){return new(o||a)},a.\u0275mod=Ie({type:a}),a.\u0275inj=Ce({imports:[Be,Oi,wt,si,At,Rt,qt,Mt,Vt,Nt,Me,Ut,Jt,kt,mi,Kt,Zt,jt,hi,$t,_i,fi,Bi,Yt,Xt,di,Dt,zt,ni,ai,Wt,pi,ti,Pt,ii]});let t=a;return t})();export{bs as RegisterModule};
