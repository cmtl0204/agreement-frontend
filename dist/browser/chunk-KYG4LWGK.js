import{a as je}from"./chunk-ITLEPBVJ.js";import{b as Ve}from"./chunk-NWXNE4G5.js";import{b as se}from"./chunk-DPAPZDZU.js";import{a as Re}from"./chunk-YBZSCPYT.js";import{c as Pe,d as ze,f as He}from"./chunk-LD55VJOR.js";import{b as Fe}from"./chunk-ISADC5UE.js";import{c as ce,e as he}from"./chunk-EH24ARRV.js";import{A as pe,Aa as we,Fa as Be,Ha as Oe,Ka as Ne,Q as de,R as ue,Ua as ke,Xa as De,Z as ge,_ as ve,ba as _e,da as xe,ga as Ce,ha as ye,na as be,oa as Se,p as le,pa as Te,qa as Ee,ua as Ae,wa as Ie,x as ae,y as me,ya as Le}from"./chunk-JIMEKKLT.js";import{e as ne,j as oe,k as re,n as fe,r as Me}from"./chunk-CM3ZXFC4.js";import{J as M,K as h,L as I,M as L,N as J,O as y,P as X,R as Y,ca as b,k as W,ka as Z,o as A,oa as ee,p as U,r as $,s as G,u as Q,v as q,wa as te,x as K,ya as ie}from"./chunk-4W4WMVPF.js";import{Aa as k,Ba as D,Ca as s,E as u,H as p,J as S,K as g,La as r,Ma as x,Na as d,O,Oa as F,Ob as j,P as N,Rb as E,Wa as R,_ as m,eb as V,gb as P,ja as c,ka as T,la as f,qa as v,ua as o,va as n,vb as z,wa as _,yb as H,zb as C}from"./chunk-EUOB27Q6.js";var Ge=()=>({"min-width":"70rem"});function Qe(e,t){if(e&1&&_(0,"app-skeleton",0),e&2){let i=s();f("type",i.SkeletonEnum.CARD)}}function qe(e,t){if(e&1&&(o(0,"h3"),r(1),n()),e&2){let i=s(2);m(),x(i.AgreementLogEnum.header)}}function Ke(e,t){if(e&1&&(o(0,"p")(1,"b"),r(2,"Unidad Administradora:"),n(),r(3),n(),o(4,"p")(5,"b"),r(6,"Cargo Unidad Administradora:"),n(),r(7),n()),e&2){let i=s(4);m(3),d(" ",i.agreement.administrator.unit.name," "),m(4),d(" ",i.agreement.administrator.position.name," ")}}function Je(e,t){if(e&1&&(o(0,"p")(1,"b"),r(2,"N\xFAmero Interno Convenio:"),n(),r(3),n(),o(4,"p")(5,"b"),r(6,"Nombre del Convenio:"),n(),r(7),n(),c(8,Ke,8,2)),e&2){let i=s(3);m(3),d(" ",i.agreement.internalNumber,""),m(4),d(" ",i.agreement.name,""),m(),v(8,i.agreement.administrator?8:-1)}}function Xe(e,t){e&1&&(o(0,"tr")(1,"th"),r(2,"Campo"),n(),o(3,"th"),r(4,"Descripci\xF3n"),n(),o(5,"th"),r(6,"Texto Original"),n(),o(7,"th"),r(8,"Texto Actualizado"),n(),o(9,"th"),r(10,"Usuario Responsable"),n(),o(11,"th"),r(12,"Fecha y Hora"),n()())}function Ye(e,t){if(e&1&&(o(0,"td")(1,"span",10),r(2),n()()),e&2){let i=s(),a=i.$implicit,l=i.rowspan;T("rowspan",l),m(2),x(a.property)}}function Ze(e,t){if(e&1&&(o(0,"tr"),c(1,Ye,3,2,"td",8),o(2,"td"),r(3),n(),o(4,"td")(5,"span",9),r(6),n()(),o(7,"td"),r(8),n(),o(9,"td"),r(10),n(),o(11,"td"),r(12),V(13,"date"),n()()),e&2){let i=t.$implicit,a=t.rowgroup;m(),f("ngIf",a),m(2),d(" ",i.description," "),m(3),x(i.oldValue),m(2),d(" ",i.newValue," "),m(2),F(" ",i.agreementLog.user.name," ",i.agreementLog.user.lastname," "),m(2),d(" ",P(13,7,i.agreementLog.registeredAt,"dd/MM/yyyy HH:mm:ss")," ")}}function et(e,t){if(e&1&&(c(0,Je,9,3),o(1,"p-table",6),c(2,Xe,13,0,"ng-template",4)(3,Ze,14,10,"ng-template",7),n()),e&2){let i=s(2);v(0,i.agreement?0:-1),m(),f("value",i.items)("tableStyle",R(3,Ge))}}function tt(e,t){if(e&1){let i=k();o(0,"p-toolbar")(1,"div",1)(2,"p-button",2),D("click",function(){O(i);let l=s();return N(l.downloadLogsByAgreement())}),n()(),_(3,"div",3),n(),o(4,"p-panel"),c(5,qe,2,1,"ng-template",4)(6,et,4,4,"ng-template",5),n()}if(e&2){let i=s();m(2),f("icon",i.IconButtonActionEnum.DOWNLOAD)("label",i.LabelButtonActionEnum.DOWNLOAD)("loading",i.coreService.isLoading)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}var We=(()=>{let t=class t{constructor(){this.authService=p(ie),this.coreService=p($),this.agreementsHttpService=p(Z),this.agreementLogsHttpService=p(ee),this.agreementsService=p(K),this.router=p(j),this.breadcrumbService=p(Q),this.PrimeIcons=W,this.IconButtonActionEnum=L,this.SeverityButtonActionEnum=J,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=y,this.TableEnum=Y,this.messageService=p(G),this.messageDialogService=p(q),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new le(""),this.items=[],this.events=[],this.isVisibleAgreementView=!1,this.SkeletonEnum=X,this.AgreementLogEnum=b,this.breadcrumbService.setItems([{label:y.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:y.AGREEMENTS_LOG}]),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findAgreementLogsByAgreement()}findAgreementLogsByAgreement(){this.agreementLogsHttpService.findAgreementLogsByAgreement(this.id).subscribe(a=>{this.items=a,this.items.length>0&&(this.agreement=this.items[0].agreementLog?.agreement)})}buildColumns(){this.columns=[{field:"registeredAt",header:b.registeredAt},{field:"user",header:b.user}]}buildButtonActions(){this.buttonActions=[{id:h.VIEW,label:I.VIEW,icon:L.VIEW,command:()=>{this.redirectCreateForm()}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}validateButtonActions(a){this.buildButtonActions(),a.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===h.COMPLETE),1),a.enabled||(this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===h.VIEW),1),this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===h.EDIT),1))}selectItem(a){this.agreementsHttpService.findOne(a.id).subscribe(l=>{this.isButtonActions=!0,this.agreement=a,this.validateButtonActions(a),this.agreementsService.agreement=l})}downloadLogsByAgreement(){this.agreementLogsHttpService.downloadLogsByAgreement(this.id)}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=S({type:t,selectors:[["app-log"]],inputs:{id:"id"},decls:2,vars:2,consts:[[3,"type"],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["pTemplate","header"],["pTemplate","content"],["sortField","property","sortMode","single","dataKey","property","rowGroupMode","rowspan","groupRowsBy","property",3,"value","tableStyle"],["pTemplate","body"],[4,"ngIf"],[1,"ml-1","vertical-align-middle"],[1,"font-bold","ml-2"]],template:function(l,B){l&1&&c(0,Qe,1,1,"app-skeleton",0)(1,tt,7,4),l&2&&(v(0,B.coreService.isLoading?0:-1),m(),v(1,B.coreService.isLoading?-1:1))},dependencies:[z,Se,A,oe,de,Te,ye,H]});let e=t;return e})();var it=[{path:"",component:We,canActivate:[se],data:{roles:[M.NATIONAL_SUPERVISOR,M.INTERNATIONAL_SUPERVISOR]}}],Ue=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=g({type:t}),t.\u0275inj=u({imports:[E.forChild(it),E]});let e=t;return e})();var $e=(()=>{class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=g({type:e});static \u0275inj=u({imports:[C,U]})}return e})();var Mi=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=g({type:t}),t.\u0275inj=u({providers:[te],imports:[C,Ue,me,De,re,ve,he,fe,pe,ce,ne,ge,Me,ue,Fe,Ee,Le,xe,ze,_e,He,Pe,je,Ae,Ie,Ve,ae,be,Oe,Ne,Ce,ke,we,Re,Be,$e]});let e=t;return e})();export{Mi as LogModule};
