import{a as ye,b as Ge,c as ti}from"./chunk-LCCNJYYC.js";import{a as oi}from"./chunk-QOOKHVYU.js";import{a as Jt,b as Xt}from"./chunk-5KUFA5Z4.js";import{b as vt}from"./chunk-V6OR62GO.js";import{c as Ct}from"./chunk-GQKGDSZK.js";import{a as Yt}from"./chunk-E2S5RCOT.js";import{a as Qt,b as Zt,c as ei,d as ii,f as ni}from"./chunk-3AUXESBV.js";import{b as Kt}from"./chunk-ISADC5UE.js";import{c as Et,e as Tt}from"./chunk-FG5YJ6TI.js";import{A as P,B as q,Ea as Rt,Fa as he,Ga as Gt,Ha as Ht,Ia as $t,Ja as Ut,P as le,Q as Ft,Qa as jt,Ra as ue,Ta as Wt,Ua as Ie,Wa as zt,X as se,Y as It,_ as xt,aa as St,ba as At,ca as Pe,d as oe,da as Dt,ga as Vt,ha as me,i as z,ia as pe,k as f,m as R,n as L,na as wt,pa as Ot,q as M,qa as Nt,ra as qe,s as k,sa as Re,t as Me,ta as Bt,u as G,ua as Ce,v as V,va as Mt,w as ht,x as gt,xa as kt,y as ae,ya as Pt,z as bt,za as qt}from"./chunk-AJN2VZTT.js";import{e as ft,j as re,k as _t,m as ke,n as yt,r as Lt}from"./chunk-XHLRH3DP.js";import{A as S,D as mt,E as Ne,F as Xe,G as pt,H as ce,J as ee,K as te,L as U,M as Qe,N as j,P as ie,S as Be,T as ne,V as xe,W,X as Le,Y as Ze,Z as C,_ as et,aa as Te,ba as Se,ca as ut,da as fe,e as Oe,ea as dt,i as at,k as H,ka as ct,ma as _e,o as N,r as $,u as lt,v as D,w as Z,x as st,z as B}from"./chunk-EXGEWYYG.js";import{Aa as F,Ba as b,Ca as p,E as Ae,H as g,J as A,Ja as we,K as De,La as d,Ma as v,Na as T,O as _,Oa as nt,Ob as rt,P as h,Pa as Ye,Qa as Y,Ra as J,Rb as Je,Sa as X,U as x,Wa as Q,_ as o,c as it,ja as c,la as m,oa as K,pa as Ve,qa as I,ra as ge,sa as w,ta as O,ua as l,va as a,wa as u,zb as ot}from"./chunk-EUOB27Q6.js";function Ci(t,n){if(t&1&&(l(0,"div",12),u(1,"label",13)(2,"app-form-help-field",14)(3,"p-calendar",15)(4,"small",5),a(),l(5,"div",16),u(6,"label",17)(7,"app-form-help-field",18)(8,"input",19)(9,"small",5),a()),t&2){let e=p();o(),m("label",e.AgreementFormEnum.endedAt)("required",e.endedAtField),o(2),m("iconDisplay","input")("showIcon",!0)("minDate",e.startedAtField.value),o(),m("errors",e.endedAtField.errors)("touched",e.endedAtField.touched)("dirty",e.endedAtField.dirty),o(2),m("label",e.AgreementFormEnum.totalTerm)("required",e.totalTermField),o(3),m("errors",e.totalTermField.errors)("touched",e.totalTermField.touched)("dirty",e.totalTermField.dirty)}}function Ii(t,n){if(t&1&&(l(0,"div",11),u(1,"label",20),l(2,"textarea",21),d(3,"      "),a(),u(4,"small",5),a()),t&2){let e=p();o(),m("label",e.AgreementFormEnum.endedReason)("required",e.endedReasonField),o(3),m("errors",e.endedReasonField.errors)("touched",e.endedReasonField.touched)("dirty",e.endedReasonField.dirty)}}var li=(()=>{let n=class n{constructor(){this.coreService=g($),this.formBuilder=g(V),this.cataloguesHttpService=g(B),this.messageDialogService=g(D),this.formOutput=new x,this.formErrorsOutput=new x,this.nextOutput=new x,this.prevOutput=new x,this.formErrors=[],this.Validators=f,this.SkeletonEnum=j,this.AgreementFormEnum=C,this.buildForm()}ngOnInit(){this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({subscribedAt:[null,f.required],startedAt:[null,f.required],isFinishDate:[null,f.required],endedAt:[null],endedReason:[null],yearTerm:[null],monthTerm:[null],dayTerm:[null],totalTerm:[null]}),this.checkValueChanges()}patchValueForm(){let E=this.formInput,{endedAt:i,startedAt:s,subscribedAt:r}=E,y=it(E,["endedAt","startedAt","subscribedAt"]);this.form.patchValue(y),s&&this.startedAtField.setValue(Ge(s)),r&&this.subscribedAtField.setValue(Ge(r)),i&&this.endedAtField.setValue(Ge(i))}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()}),this.isFinishDateField.valueChanges.subscribe(i=>{i?(this.endedAtField.setValidators(f.required),this.totalTermField.setValidators(f.required),this.endedReasonField.clearValidators(),this.endedReasonField.reset()):i===!1&&(this.endedReasonField.setValidators(f.required),this.endedAtField.clearValidators(),this.totalTermField.clearValidators(),this.endedAtField.reset(),this.totalTermField.reset()),this.endedReasonField.updateValueAndValidity(),this.endedAtField.updateValueAndValidity(),this.yearTermField.updateValueAndValidity(),this.monthTermField.updateValueAndValidity(),this.dayTermField.updateValueAndValidity(),this.totalTermField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.subscribedAtField.invalid&&this.formErrors.push(C.subscribedAt),this.startedAtField.invalid&&this.formErrors.push(C.startedAt),this.isFinishDateField.invalid&&this.formErrors.push(C.isFinishDate),this.endedAtField.invalid&&this.formErrors.push(C.endedAt),this.endedReasonField.invalid&&this.formErrors.push(C.endedReason),this.yearTermField.invalid&&this.formErrors.push(C.yearTerm),this.monthTermField.invalid&&this.formErrors.push(C.monthTerm),this.dayTermField.invalid&&this.formErrors.push(C.dayTerm),this.totalTermField.invalid&&this.formErrors.push(C.totalTerm),this.formErrorsOutput.emit(this.formErrors)}get subscribedAtField(){return this.form.controls.subscribedAt}get startedAtField(){return this.form.controls.startedAt}get isFinishDateField(){return this.form.controls.isFinishDate}get endedAtField(){return this.form.controls.endedAt}get endedReasonField(){return this.form.controls.endedReason}get yearTermField(){return this.form.controls.yearTerm}get monthTermField(){return this.form.controls.monthTerm}get dayTermField(){return this.form.controls.dayTerm}get totalTermField(){return this.form.controls.totalTerm}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-agreement-date"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput",nextOutput:"nextOutput",prevOutput:"prevOutput"},decls:19,vars:23,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","subscribedAt",3,"label","required"],["content","Fecha que consta en convenio"],["id","subscribedAt","formControlName","subscribedAt","dateFormat","dd/mm/yy",3,"iconDisplay","showIcon"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","startedAt",3,"label","required"],["id","startedAt","formControlName","startedAt","dateFormat","dd/mm/yy",3,"iconDisplay","showIcon","minDate"],[1,"field","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","isFinishDate",3,"label","required"],["id","isFinishDate","formControlName","isFinishDate",1,"ml-2"],[1,"field","col-12"],[1,"field","col-12","xl:col-3","lg:col-3","md:col-3","sm:col-12"],["appLabel","","for","endedAt",3,"label","required"],["content","Registrar conforme se\xF1ala convenio"],["id","endedAt","formControlName","endedAt","dateFormat","dd/mm/yy",3,"iconDisplay","showIcon","minDate"],[1,"field","col-12","xl:col-9","lg:col-9","md:col-9","sm:col-12"],["appLabel","","for","totalTerm",3,"label","required"],["content","Plazo del convenio"],["pInputText","","id","totalTerm","formControlName","totalTerm"],["appLabel","","for","endedReason",3,"label","required"],["pInputTextarea","","id","endedReason","formControlName","endedReason","rows","5","cols","30",2,"resize","none"]],template:function(s,r){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"app-form-help-field",3)(4,"p-calendar",4)(5,"small",5),a(),l(6,"div",1),u(7,"label",6)(8,"p-calendar",7)(9,"small",5),a(),l(10,"div",8),u(11,"label",9)(12,"app-input-switch",10)(13,"small",5),a(),l(14,"div",11)(15,"label"),d(16,"Plazo total del convenio:"),a()(),c(17,Ci,10,13)(18,Ii,5,5,"div",11),a()),s&2&&(m("formGroup",r.form),o(2),m("label",r.AgreementFormEnum.subscribedAt)("required",r.subscribedAtField),o(2),m("iconDisplay","input")("showIcon",!0),o(),m("errors",r.subscribedAtField.errors)("touched",r.subscribedAtField.touched)("dirty",r.subscribedAtField.dirty),o(2),m("label",r.AgreementFormEnum.startedAt)("required",r.startedAtField),o(),m("iconDisplay","input")("showIcon",!0)("minDate",r.subscribedAtField.value),o(),m("errors",r.startedAtField.errors)("touched",r.startedAtField.touched)("dirty",r.startedAtField.dirty),o(2),m("label",r.AgreementFormEnum.isFinishDate)("required",r.isFinishDateField),o(2),m("errors",r.isFinishDateField.errors)("touched",r.isFinishDateField.touched)("dirty",r.isFinishDateField.dirty),o(4),I(17,r.isFinishDateField.value?17:-1),o(),I(18,r.isFinishDateField.value===!1?18:-1))},dependencies:[M,z,R,L,k,G,P,q,ue,Ie,ae,St,Ce]});let t=n;return t})();function Ti(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Si(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Ai(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Di(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Vi(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function wi(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Oi(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Ni(t,n){if(t&1&&(l(0,"div",28)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Bi(t,n){if(t&1&&(l(0,"div",24),u(1,"label",29),l(2,"p-dropdown",30),c(3,Oi,3,1,"ng-template",16)(4,Ni,3,1,"ng-template",17),a(),u(5,"small",5),a()),t&2){let e=p();o(),m("label",e.AgreementFormEnum.specialType)("required",e.specialTypeField),o(),m("options",e.specialTypes),o(3),m("errors",e.specialTypeField.errors)("touched",e.specialTypeField.touched)("dirty",e.specialTypeField.dirty)}}var si=(()=>{let n=class n{constructor(){this.authService=g(_e),this.agreementsHttpService=g(fe),this.cataloguesHttpService=g(B),this.coreService=g($),this.formBuilder=g(V),this.messageDialogService=g(D),this.Validators=f,this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.origins=[],this.specialTypes=[],this.states=[],this.types=[],this.AgreementFormEnum=C,this.AgreementStateEnum=et,this.SkeletonEnum=j,this.buildForm()}ngOnInit(){this.loadStates(),this.loadOrigins(),this.loadTypes(),this.loadSpecialTypes(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({agreementState:this.agreementStateForm,name:[null,[f.required]],internalNumber:[null,{validators:f.required,asyncValidators:Ct(this.agreementsHttpService),updateOn:"blur"}],number:[null,[f.required]],objective:[null,[f.required]],origin:[null,[f.required]],specialType:[null],type:[null,[f.required]]}),this.checkValueChanges()}patchValueForm(){this.form.patchValue(this.formInput)}get agreementStateForm(){return this.formBuilder.group({state:[null,f.required]})}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()}),this.typeField.valueChanges.subscribe(i=>{i&&i.code===mt.SPECIAL?this.specialTypeField.setValidators(f.required):this.specialTypeField.clearValidators(),this.specialTypeField.reset(),this.specialTypeField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.stateField.invalid&&this.formErrors.push(et.state),this.nameField.invalid&&this.formErrors.push(C.name),this.internalNumberField.invalid&&this.formErrors.push(C.internalNumber),this.internalNumberField.hasError("agreementExists")&&this.messageDialogService.errorCustom("Convenio ya existe","El n\xFAmero interno de convenio ya se encuentra registrado"),this.numberField.invalid&&this.formErrors.push(C.number),this.objectiveField.invalid&&this.formErrors.push(C.objective),this.originField.invalid&&this.formErrors.push(C.origin),this.typeField.invalid&&this.formErrors.push(C.type),this.specialTypeField.invalid&&this.formErrors.push(C.specialType),this.formErrorsOutput.emit(this.formErrors)}loadStates(){this.states=this.cataloguesHttpService.findByType(S.AGREEMENT_STATES_STATE),this.states=this.states.filter(i=>i.code===pt.CURRENT)}loadOrigins(){this.origins=this.cataloguesHttpService.findByType(S.AGREEMENTS_ORIGIN)}loadTypes(){this.types=this.cataloguesHttpService.findByType(S.AGREEMENTS_TYPE)}loadSpecialTypes(){this.specialTypes=this.cataloguesHttpService.findByType(S.AGREEMENTS_SPECIAL_TYPE)}get agreementStateFormField(){return this.form.controls.agreementState}get stateField(){return this.agreementStateFormField.controls.state}get nameField(){return this.form.controls.name}get internalNumberField(){return this.form.controls.internalNumber}get numberField(){return this.form.controls.number}get originField(){return this.form.controls.origin}get typeField(){return this.form.controls.type}get objectiveField(){return this.form.controls.objective}get specialTypeField(){return this.form.controls.specialType}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-basic-data"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:40,vars:41,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-3","lg:col-3","md:col-6","sm:col-12"],["appLabel","","for","internalNumber",3,"label","required"],["content","Colocar n\xFAmero asignado por la unidad de seguimiento"],["inputId","internalNumber","formControlName","internalNumber",3,"useGrouping"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","number",3,"label","required"],["content","Colocar numeraci\xF3n detallada en el convenio"],["pInputText","","id","number","formControlName","number"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","name",3,"label","required"],["content","Registrar textualmente el nombre del convenio - tipo oraci\xF3n"],["pInputText","","id","name","formControlName","name"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["appLabel","","for","origin",3,"label","required"],["id","origin","formControlName","origin","dataKey","id","placeholder","Selecione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["formGroupName","agreementState",1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["appLabel","","for","state",3,"label","required"],["content","Escoger opci\xF3n del estado actual del convenio"],["id","state","formControlName","state","dataKey","id","placeholder","Seleccione",3,"options"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","dataKey","id","placeholder","Selecione",3,"options"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12","xl:col-offset-8"],[1,"field","col-12"],["appLabel","","for","objective",3,"label","required"],["pInputTextarea","","id","objective","formControlName","objective","rows","6","cols","30"],[1,"flex","align-items-center","gap-2"],["appLabel","","for","specialType",3,"label","required"],["id","specialType","formControlName","specialType","dataKey","id","placeholder","Selecione",3,"options"]],template:function(s,r){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"app-form-help-field",3)(4,"p-inputNumber",4)(5,"small",5),a(),l(6,"div",1),u(7,"label",6)(8,"app-form-help-field",7)(9,"input",8)(10,"small",5),a(),l(11,"div",9),u(12,"label",10)(13,"app-form-help-field",11)(14,"input",12)(15,"small",5),a(),l(16,"div",13),u(17,"label",14),l(18,"p-dropdown",15),c(19,Ti,3,1,"ng-template",16)(20,Si,3,1,"ng-template",17),a(),u(21,"small",5),a(),l(22,"div",18),u(23,"label",19)(24,"app-form-help-field",20),l(25,"p-dropdown",21),c(26,Ai,3,1,"ng-template",16)(27,Di,3,1,"ng-template",17),a(),u(28,"small",5),a(),l(29,"div",13),u(30,"label",22),l(31,"p-dropdown",23),c(32,Vi,3,1,"ng-template",16)(33,wi,3,1,"ng-template",17),a(),u(34,"small",5),a(),c(35,Bi,6,6,"div",24),l(36,"div",25),u(37,"label",26)(38,"textarea",27)(39,"small",5),a()()),s&2&&(m("formGroup",r.form),o(2),m("label",r.AgreementFormEnum.internalNumber)("required",r.internalNumberField),o(2),m("useGrouping",!1),o(),m("errors",r.internalNumberField.errors)("touched",r.internalNumberField.touched)("dirty",r.internalNumberField.dirty),o(2),m("label",r.AgreementFormEnum.number)("required",r.numberField),o(3),m("errors",r.numberField.errors)("touched",r.numberField.touched)("dirty",r.numberField.dirty),o(2),m("label",r.AgreementFormEnum.name)("required",r.nameField),o(3),m("errors",r.nameField.errors)("touched",r.nameField.touched)("dirty",r.nameField.dirty),o(2),m("label",r.AgreementFormEnum.origin)("required",r.originField),o(),m("options",r.origins),o(3),m("errors",r.originField.errors)("touched",r.originField.touched)("dirty",r.originField.dirty),o(2),m("label",r.AgreementStateEnum.state)("required",r.stateField),o(2),m("options",r.states),o(3),m("errors",r.stateField.errors)("touched",r.stateField.touched)("dirty",r.stateField.dirty),o(2),m("label",r.AgreementFormEnum.type)("required",r.typeField),o(),m("options",r.types),o(3),m("errors",r.typeField.errors)("touched",r.typeField.touched)("dirty",r.typeField.dirty),o(),I(35,r.specialTypeField.hasValidator(r.Validators.required)?35:-1),o(2),m("label",r.AgreementFormEnum.objective)("required",r.objectiveField),o(2),m("errors",r.objectiveField.errors)("touched",r.objectiveField.touched)("dirty",r.objectiveField.dirty))},dependencies:[M,z,R,L,k,G,Me,P,q,N,ue,ae,se,Pe,Ce]});let t=n;return t})();var pi=(t,n)=>n.field,Mi=()=>({width:"50rem",height:"50rem"}),mi=()=>({width:"50rem"});function ki(t,n){if(t&1){let e=F();l(0,"h4"),d(1,"Ministerio de Turismo:"),a(),l(2,"p-button",14),b("click",function(){_(e);let s=p();return h(s.showInternalInstitutionModal())}),a()}if(t&2){let e=p();o(2),m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Pi(t,n){if(t&1&&(l(0,"th",17),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function qi(t,n){if(t&1&&(l(0,"tr"),w(1,Pi,2,2,"th",17,pi),a()),t&2){let e=p(3);o(),O(e.internalInstitutionsColumns)}}function Ri(t,n){if(t&1){let e=F();l(0,"ul")(1,"p-button",18),b("click",function(){let s=_(e).$index,r=p().rowIndex,y=p(3);return h(y.deleteInternalInstitutionDetail(r,s))}),a(),d(2),a()}if(t&2){let e=n.$implicit,i=p(4);o(),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip","Eliminar Cargo"),o(),T(" ",e.position.name," ")}}function Gi(t,n){if(t&1&&(l(0,"tr")(1,"td"),w(2,Ri,3,4,"ul",null,ge),a()()),t&2){let e=n.$implicit;o(2),O(e.internalInstitutionDetails)}}function Hi(t,n){if(t&1&&(l(0,"p-table",15),c(1,qi,3,0,"ng-template",0)(2,Gi,4,0,"ng-template",16),a()),t&2){let e=p(2);m("value",e.formInput.internalInstitutions)("columns",e.internalInstitutionsColumns)}}function $i(t,n){if(t&1&&c(0,Hi,3,2,"p-table",15),t&2){let e=p();I(0,e.formInput.internalInstitutions.length>0?0:-1)}}function Ui(t,n){if(t&1){let e=F();l(0,"h4"),d(1,"Contraparte:"),a(),l(2,"p-button",14),b("click",function(){_(e);let s=p();return h(s.showExternalInstitutionModal())}),a()}if(t&2){let e=p();o(2),m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function ji(t,n){if(t&1&&(l(0,"th",17),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function Wi(t,n){if(t&1&&(l(0,"tr")(1,"th"),d(2),a(),w(3,ji,2,2,"th",17,pi),a()),t&2){let e=n.$implicit,i=p(3);o(2),v(i.TableEnum.ACTIONS),o(),O(e)}}function zi(t,n){if(t&1){let e=F();l(0,"li",20)(1,"p-button",18),b("click",function(){let s=_(e).$index,r=p().rowIndex,y=p(3);return h(y.deleteExternalInstitutionDetail(r,s))}),a(),d(2),a()}if(t&2){let e=n.$implicit,i=p(4);o(),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip","Eliminar Cargo"),o(),nt(" ",e.position," / ",e.unit," ")}}function Ki(t,n){if(t&1){let e=F();l(0,"tr")(1,"td")(2,"p-button",19),b("click",function(){let s=_(e).rowIndex,r=p(3);return h(r.deleteExternalInstitution(s))}),a()(),l(3,"td"),d(4),a(),l(5,"td"),d(6),a(),l(7,"td")(8,"ul"),w(9,zi,3,5,"li",20,ge),a()()()}if(t&2){let e=n.$implicit,i=p(3);o(2),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip","Eliminar Compareciente"),o(2),v(e.personType.name),o(2),v(e.name),o(3),O(e.externalInstitutionDetails)}}function Yi(t,n){if(t&1&&(l(0,"p-table",15),c(1,Wi,5,1,"ng-template",0)(2,Ki,11,5,"ng-template",16),a()),t&2){let e=p(2);m("value",e.formInput.externalInstitutions)("columns",e.externalInstitutionsColumns)}}function Ji(t,n){if(t&1&&c(0,Yi,3,2,"p-table",15),t&2){let e=p();I(0,e.formInput.externalInstitutions.length>0?0:-1)}}function Xi(t,n){if(t&1&&(l(0,"div",21)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Qi(t,n){if(t&1&&(l(0,"div",21)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Zi(t,n){if(t&1){let e=F();l(0,"p-button",22),b("click",function(){_(e);let s=p();return h(s.isVisibleInternalInstitutionForm=!1)}),a(),l(1,"p-button",23),b("click",function(){_(e);let s=p();return h(s.addInternalInstitution())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function en(t,n){if(t&1&&(l(0,"div",21)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function tn(t,n){if(t&1&&(l(0,"div",21)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function nn(t,n){if(t&1&&(l(0,"form",3)(1,"div",4),u(2,"label",24)(3,"app-form-help-field",25)(4,"input",26)(5,"small",10),a(),l(6,"div",4),u(7,"label",27),l(8,"p-dropdown",28),c(9,en,3,1,"ng-template",8)(10,tn,3,1,"ng-template",9),a(),u(11,"small",10),a()(),l(12,"form",3)(13,"div",29),u(14,"label",30)(15,"input",31)(16,"small",10),a(),l(17,"div",29),u(18,"label",32)(19,"input",33)(20,"small",10),a()()),t&2){let e=p();m("formGroup",e.externalInstitutionForm),o(2),m("label",e.ExternalInstitutionsFormEnum.name)("required",e.externalInstitutionNameField),o(3),m("errors",e.externalInstitutionNameField.errors)("touched",e.externalInstitutionNameField.touched)("dirty",e.externalInstitutionNameField.dirty),o(2),m("label",e.ExternalInstitutionsFormEnum.personType)("required",e.externalInstitutionPersonTypeField),o(),m("options",e.externalPersonTypes),o(3),m("errors",e.externalInstitutionPersonTypeField.errors)("touched",e.externalInstitutionPersonTypeField.touched)("dirty",e.externalInstitutionPersonTypeField.dirty),o(),m("formGroup",e.externalInstitutionDetailForm),o(2),m("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),o(2),m("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),o(2),m("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),o(2),m("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function on(t,n){if(t&1){let e=F();l(0,"p-button",22),b("click",function(){_(e);let s=p();return h(s.isVisibleExternalInstitutionForm=!1)}),a(),l(1,"p-button",23),b("click",function(){_(e);let s=p();return h(s.addExternalInstitution())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function rn(t,n){if(t&1&&(l(0,"form",3)(1,"div",4),u(2,"label",34)(3,"input",35)(4,"small",10),a(),l(5,"div",4),u(6,"label",36)(7,"input",37)(8,"small",10),a()()),t&2){let e=p();m("formGroup",e.externalInstitutionDetailForm),o(2),m("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),o(2),m("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),o(2),m("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),o(2),m("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function an(t,n){if(t&1){let e=F();l(0,"p-button",22),b("click",function(){_(e);let s=p();return h(s.isVisibleExternalInstitutionDetailForm=!1)}),a(),l(1,"p-button",38),b("click",function(){_(e);let s=p();return h(s.addExternalInstitutionDetail())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var ui=(()=>{let n=class n{constructor(){this.authService=g(_e),this.cataloguesHttpService=g(B),this.coreService=g($),this.formBuilder=g(V),this.messageDialogService=g(D),this.formInput=Z(),this.formOutput=new x,this.formErrorsOutput=new x,this.externalInstitutionsColumns=[],this.internalInstitutionsColumns=[],this.formErrors=[],this.isVisibleExternalInstitutionDetailForm=!1,this.isVisibleInternalInstitutionForm=!1,this.isVisibleExternalInstitutionForm=!1,this.index=-1,this.internalPersonTypes=[],this.externalPersonTypes=[],this.positions=[],this.ExternalInstitutionsFormEnum=W,this.InternalInstitutionsFormEnum=xe,this.SkeletonEnum=j,this.PrimeIcons=H,this.SeverityButtonActionEnum=U,this.LabelButtonActionEnum=ee,this.IconButtonActionEnum=te,this.AgreementFormEnum=C,this.TableEnum=ie,this.buildForm(),this.buildExternalInstitutionForm(),this.buildInternalInstitutionForm(),this.buildExternalInstitutionDetailForm(),this.buildInternalInstitutionDetailForm(),this.buildExternalInstitutionsColumns(),this.buildInternalInstitutionsColumns(),this.checkValueChanges()}ngOnInit(){this.loadInternalPersonTypes(),this.loadExternalPersonTypes(),this.loadPositions(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({internalInstitutions:this.formBuilder.array([],f.required),externalInstitutions:this.formBuilder.array([],f.required)})}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()})}validateForm(){this.formErrors=[],this.formInput.internalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Mintur"),this.formInput.externalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Contraparte"),this.formErrorsOutput.emit(this.formErrors)}buildInternalInstitutionForm(){this.internalInstitutionForm=this.formBuilder.group({name:["Ministerio de Turismo"],personType:[null,[f.required]]})}buildInternalInstitutionDetailForm(){this.internalInstitutionDetailForm=this.formBuilder.group({position:[null,[f.required]],unit:[null]})}buildExternalInstitutionForm(){this.externalInstitutionForm=this.formBuilder.group({personType:[null,[f.required]],name:[null,[f.required,f.pattern(ye())]]})}buildExternalInstitutionDetailForm(){this.externalInstitutionDetailForm=this.formBuilder.group({position:[null,[f.required]],unit:[null,[f.required,f.pattern(ye())]]})}buildInternalInstitutionsColumns(){this.internalInstitutionsColumns=[{field:"position",header:xe.position}]}buildExternalInstitutionsColumns(){this.externalInstitutionsColumns=[{field:"personType",header:W.personType},{field:"name",header:W.name},{field:"position",header:`${W.unit} / ${W.position}`}]}addInternalInstitution(){this.internalInstitutionPersonTypeField.patchValue(this.internalPersonTypes.find(i=>i.code===Xe.PUBLIC)),this.internalInstitutionNameField.patchValue("Ministerio de Turismo"),this.validateInternalInstitutionForm()&&this.validateInternalInstitutionDetailForm()?(this.formInput.internalInstitutions.length===0&&this.formInput.internalInstitutions.push(this.internalInstitutionForm.value),this.index=0,this.form.patchValue(this.formInput),this.addInternalInstitutionDetail(),this.internalInstitutionForm.reset(),this.isVisibleInternalInstitutionForm=!1):(this.internalInstitutionForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addInternalInstitutionDetail(){this.validateInternalInstitutionDetailForm()?(this.formInput?.internalInstitutions&&(this.formInput?.internalInstitutions[this.index].internalInstitutionDetails?this.formInput.internalInstitutions[this.index].internalInstitutionDetails.push(this.internalInstitutionDetailForm.value):this.formInput.internalInstitutions[this.index].internalInstitutionDetails=[this.internalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.internalInstitutionDetailPositionField.reset()):(this.internalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitution(){this.validateExternalInstitutionForm()&&this.validateExternalInstitutionDetailForm()?(this.formInput.externalInstitutions.length===0?(this.formInput.externalInstitutions.push(this.externalInstitutionForm.value),this.index=0):(this.index=this.formInput.externalInstitutions.findIndex(i=>i.name.toLowerCase()===this.externalInstitutionNameField.value.toLowerCase()),this.index===-1&&(this.formInput.externalInstitutions.push(this.externalInstitutionForm.value),this.index=this.formInput.externalInstitutions.length-1)),this.form.patchValue(this.formInput),this.addExternalInstitutionDetail(),this.externalInstitutionForm.reset(),this.isVisibleExternalInstitutionForm=!1):(this.externalInstitutionForm.markAllAsTouched(),this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitutionDetail(){this.validateExternalInstitutionDetailForm()?(this.formInput?.externalInstitutions&&(this.formInput?.externalInstitutions[this.index].externalInstitutionDetails?this.formInput.externalInstitutions[this.index].externalInstitutionDetails.push(this.externalInstitutionDetailForm.value):this.formInput.externalInstitutions[this.index].externalInstitutionDetails=[this.externalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.isVisibleExternalInstitutionDetailForm=!1,this.externalInstitutionDetailForm.reset()):(this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}showExternalInstitutionModal(){this.isVisibleExternalInstitutionForm=!0}showExternalInstitutionDetailModal(i){this.isVisibleExternalInstitutionDetailForm=!0,this.index=i}deleteExternalInstitution(i){if(this.formInput.obligations.some(s=>s.institutionName===this.formInput.externalInstitutions[i].name)){this.messageDialogService.errorCustom("Existe obligaciones asignadas","Por favor elimine primero las obligaciones");return}if(this.formInput.financings.some(s=>s.institutionName===this.formInput.externalInstitutions[i].name)){this.messageDialogService.errorCustom("Existe financiamientos asignados","Por favor elimine primero los financiamientos");return}this.formInput.externalInstitutions.splice(i,1),this.form.patchValue(this.formInput)}deleteInternalInstitutionDetail(i,s){this.formInput.internalInstitutions[i].internalInstitutionDetails.splice(s,1),this.formInput.internalInstitutions[i].internalInstitutionDetails.length===0&&this.formInput.internalInstitutions.splice(i,1)}deleteInternalInstitution(i){this.formInput.internalInstitutions.splice(i,1),this.form.patchValue(this.formInput)}deleteExternalInstitutionDetail(i,s){this.formInput.externalInstitutions[i].externalInstitutionDetails.splice(s,1),this.formInput.externalInstitutions[i].externalInstitutionDetails.length===0&&this.formInput.externalInstitutions.splice(i,1)}validateExternalInstitutionForm(){return this.formErrors=[],this.externalInstitutionNameField.invalid&&this.formErrors.push(W.name),this.externalInstitutionPersonTypeField.invalid&&this.formErrors.push(W.personType),this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(W.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(W.position),this.formErrors.length===0}validateExternalInstitutionDetailForm(){return this.formErrors=[],this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(W.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(W.position),this.formErrors.length===0}validateInternalInstitutionForm(){return this.formErrors=[],this.internalInstitutionPersonTypeField.invalid&&this.formErrors.push(xe.personType),this.formErrors.length===0}validateInternalInstitutionDetailForm(){return this.formErrors=[],this.internalInstitutionDetailPositionField.invalid&&this.formErrors.push(xe.position),this.internalInstitutionDetailForm.valid&&this.formErrors.length===0}loadInternalPersonTypes(){this.internalPersonTypes=this.cataloguesHttpService.findByType(S.INTERNAL_INSTITUTIONS_PERSON_TYPE),this.internalInstitutionPersonTypeField.patchValue(this.internalPersonTypes.find(i=>i.code===Xe.PUBLIC))}loadExternalPersonTypes(){this.externalPersonTypes=this.cataloguesHttpService.findByType(S.EXTERNAL_INSTITUTIONS_PERSON_TYPE)}loadPositions(){this.positions=this.cataloguesHttpService.findByType(S.INTERNAL_INSTITUTIONS_POSITION)}save(){this.formOutput.emit(this.form.value)}showInternalInstitutionModal(){this.isVisibleInternalInstitutionForm=!0}get internalInstitutionsField(){return this.form.get("internalInstitutions")}get externalInstitutionsField(){return this.form.get("externalInstitutions")}get internalInstitutionNameField(){return this.internalInstitutionForm.controls.name}get internalInstitutionPersonTypeField(){return this.internalInstitutionForm.controls.personType}get internalInstitutionDetailPositionField(){return this.internalInstitutionDetailForm.controls.position}get externalInstitutionNameField(){return this.externalInstitutionForm.controls.name}get externalInstitutionPersonTypeField(){return this.externalInstitutionForm.controls.personType}get externalInstitutionDetailUnitField(){return this.externalInstitutionDetailForm.controls.unit}get externalInstitutionDetailPositionField(){return this.externalInstitutionDetailForm.controls.position}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-appearer"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:22,vars:23,consts:[["pTemplate","header"],["pTemplate","content"],["header","Agregar",3,"visibleChange","visible","modal","maximizable"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","internalPosition",3,"label","required"],["content","Registrar conforme se detalla en el convenio"],["id","internalPosition","formControlName","position","dataKey","id","placeholder","Selecione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],["pTemplate","footer"],["header","Agregar",3,"visibleChange","visible","modal"],["header","Contraparte",3,"visibleChange","visible","modal"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"ml-1",3,"click","icon","severity","pTooltip"],[3,"click","icon","severity","pTooltip"],[1,"mt-1"],[1,"flex","align-items-center","gap-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","severity","label"],["appLabel","","for","name",3,"label","required"],["content","Registro texto tipo oraci\xF3n."],["pInputText","","id","name","formControlName","name"],["appLabel","","for","externalPersonType",3,"label","required"],["id","externalPersonType","formControlName","personType","dataKey","id","placeholder","Selecione",3,"options"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","externalPosition2",3,"label","required"],["pInputText","","id","externalPosition2","formControlName","position"],["appLabel","","for","unit2",3,"label","required"],["pInputText","","id","unit2","formControlName","unit"],["appLabel","","for","externalPosition1",3,"label","required"],["pInputText","","id","externalPosition1","formControlName","position"],["appLabel","","for","unit1",3,"label","required"],["pInputText","","id","unit1","formControlName","unit"],[3,"click","label","icon","severity"]],template:function(s,r){s&1&&(l(0,"p-panel"),c(1,ki,3,3,"ng-template",0)(2,$i,1,1,"ng-template",1),a(),l(3,"p-panel"),c(4,Ui,3,3,"ng-template",0)(5,Ji,1,1,"ng-template",1),a(),l(6,"p-dialog",2),X("visibleChange",function(E){return J(r.isVisibleInternalInstitutionForm,E)||(r.isVisibleInternalInstitutionForm=E),E}),l(7,"form",3)(8,"div",4),u(9,"label",5)(10,"app-form-help-field",6),l(11,"p-dropdown",7),c(12,Xi,3,1,"ng-template",8)(13,Qi,3,1,"ng-template",9),a(),u(14,"small",10),a()(),c(15,Zi,2,7,"ng-template",11),a(),l(16,"p-dialog",12),X("visibleChange",function(E){return J(r.isVisibleExternalInstitutionForm,E)||(r.isVisibleExternalInstitutionForm=E),E}),c(17,nn,21,23,"ng-template",1)(18,on,2,7,"ng-template",11),a(),l(19,"p-dialog",13),X("visibleChange",function(E){return J(r.isVisibleExternalInstitutionDetailForm,E)||(r.isVisibleExternalInstitutionDetailForm=E),E}),c(20,rn,9,11,"ng-template",1)(21,an,2,7,"ng-template",11),a()),s&2&&(o(6),K(Q(20,Mi)),Y("visible",r.isVisibleInternalInstitutionForm),m("modal",!0)("maximizable",!0),o(),m("formGroup",r.internalInstitutionDetailForm),o(2),m("label",r.InternalInstitutionsFormEnum.position)("required",r.internalInstitutionDetailPositionField),o(2),m("options",r.positions),o(3),m("errors",r.internalInstitutionDetailPositionField.errors)("touched",r.internalInstitutionDetailPositionField.touched)("dirty",r.internalInstitutionDetailPositionField.dirty),o(2),K(Q(21,mi)),Y("visible",r.isVisibleExternalInstitutionForm),m("modal",!0),o(3),K(Q(22,mi)),Y("visible",r.isVisibleExternalInstitutionDetailForm),m("modal",!0))},dependencies:[M,z,R,L,k,G,P,q,oe,N,ue,re,ae,se,le,me,pe,he],styles:[".button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem}"]});let t=n;return t})();function sn(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function mn(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function pn(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function un(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function dn(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),Ye("",e.name," ",e.lastname," (",e.email,")")}}function cn(t,n){if(t&1&&(l(0,"div",14)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),Ye("",e.name," ",e.lastname," (",e.email,")")}}var di=(()=>{let n=class n{constructor(){this.coreService=g($),this.cataloguesHttpService=g(B),this.formBuilder=g(V),this.messageDialogService=g(D),this.usersHttpService=g(ti),this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.Validators=f,this.units=[],this.positions=[],this.users=[],this.SkeletonEnum=j,this.AgreementFormEnum=C,this.AdministratorFormEnum=Te,this.buildForm()}ngOnInit(){this.loadPositions(),this.loadUnits(),this.loadUsers(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({administrator:this.administratorForm}),this.checkValueChanges()}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(i),this.validateForm()})}get administratorForm(){return this.formBuilder.group({unit:[null,f.required],position:[null,f.required],user:[null,f.required]})}validateForm(){this.formErrors=[],this.unitField.invalid&&this.formErrors.push(Te.unit),this.positionField.invalid&&this.formErrors.push(Te.position),this.userField.invalid&&this.formErrors.push(Te.user),this.formErrorsOutput.emit(this.formErrors)}loadPositions(){this.positions=this.cataloguesHttpService.findByType(S.ADMINISTRATORS_POSITION)}loadUnits(){this.units=this.cataloguesHttpService.findByType(S.ADMINISTRATORS_UNIT)}loadUsers(){this.usersHttpService.findAllUsersLDAP().subscribe(i=>{this.users=i})}get administratorFormField(){return this.form.controls.administrator}get unitField(){return this.administratorFormField.controls.unit}get positionField(){return this.administratorFormField.controls.position}get userField(){return this.administratorFormField.controls.user}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-agreement-administrator"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:21,vars:22,consts:[[1,"p-fluid","grid",3,"formGroup"],["formGroupName","administrator",1,"col-12"],[1,"grid"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","unit",3,"label","required"],["id","unit","formControlName","unit","dataKey","id","placeholder","Seleccione","filterBy","name",3,"options","filter"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","position",3,"label","required"],["id","position","formControlName","position","dataKey","id","filterBy","name","placeholder","Seleccione",3,"options","filter"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","user",3,"label","required"],["id","user","formControlName","user","dataKey","email","placeholder","Seleccione","filterBy","email,lastname,name",3,"options","filter"],[1,"flex","align-items-center","gap-2"]],template:function(s,r){s&1&&(l(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),u(4,"label",4),l(5,"p-dropdown",5),c(6,sn,3,1,"ng-template",6)(7,mn,3,1,"ng-template",7),a(),u(8,"small",8),a(),l(9,"div",3),u(10,"label",9),l(11,"p-dropdown",10),c(12,pn,3,1,"ng-template",6)(13,un,3,1,"ng-template",7),a(),u(14,"small",8),a(),l(15,"div",11),u(16,"label",12),l(17,"p-dropdown",13),c(18,dn,3,3,"ng-template",6)(19,cn,3,3,"ng-template",7),a(),u(20,"small",8),a()()()()),s&2&&(m("formGroup",r.form),o(4),m("label",r.AdministratorFormEnum.unit)("required",r.unitField),o(),m("options",r.units)("filter",!0),o(3),m("errors",r.unitField.errors)("touched",r.unitField.touched)("dirty",r.unitField.dirty),o(2),m("label",r.AdministratorFormEnum.position)("required",r.positionField),o(),m("options",r.positions)("filter",!0),o(3),m("errors",r.positionField.errors)("touched",r.positionField.touched)("dirty",r.positionField.dirty),o(2),m("label",r.AdministratorFormEnum.user)("required",r.userField),o(),m("options",r.users)("filter",!0),o(3),m("errors",r.userField.errors)("touched",r.userField.touched)("dirty",r.userField.dirty))},dependencies:[M,R,L,k,G,Me,P,q,N,se]});let t=n;return t})();var _n=(t,n)=>n.field,hn=()=>({width:"50rem",height:"50rem"}),gn=()=>({width:"50rem"});function bn(t,n){if(t&1){let e=F();l(0,"h4"),d(1),a(),l(2,"p-button",4),b("click",function(){_(e);let s=p();return h(s.showObligationModal())}),a()}if(t&2){let e=p();o(),T("",e.ObligationForEnum.header,":"),o(),m("icon",e.IconButtonActionEnum.ADD)("pTooltip","1. Agregar tipo de obligaciones")("severity",e.SeverityButtonActionEnum.ADD)}}function vn(t,n){if(t&1&&(l(0,"th",7),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function En(t,n){if(t&1&&(l(0,"tr")(1,"th"),d(2),a(),w(3,vn,2,2,"th",7,_n),l(5,"th"),d(6),a()()),t&2){let e=n.$implicit,i=p(3);o(2),T(" ",i.TableEnum.ACTIONS," "),o(),O(e),o(3),T(" ",i.TableEnum.ACTIONS," ")}}function Fn(t,n){if(t&1){let e=F();l(0,"li",9)(1,"p-button",11),b("click",function(){let s=_(e).$index,r=p().rowIndex,y=p(3);return h(y.deleteObligationDetail(r,s))}),a(),d(2),a()}if(t&2){let e=n.$implicit,i=p(4);o(),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),o(),T(" ",e.description," ")}}function Cn(t,n){if(t&1){let e=F();l(0,"tr")(1,"td")(2,"p-button",8),b("click",function(){let s=_(e).rowIndex,r=p(3);return h(r.deleteObligation(s))}),a()(),l(3,"td"),d(4),a(),l(5,"td"),d(6),a(),l(7,"td")(8,"ul"),w(9,Fn,3,4,"li",9,ge),a()(),l(11,"td")(12,"div",10)(13,"p-button",8),b("click",function(){let s=_(e).rowIndex,r=p(3);return h(r.showObligationDetailModal(s))}),a()()()()}if(t&2){let e=n.$implicit,i=p(3);o(2),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE),o(2),v(e.institutionName),o(2),v(e.type==null?null:e.type.name),o(3),O(e.obligationDetails),o(4),m("icon",i.IconButtonActionEnum.ADD)("severity",i.SeverityButtonActionEnum.ADD)("pTooltip","2. Agregar obligaciones")}}function In(t,n){if(t&1&&(l(0,"p-table",5),c(1,En,7,2,"ng-template",0)(2,Cn,14,8,"ng-template",6),a()),t&2){let e=p(2);m("value",e.formInput.obligations)("columns",e.columns)}}function yn(t,n){if(t&1&&c(0,In,3,2,"p-table",5),t&2){let e=p();I(0,e.formInput.obligations.length>0?0:-1)}}function xn(t,n){if(t&1&&(l(0,"div",22)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Tn(t,n){if(t&1&&(l(0,"div",22)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Sn(t,n){if(t&1&&(l(0,"div",22)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function An(t,n){if(t&1&&(l(0,"div",22)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e.name)}}function Dn(t,n){if(t&1&&(l(0,"p-dropdown",24),c(1,Sn,3,1,"ng-template",16)(2,An,3,1,"ng-template",17),a()),t&2){let e=p(3);m("options",e.formInput.externalInstitutions)}}function Vn(t,n){if(t&1&&u(0,"p-multiSelect",25),t&2){let e=p(3);m("options",e.institutions)}}function wn(t,n){if(t&1&&(l(0,"div",13),u(1,"label",23),c(2,Dn,3,1,"p-dropdown",24)(3,Vn,1,1,"p-multiSelect",25),u(4,"small",18),a()),t&2){let e=p(2);o(),m("label",e.ObligationForEnum.institutionName)("required",e.obligationInstitutionNameField),o(),I(2,e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.EXTERNAL?2:-1),o(),I(3,e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.JOIN?3:-1),o(),m("errors",e.obligationInstitutionNameField.errors)("touched",e.obligationInstitutionNameField.touched)("dirty",e.obligationInstitutionNameField.dirty)}}function On(t,n){if(t&1&&(l(0,"form",12)(1,"div",13),u(2,"label",14),l(3,"p-dropdown",15),c(4,xn,3,1,"ng-template",16)(5,Tn,3,1,"ng-template",17),a(),u(6,"small",18),a(),c(7,wn,5,7,"div",13),l(8,"div",13)(9,"form",19),u(10,"label",20)(11,"textarea",21)(12,"small",18),a()()()),t&2){let e=p();m("formGroup",e.obligationForm),o(2),m("label",e.ObligationForEnum.type)("required",e.obligationTypeField),o(),m("options",e.obligationTypes),o(3),m("errors",e.obligationTypeField.errors)("touched",e.obligationTypeField.touched)("dirty",e.obligationTypeField.dirty),o(),I(7,e.obligationTypeField.value&&(e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.EXTERNAL||e.obligationTypeField.value.code===e.CatalogueObligationsTypeEnum.JOIN)?7:-1),o(2),m("formGroup",e.obligationDetailForm),o(),m("label",e.ObligationDetailForEnum.description)("required",e.obligationDetailDescriptionField),o(2),m("errors",e.obligationDetailDescriptionField.errors)("touched",e.obligationDetailDescriptionField.touched)("dirty",e.obligationDetailDescriptionField.dirty)}}function Nn(t,n){if(t&1){let e=F();l(0,"p-button",26),b("click",function(){_(e);let s=p();return h(s.isVisibleObligationForm=!1)}),a(),l(1,"p-button",27),b("click",function(){_(e);let s=p();return h(s.addObligation())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Bn(t,n){if(t&1&&(l(0,"form",12)(1,"div",13),u(2,"label",28)(3,"textarea",29)(4,"small",18),a()()),t&2){let e=p();m("formGroup",e.obligationDetailForm),o(2),m("label",e.ObligationDetailForEnum.description)("required",e.obligationDetailDescriptionField),o(2),m("errors",e.obligationDetailDescriptionField.errors)("touched",e.obligationDetailDescriptionField.touched)("dirty",e.obligationDetailDescriptionField.dirty)}}function Ln(t,n){if(t&1){let e=F();l(0,"p-button",26),b("click",function(){_(e);let s=p();return h(s.isVisibleObligationDetailForm=!1)}),a(),l(1,"p-button",27),b("click",function(){_(e);let s=p();return h(s.addObligationDetail())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var ci=(()=>{let n=class n{constructor(){this.formBuilder=g(V),this.messageDialogService=g(D),this.formInput=Z(),this.formOutput=new x,this.formErrorsOutput=new x,this.cataloguesHttpService=g(B),this.coreService=g($),this.obligationTypes=[],this.institutions=[],this.SkeletonEnum=j,this.SeverityButtonActionEnum=U,this.PrimeIcons=H,this.formErrors=[],this.IconButtonActionEnum=te,this.LabelButtonActionEnum=ee,this.CatalogueObligationsTypeEnum=Ne,this.TableEnum=ie,this.isVisibleObligationForm=!1,this.isVisibleObligationDetailForm=!1,this.ObligationForEnum=Le,this.ObligationDetailForEnum=Ze,this.columns=[],this.index=-1,this.buildForm(),this.buildObligationForm(),this.buildObligationDetailForm(),this.buildColumns(),this.checkValueChanges()}ngOnInit(){this.loadObligationTypes(),this.loadInstitutions(),this.patchValueForm(),this.validateForm()}buildColumns(){this.columns=[{field:"type",header:Le.type},{field:"institutionName",header:Le.institutionResponsible},{field:"obligations",header:Ze.description}]}buildForm(){this.form=this.formBuilder.group({obligations:this.formBuilder.array([],f.required)})}buildObligationForm(){this.obligationForm=this.formBuilder.group({institutionName:[null,[f.required]],type:[null,[f.required]]})}buildObligationDetailForm(){this.obligationDetailForm=this.formBuilder.group({description:[null,[f.required]]})}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.obligationTypeField.valueChanges.subscribe(i=>{this.obligationInstitutionNameField.reset(),i&&i.code===Ne.INTERNAL&&this.formInput.internalInstitutions&&this.obligationInstitutionNameField.setValue(this.formInput.internalInstitutions[0].name)})}validateForm(){this.formErrors=[],this.formInput.obligations?.length===0&&this.formErrors.push("Obligaciones"),this.formErrorsOutput.emit(this.formErrors)}validateObligationForm(){return this.formErrors=[],this.obligationTypeField.invalid&&this.formErrors.push(this.ObligationForEnum.type),this.obligationInstitutionNameField.invalid&&this.formErrors.push(this.ObligationForEnum.institutionName),this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}validateObligationDetailForm(){return this.formErrors=[],this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}loadObligationTypes(){this.obligationTypes=this.cataloguesHttpService.findByType(S.OBLIGATIONS_TYPE)}loadInstitutions(){this.institutions=[];let i=[],s=[];this.formInput.internalInstitutions&&(i=this.formInput.internalInstitutions.map(r=>r.name)),this.formInput.externalInstitutions&&(s=this.formInput.externalInstitutions.map(r=>r.name)),this.institutions=i.concat(s)}addObligation(){if(this.validateObligationForm()){let i=this.obligationForm.value;if(Array.isArray(i.institutionName)&&i.institutionName.sort(),i.institutionName=i.institutionName.toString(),i.institutionName=i.institutionName.replace(",",", "),i.obligationDetails=[this.obligationDetailForm.value],this.obligationTypeField.value.code===Ne.JOIN&&this.obligationInstitutionNameField.value.length<2){this.messageDialogService.errorCustom("M\xEDnimo requerido","Debe seleccionar al menos 2 (dos) Instituciones");return}if(this.formInput.obligations.findIndex(s=>s.institutionName===i.institutionName)>-1){this.messageDialogService.errorCustom("Duplicado","La Instituci\xF3n ya est\xE1 registrada, intente con otra por favor");return}this.formInput.obligations.push(i),this.form.patchValue(this.formInput),this.obligationForm.reset(),this.obligationDetailForm.reset(),this.isVisibleObligationForm=!1}else this.obligationForm.markAllAsTouched(),this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}addObligationDetail(){this.validateObligationDetailForm()?(this.formInput.obligations&&(this.formInput.obligations[this.index].obligationDetails?this.formInput.obligations[this.index].obligationDetails?.push(this.obligationDetailForm.value):this.formInput.obligations[this.index].obligationDetails=[this.obligationDetailForm.value]),this.form.patchValue(this.formInput),this.obligationDetailForm.reset(),this.isVisibleObligationDetailForm=!1):(this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}deleteObligation(i){this.formInput.obligations?.splice(i,1),this.form.patchValue(this.formInput)}deleteObligationDetail(i,s){this.formInput.obligations[i].obligationDetails?.splice(s,1),this.formInput.obligations[i].obligationDetails.length===0&&this.formInput.obligations.splice(i,1),this.form.patchValue(this.formInput)}showObligationModal(){this.isVisibleObligationForm=!0}showObligationDetailModal(i){this.isVisibleObligationDetailForm=!0,this.index=i}get obligationInstitutionNameField(){return this.obligationForm.controls.institutionName}get obligationTypeField(){return this.obligationForm.controls.type}get obligationDetailDescriptionField(){return this.obligationDetailForm.controls.description}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-obligation"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:9,vars:10,consts:[["pTemplate","header"],["pTemplate","content"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","footer"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","severity","pTooltip"],[1,"mt-1"],[1,"button-group"],["size","small",3,"click","icon","severity","pTooltip"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","dataKey","id","placeholder","Seleccione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],[3,"formGroup"],["appLabel","","for","description",3,"label","required"],["pInputTextarea","","id","description","formControlName","description"],[1,"flex","align-items-center","gap-2"],["appLabel","","for","institutionName",3,"label","required"],["id","institutionName","formControlName","institutionName","optionValue","name","placeholder","Seleccione",3,"options"],["formControlName","institutionName","placeholder","Seleccione",3,"options"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"],["appLabel","","for","descriptionEdit",3,"label","required"],["pInputTextarea","","id","descriptionEdit","formControlName","description"]],template:function(s,r){s&1&&(l(0,"p-panel"),c(1,bn,3,4,"ng-template",0)(2,yn,1,1,"ng-template",1),a(),l(3,"p-dialog",2),X("visibleChange",function(E){return J(r.isVisibleObligationForm,E)||(r.isVisibleObligationForm=E),E}),c(4,On,13,14,"ng-template",1)(5,Nn,2,7,"ng-template",3),a(),l(6,"p-dialog",2),X("visibleChange",function(E){return J(r.isVisibleObligationDetailForm,E)||(r.isVisibleObligationDetailForm=E),E}),c(7,Bn,5,6,"ng-template",1)(8,Ln,2,7,"ng-template",3),a()),s&2&&(o(3),K(Q(8,hn)),Y("visible",r.isVisibleObligationForm),m("modal",!0),o(3),K(Q(9,gn)),Y("visible",r.isVisibleObligationDetailForm),m("modal",!0))},dependencies:[M,z,R,L,k,G,P,q,oe,N,re,se,le,Ce,Jt,me,pe,he]});let t=n;return t})();var kn=(t,n)=>n.field,Pn=()=>({width:"50rem",height:"50rem"});function qn(t,n){if(t&1){let e=F();l(0,"p-button",9),b("click",function(){_(e);let s=p(3);return h(s.showFinancingModal())}),a()}if(t&2){let e=p(3);m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Rn(t,n){if(t&1&&(l(0,"h4"),d(1),a(),c(2,qn,1,3,"p-button",8)),t&2){let e=p(2);o(),T("",e.FinancingsFormEnum.header,":"),o(),I(2,e.isFinancingField.value?2:-1)}}function Gn(t,n){if(t&1&&(l(0,"th",12),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function Hn(t,n){if(t&1&&(l(0,"tr"),w(1,Gn,2,2,"th",12,kn),l(3,"th",13),d(4),a()()),t&2){let e=n.$implicit,i=p(4);o(),O(e),o(3),T(" ",i.TableEnum.ACTIONS," ")}}function $n(t,n){if(t&1){let e=F();l(0,"tr")(1,"td"),d(2),a(),l(3,"td"),d(4),a(),l(5,"td"),d(6),a(),l(7,"td"),d(8),a(),l(9,"td")(10,"p-button",14),b("click",function(){let s=_(e).rowIndex,r=p(4);return h(r.deleteFinancing(s))}),a()()()}if(t&2){let e=n.$implicit,i=p(4);o(2),v(e.institutionName),o(2),v(e.budget),o(2),v(e.paymentMethod),o(2),v(e.source),o(2),m("icon",i.IconButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)}}function Un(t,n){if(t&1&&(l(0,"p-table",10),c(1,Hn,5,1,"ng-template",5)(2,$n,11,7,"ng-template",11),a()),t&2){let e=p(3);m("value",e.formInput.financings)("columns",e.financingsColumns)}}function jn(t,n){if(t&1&&c(0,Un,3,2,"p-table",10),t&2){let e=p(2);I(0,e.isFinancingField.value&&e.formInput.financings.length>0?0:-1)}}function Wn(t,n){t&1&&(l(0,"p-panel"),c(1,Rn,3,2,"ng-template",5)(2,jn,1,1,"ng-template",6),a())}function zn(t,n){t&1&&(l(0,"h3"),d(1,"Agregar"),a(),u(2,"app-form-help-field",15))}function Kn(t,n){if(t&1&&(l(0,"div",29)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e)}}function Yn(t,n){if(t&1&&(l(0,"div",29)(1,"div"),d(2),a()()),t&2){let e=n.$implicit;o(2),v(e)}}function Jn(t,n){if(t&1&&(l(0,"form",16)(1,"div",1),u(2,"label",17),l(3,"p-dropdown",18),c(4,Kn,3,1,"ng-template",19)(5,Yn,3,1,"ng-template",20),a(),u(6,"small",21),a(),l(7,"div",22),u(8,"label",23)(9,"p-inputNumber",24)(10,"small",21),a(),l(11,"div",22),u(12,"label",25)(13,"input",26)(14,"small",21),a(),l(15,"div",22),u(16,"label",27)(17,"input",28)(18,"small",21),a()()),t&2){let e=p();m("formGroup",e.financingForm),o(2),m("label",e.FinancingsFormEnum.institutionName)("required",e.institutionNameField),o(),m("options",e.combinedInstitutions),o(3),m("errors",e.institutionNameField.errors)("touched",e.institutionNameField.touched)("dirty",e.institutionNameField.dirty),o(2),m("label",e.FinancingsFormEnum.budget)("required",e.budgetField),o(),m("minFractionDigits",2)("maxFractionDigits",2),o(),m("errors",e.budgetField.errors)("touched",e.budgetField.touched)("dirty",e.budgetField.dirty),o(2),m("label",e.FinancingsFormEnum.paymentMethod)("required",e.paymentMethodField),o(2),m("errors",e.paymentMethodField.errors)("touched",e.paymentMethodField.touched)("dirty",e.paymentMethodField.dirty),o(2),m("label",e.FinancingsFormEnum.source)("required",e.sourceField),o(2),m("errors",e.sourceField.errors)("touched",e.sourceField.touched)("dirty",e.sourceField.dirty)}}function Xn(t,n){if(t&1){let e=F();l(0,"p-button",30),b("click",function(){_(e);let s=p();return h(s.isVisibleFinancingForm=!1)}),a(),l(1,"p-button",31),b("click",function(){_(e);let s=p();return h(s.addFinancing())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var fi=(()=>{let n=class n{constructor(){this.authService=g(_e),this.cataloguesHttpService=g(B),this.coreService=g($),this.formBuilder=g(V),this.messageDialogService=g(D),this.messageService=g(at),this.financingsColumns=[],this.formInput=Z(),this.formOutput=new x,this.formErrorsOutput=new x,this.formErrors=[],this.combinedInstitutions=[],this.AgreementFormEnum=C,this.SeverityButtonActionEnum=U,this.IconButtonActionEnum=te,this.LabelButtonActionEnum=ee,this.FinancingsFormEnum=ne,this.SkeletonEnum=j,this.TableEnum=ie,this.isVisibleFinancingForm=!1,this.buildForm(),this.buildFinancingForm(),this.buildFinancingsColumns(),this.checkValueChanges()}ngOnInit(){this.loadCombineInstitutions(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({isFinancing:[null,[f.required]],financings:this.formBuilder.array([],f.required)})}buildFinancingForm(){this.financingForm=this.formBuilder.group({institutionName:[null,[f.required]],budget:[null,[f.required,f.pattern(/^\d+(\.\d{2,2})?$/)]],paymentMethod:[null,[f.required,f.pattern(ye())]],source:[null,[f.required,f.pattern(ye())]]})}buildFinancingsColumns(){this.financingsColumns=[{field:"institutionName",header:ne.institutionName},{field:"budget",header:ne.budget},{field:"paymentMethod",header:ne.paymentMethod},{field:"source",header:ne.source}]}addFinancing(){if(this.validateFinancingForm()){if(this.formInput.financings.findIndex(i=>i.institutionName===this.financingForm.value.institutionName)>-1){this.messageDialogService.errorCustom("La entidad ya est\xE1 registrada","Intente con otra por favor");return}this.formInput.financings.push(this.financingForm.value),this.form.patchValue(this.formInput),this.financingForm.reset(),this.isVisibleFinancingForm=!1}else this.financingForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}deleteFinancing(i){this.formInput.financings.splice(i,1),this.form.patchValue(this.formInput)}loadCombineInstitutions(){this.combinedInstitutions=[];let i=[],s=[];this.formInput.internalInstitutions&&(i=this.formInput.internalInstitutions.map(r=>r.name)),this.formInput.externalInstitutions&&(s=this.formInput.externalInstitutions.map(r=>r.name)),this.combinedInstitutions=i.concat(s)}validateForm(){this.formErrors=[],this.isFinancingField.value&&this.formInput.financings&&this.formInput.financings.length===0&&this.formErrors.push("Financiamientos"),this.formErrorsOutput.emit(this.formErrors)}validateFinancingForm(){return this.formErrors=[],this.institutionNameField.invalid&&this.formErrors.push(ne.institutionName),this.budgetField.invalid&&this.formErrors.push(ne.budget),this.paymentMethodField.invalid&&this.formErrors.push(ne.paymentMethod),this.sourceField.invalid&&this.formErrors.push(ne.source),this.formErrors.length===0}checkValueChanges(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.isFinancingField.valueChanges.subscribe(i=>{this.formInput.isFinancing=i,i?(this.institutionNameField.setValidators(f.required),this.budgetField.setValidators(f.required),this.paymentMethodField.setValidators(f.required),this.sourceField.setValidators(f.required)):(this.institutionNameField.clearValidators(),this.budgetField.clearValidators(),this.paymentMethodField.clearValidators(),this.sourceField.clearValidators()),this.financingForm.reset(),this.institutionNameField.updateValueAndValidity(),this.budgetField.updateValueAndValidity(),this.paymentMethodField.updateValueAndValidity(),this.sourceField.updateValueAndValidity()})}showFinancingModal(){this.isVisibleFinancingForm=!0}get isFinancingField(){return this.form.controls.isFinancing}get institutionNameField(){return this.financingForm.controls.institutionName}get budgetField(){return this.financingForm.controls.budget}get paymentMethodField(){return this.financingForm.controls.paymentMethod}get sourceField(){return this.financingForm.controls.source}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-financing"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:9,vars:9,consts:[[1,"p-fluid","grid","text-center",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","isFinancing",3,"label","required"],["id","isFinancing","formControlName","isFinancing",1,"ml-2"],[3,"visibleChange","visible","modal"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"text-center"],[3,"click","icon","severity","pTooltip"],["content","Llenar campos conforme se\xF1ala convenio."],[1,"p-fluid","grid",3,"formGroup"],["appLabel","","for","combinedInstitution",3,"label","required"],["id","combinedInstitution","formControlName","institutionName","placeholder","Selecione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","","for","budget",3,"label","required"],["id","budget","formControlName","budget","mode","decimal",3,"minFractionDigits","maxFractionDigits"],["appLabel","","for","paymentMethod",3,"label","required"],["pInputText","","id","paymentMethod","formControlName","paymentMethod"],["appLabel","","for","source",3,"label","required"],["pInputText","","id","source","formControlName","source"],[1,"flex","align-items-center","gap-2"],[3,"click","label","icon","text","severity"],[3,"click","label","icon","severity"]],template:function(s,r){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"app-input-switch",3),a()(),c(4,Wn,3,0,"p-panel"),l(5,"p-dialog",4),X("visibleChange",function(E){return J(r.isVisibleFinancingForm,E)||(r.isVisibleFinancingForm=E),E}),c(6,zn,3,0,"ng-template",5)(7,Jn,19,24,"ng-template",6)(8,Xn,2,7,"ng-template",7),a()),s&2&&(m("formGroup",r.form),o(2),m("label",r.AgreementFormEnum.isFinancing)("required",r.isFinancingField),o(2),I(4,r.isFinancingField.value?4:-1),o(),K(Q(8,Pn)),Y("visible",r.isVisibleFinancingForm),m("modal",!0))},dependencies:[M,z,R,L,k,G,P,q,oe,N,ue,Ie,re,ae,se,le,Pe,me,pe,he]});let t=n;return t})();var io=(t,n)=>n.id,no=(t,n)=>n.field;function oo(t,n){if(t&1&&(u(0,"i"),l(1,"div",11),d(2),a()),t&2){let e=p().$implicit,i=p();Ve(i.PrimeIcons.FILE_PDF),o(2),T(" ",e.name," ")}}function ro(t,n){if(t&1){let e=F();l(0,"div",3),u(1,"label",4),l(2,"p-messages",5),c(3,oo,3,3,"ng-template",6),a()(),l(4,"div",7),u(5,"label",8)(6,"p-divider"),l(7,"p-fileUpload",9,0),b("uploadHandler",function(s){let r=_(e).$implicit,y=we(8),E=p();return h(E.uploadFile(s,y,r))}),a(),u(9,"small",10),a()}if(t&2){let e=p();o(),m("label",e.FileFormEnum.type)("required",e.typeField),o(4),m("label",e.FileFormEnum.myFile)("required",e.fileField),o(2),m("chooseIcon",e.PrimeIcons.UPLOAD)("auto",!0)("customUpload",!0),o(2),m("errors",e.fileField.errors)("touched",e.fileField.touched)("dirty",e.fileField.dirty)}}function ao(t,n){if(t&1&&(l(0,"th",14),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function lo(t,n){if(t&1&&(l(0,"tr"),w(1,ao,2,2,"th",14,no),l(3,"th"),d(4),a()()),t&2){let e=n.$implicit,i=p(2);o(),O(e),o(3),v(i.TableEnum.ACTIONS)}}function so(t,n){if(t&1){let e=F();l(0,"tr")(1,"td"),d(2),a(),l(3,"td"),d(4),a(),l(5,"td")(6,"p-button",15),b("click",function(){let s=_(e),r=s.$implicit,y=s.rowIndex,E=p(2);return h(E.removeFile(y,r))}),a()()()}if(t&2){let e=n.$implicit,i=p(2);o(2),v(e.type.name),o(2),v(e.name),o(2),m("icon",i.IconButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)}}function mo(t,n){if(t&1&&(l(0,"p-table",2),c(1,lo,5,1,"ng-template",12)(2,so,7,5,"ng-template",13),a()),t&2){let e=p();m("value",e.formInput.enablingDocuments)("columns",e.columns)}}var _i=(()=>{let n=class n{constructor(){this.formInput=Z(),this.formOutput=new x,this.formErrorsOutput=new x,this.cataloguesHttpService=g(B),this.messageDialogService=g(D),this.filesHttpService=g(ut),this.agreementsHttpService=g(fe),this.confirmationService=g(Oe),this.formBuilder=g(V),this.formErrors=[],this.LabelButtonActionEnum=ee,this.IconButtonActionEnum=te,this.FileFormEnum=Be,this.TableEnum=ie,this.SeverityButtonActionEnum=U,this.PrimeIcons=H,this.types=[],this.typesClone=[],this.columns=[],this.buildForm(),this.buildFileForm(),this.buildColumns()}ngOnInit(){this.loadTypes(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({files:this.formBuilder.array([],f.required)}),this.checkValuesChange()}buildFileForm(){this.fileForm=this.formBuilder.group({type:[null,f.required],myFile:[null,f.required]}),this.checkValuesChange()}checkValuesChange(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()})}buildColumns(){this.columns=[{field:"type",header:Be.type},{field:"name",header:Be.name}]}loadTypes(){this.types=this.cataloguesHttpService.findByType(S.AGREEMENTS_ENABLING_DOCUMENT),this.typesClone=this.cataloguesHttpService.findByType(S.AGREEMENTS_ENABLING_DOCUMENT);for(let i=0;i<this.formInput.enablingDocuments.length;i++){let s=this.types.findIndex(r=>r.id===this.formInput.enablingDocuments[i].type?.id);this.types.splice(s,1)}}validateForm(){this.formErrors=[],this.formInput.enablingDocuments.length<2&&this.formErrors.push(`Debe cargar los ${this.types.length} tipos de archivos`),this.formErrorsOutput.emit(this.formErrors)}validateFileForm(i,s){return this.formErrors=[],this.formInput.enablingDocuments.findIndex(r=>r.type?.id===s.id)>-1&&this.formErrors.push(`${s.name} ya se encuentra cargado`),this.formInput.enablingDocuments.findIndex(r=>r.name===i.name)>-1&&this.formErrors.push(`El archivo ${i.name} ya se encuentra cargado`),this.formErrors.length===0}uploadFile(i,s,r){let y=i.files[0];if(this.validateFileForm(y,r)){let E=new FormData;E.append("file",y),E.append("typeId",r.id),this.agreementsHttpService.uploadEnablingDocument(this.formInput.id,E).subscribe(vi=>{this.formInput.enablingDocuments.push({id:vi.id,name:y.name,type:r});let Ei=this.types.findIndex(Fi=>Fi.id===r.id);this.types.splice(Ei,1),this.form.patchValue(this.formInput)})}else this.messageDialogService.fieldErrors(this.formErrors),this.form.markAllAsTouched();s.clear()}removeFile(i,s){this.filesHttpService.remove(s.id).subscribe(r=>{this.formInput.enablingDocuments.splice(i,1),this.types.push(s.type),this.form.patchValue(this.formInput.enablingDocuments)})}get typeField(){return this.fileForm.controls.type}get fileField(){return this.fileForm.controls.myFile}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-document"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:4,vars:2,consts:[["uploadFiles",""],[1,"p-fluid","grid",3,"formGroup"],["styleClass","p-datatable-striped",3,"value","columns"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","",3,"label","required"],["severity","info"],["pTemplate",""],[1,"field","col-12","xl:col-2","lg:col-2","md:col-2","sm:col-12"],["appLabel","","for","file",3,"label","required"],["id","file","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf","maxFileSize","1000000",3,"uploadHandler","chooseIcon","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"ml-2"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","pTooltip","severity"]],template:function(s,r){s&1&&(l(0,"form",1),w(1,ro,10,10,null,null,io),a(),c(3,mo,3,2,"p-table",2)),s&2&&(m("formGroup",r.fileForm),o(),O(r.types),o(2),I(3,r.formInput.enablingDocuments.length>0?3:-1))},dependencies:[M,L,k,P,q,oe,N,re,ke,Re,qe,me,pe]});let t=n;return t})();var uo=(t,n)=>n.field,co=()=>({width:"50rem"});function fo(t,n){if(t&1&&(l(0,"p"),u(1,"p-tag",8),a()),t&2){let e=p();o(),m("severity",e.SeverityButtonActionEnum.DELETE)}}function _o(t,n){if(t&1){let e=F();l(0,"p-button",11),b("click",function(){_(e);let s=p(3);return h(s.showAddendumModal())}),a()}if(t&2){let e=p(3);m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function ho(t,n){if(t&1&&(l(0,"h4"),d(1),a(),c(2,_o,1,3,"p-button",10)),t&2){let e=p(2);o(),T("",e.AddendumEnum.header,":"),o(),I(2,e.isAddendumField.value?2:-1)}}function go(t,n){if(t&1&&(l(0,"th",14),d(1),a()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),o(),T(" ",e.header," ")}}function bo(t,n){if(t&1&&(l(0,"tr"),w(1,go,2,2,"th",14,uo),l(3,"th"),d(4),a()()),t&2){let e=n.$implicit,i=p(4);o(),O(e),o(3),v(i.TableEnum.ACTIONS)}}function vo(t,n){if(t&1&&d(0),t&2){let e=n.$implicit;T(" ",e.name," ")}}function Eo(t,n){if(t&1){let e=F();l(0,"tr")(1,"td"),d(2),a(),l(3,"td"),w(4,vo,1,1,null,null,ge),a(),l(6,"td")(7,"p-button",15),b("click",function(){let s=_(e).$implicit,r=p(4);return h(r.deleteAddendum(s.id))}),a()()()}if(t&2){let e=n.$implicit,i=p(4);o(2),v(e.description),o(2),O(e.files),o(3),m("icon",i.IconButtonActionEnum.DELETE)("pTooltip",i.LabelButtonActionEnum.DELETE)("severity",i.SeverityButtonActionEnum.DELETE)}}function Fo(t,n){if(t&1&&(l(0,"p-table",12),c(1,bo,5,1,"ng-template",9)(2,Eo,8,4,"ng-template",13),a()),t&2){let e=p(3);m("value",e.formInput.addendums)("columns",e.columns)}}function Co(t,n){if(t&1&&c(0,Fo,3,2,"p-table",12),t&2){let e=p(2);I(0,e.formInput.addendums.length>0?0:-1)}}function Io(t,n){t&1&&(l(0,"p-panel"),c(1,ho,3,2,"ng-template",9)(2,Co,1,1,"ng-template",6),a())}function yo(t,n){if(t&1&&(u(0,"i"),l(1,"div",25),d(2),a()),t&2){let e=p(3);Ve(e.PrimeIcons.FILE_PDF),o(2),v(e.fileField.value==null?null:e.fileField.value.name)}}function xo(t,n){t&1&&(l(0,"div",20)(1,"p-messages",23),c(2,yo,3,3,"ng-template",24),a()())}function To(t,n){if(t&1){let e=F();l(0,"div",16)(1,"div",2),u(2,"label",17)(3,"input",18)(4,"small",19),a(),l(5,"div",20),u(6,"label",21),l(7,"p-fileUpload",22,0),b("uploadHandler",function(s){_(e);let r=we(8),y=p();return h(y.uploadAddendumFile(s,r))}),a(),u(9,"small",19),a(),c(10,xo,3,0,"div",20),a()}if(t&2){let e=p();m("formGroup",e.addendumForm),o(2),m("label",e.AddendumEnum.description)("required",e.descriptionField),o(2),m("errors",e.descriptionField.errors)("touched",e.descriptionField.touched)("dirty",e.descriptionField.dirty),o(2),m("label",e.AddendumEnum.file)("required",e.fileField),o(),m("chooseIcon",e.PrimeIcons.UPLOAD)("auto",!0)("customUpload",!0),o(2),m("errors",e.fileField.errors)("touched",e.fileField.touched)("dirty",e.fileField.dirty),o(),I(10,e.fileField.value?10:-1)}}function So(t,n){if(t&1){let e=F();l(0,"p-button",26),b("click",function(){_(e);let s=p();return h(s.isVisibleAddendumForm=!1)}),a(),l(1,"p-button",27),b("click",function(){_(e);let s=p();return h(s.onUpload())}),a()}if(t&2){let e=p();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),o(),m("icon",e.IconButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var hi=(()=>{let n=class n{constructor(){this.formInput=Z(),this.formOutput=new x,this.formErrorsOutput=new x,this.agreementsHttpService=g(fe),this.addendumsHttpService=g(dt),this.cataloguesHttpService=g(B),this.messageDialogService=g(D),this.formBuilder=g(V),this.formErrors=[],this.LabelButtonActionEnum=ee,this.IconButtonActionEnum=te,this.AddendumEnum=Se,this.AgreementFormEnum=C,this.TableEnum=ie,this.SeverityButtonActionEnum=U,this.PrimeIcons=H,this.types=[],this.columns=[],this.isVisibleAddendumForm=!1,this.yesNo=[],this.buildForm(),this.buildAddendumForm(),this.buildFileForm(),this.checkValuesChange(),this.buildColumns(),this.yesNo=[{label:"Si",value:!0},{label:"No",value:!1}]}ngOnInit(){this.loadTypes(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput),this.formInput.addendums.length>0?this.isAddendumField.disable():this.isAddendumField.enable()}buildForm(){this.form=this.formBuilder.group({isAddendum:[!1],addendums:this.formBuilder.array([],f.required)})}buildAddendumForm(){this.addendumForm=this.formBuilder.group({description:[null],file:[null]})}buildFileForm(){this.fileForm=this.formBuilder.group({type:[null,f.required],myFile:[null,f.required]}),this.checkValuesChange()}checkValuesChange(){this.form.valueChanges.subscribe(i=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.isAddendumField.valueChanges.subscribe(i=>{this.formInput.isAddendum=i,i?(this.descriptionField.setValidators(f.required),this.fileField.setValidators(f.required)):(this.descriptionField.clearValidators(),this.fileField.clearValidators()),this.descriptionField.updateValueAndValidity()})}buildColumns(){this.columns=[{field:"description",header:Se.description},{field:"file",header:Se.file}]}loadTypes(){this.types=this.cataloguesHttpService.findByType(S.AGREEMENTS_ADDENDUM_DOCUMENT)}validateForm(){this.formErrors=[],this.formErrorsOutput.emit(this.formErrors)}validateAddendumForm(){return this.formErrors=[],this.descriptionField.invalid&&this.formErrors.push(Se.description),this.formErrors.length===0}uploadAddendumFile(i,s){this.fileField.patchValue({file:i.files[0],name:i.files[0].name,type:this.types[0]}),s.clear()}onUpload(){if(this.validateAddendumForm()){let i=new FormData;i.append("file",this.fileField.value.file),i.append("typeId",this.fileField.value.type.id),i.append("description",this.descriptionField.value),this.agreementsHttpService.uploadAddendum(this.formInput.id,i).subscribe(s=>{this.formInput.addendums.push({id:s.id,description:this.descriptionField.value,files:[{file:this.fileField.value.file,name:this.fileField.value.name}]}),this.form.patchValue(this.formInput),this.addendumForm.reset(),this.isVisibleAddendumForm=!1,this.formInput.addendums.length>0&&this.isAddendumField.disable()})}else this.messageDialogService.fieldErrors(this.formErrors),this.form.markAllAsTouched(),this.addendumForm.markAllAsTouched()}showAddendumModal(){this.isVisibleAddendumForm=!0}deleteAddendum(i){this.addendumsHttpService.remove(i).subscribe(s=>{let r=this.formInput.addendums.findIndex(y=>y.id===i);this.formInput.addendums.splice(r,1),this.form.patchValue(this.formInput),this.formInput.addendums.length===0&&this.isAddendumField.enable()})}get isAddendumField(){return this.form.controls.isAddendum}get descriptionField(){return this.addendumForm.controls.description}get fileField(){return this.addendumForm.controls.file}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-addendum"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:11,vars:10,consts:[["uploadFiles",""],[1,"p-fluid","grid","text-center",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","isAddendum",3,"label","required"],["id","isAddendum","formControlName","isAddendum",1,"ml-2"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["value","Debe eliminar todas las adendas antes de poder cambiar de opci\xF3n",1,"ml-2",3,"severity"],["pTemplate","header"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","pTooltip","severity"],[1,"p-fluid","grid",3,"formGroup"],["appLabel","","for","description",3,"label","required"],["pInputText","","type","text","id","description","formControlName","description"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","file",3,"label","required"],["id","file","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","maxFileSize","1000000",3,"uploadHandler","chooseIcon","auto","customUpload"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(s,r){s&1&&(l(0,"h3"),d(1,`La secci\xF3n que se muestra a continuaci\xF3n no es de car\xE1cter obligatorio, sin embargo, si se ha realizado una adenda o modificatorio al convenio, por favor complete los siguientes campos:
`),a(),l(2,"form",1)(3,"div",2),u(4,"label",3)(5,"app-input-switch",4),c(6,fo,2,1,"p"),a()(),c(7,Io,3,0,"p-panel"),l(8,"p-dialog",5),X("visibleChange",function(E){return J(r.isVisibleAddendumForm,E)||(r.isVisibleAddendumForm=E),E}),c(9,To,11,15,"ng-template",6)(10,So,2,7,"ng-template",7),a()),s&2&&(o(2),m("formGroup",r.form),o(2),m("label",r.AgreementFormEnum.isAddendum)("required",r.isAddendumField),o(2),I(6,r.formInput.addendums.length>0?6:-1),o(),I(7,r.formInput.isAddendum?7:-1),o(),K(Q(9,co)),Y("visible",r.isVisibleAddendumForm),m("modal",!0))},dependencies:[M,z,R,L,k,G,P,q,oe,N,Ie,re,ae,le,Re,qe,me,pe,he,Pt]});let t=n;return t})();function Do(t,n){t&1&&(l(0,"h3"),d(1,"Administrador del Convenio"),a(),u(2,"app-form-help-field",20))}function Vo(t,n){if(t&1){let e=F();l(0,"app-agreement-administrator",21),b("formErrorsOutput",function(s){_(e);let r=p(3);return h(r.agreementAdministratorErrors=s)})("formOutput",function(s){_(e);let r=p(3);return h(r.save(s))}),a()}if(t&2){let e=p(3);m("formInput",e.form.value)}}function wo(t,n){if(t&1){let e=F();l(0,"p-toolbar")(1,"div",8),u(2,"app-header-form",9),a(),l(3,"div",10)(4,"app-form-button-action",11),b("submit",function(){let s=_(e).nextCallback,r=p(2);return h(r.validateFormAgreement(s))})("cancel",function(){_(e);let s=p(2);return h(s.redirectAgreementList())}),a()()(),u(5,"p-divider"),l(6,"div",12)(7,"p-panel",13)(8,"app-basic-data",14),b("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.basicDataErrors=s)})("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))}),a()(),l(9,"p-panel",15)(10,"app-agreement-date",14),b("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.agreementDateErrors=s)})("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))}),a()(),l(11,"p-panel",16),c(12,Do,3,0,"ng-template",17)(13,Vo,1,1,"ng-template",3),a(),l(14,"p-panel",18)(15,"app-appearer",14),b("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.appearerErrors=s)})("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))}),a()()(),l(16,"p-toolbar")(17,"div",8),u(18,"app-header-form",9),a(),l(19,"div",10)(20,"app-form-button-action",19),b("submit",function(){let s=_(e).nextCallback,r=p(2);return h(r.validateFormAgreement(s))}),a()()()}if(t&2){let e=p(2);o(2),m("icon",e.PrimeIcons.PENCIL),o(2),m("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!0),o(4),m("formInput",e.form.value),o(2),m("formInput",e.form.value),o(5),m("formInput",e.form.value),o(3),m("icon",e.PrimeIcons.PENCIL),o(2),m("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1)}}function Oo(t,n){if(t&1){let e=F();l(0,"p-toolbar")(1,"div",8),u(2,"app-header-form",9),a(),l(3,"div",10)(4,"app-form-button-action",22),b("submit",function(){let s=_(e).nextCallback,r=p(2);return h(r.validateFormObligation(s))})("cancel",function(){let s=_(e).prevCallback;return h(s.emit())}),a()()(),u(5,"p-divider"),l(6,"app-obligation",14),b("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.obligationErrors=s)})("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))}),a()}if(t&2){let e=p(2);o(2),m("icon",e.PrimeIcons.PENCIL),o(2),m("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!0),o(2),m("formInput",e.form.value)}}function No(t,n){if(t&1){let e=F();l(0,"p-toolbar")(1,"div",8),u(2,"app-header-form",9),a(),l(3,"div",10)(4,"app-form-button-action",23),b("submit",function(){let s=_(e).nextCallback,r=p(2);return h(r.onSubmitAgreement(s))})("cancel",function(){let s=_(e).prevCallback;return h(s.emit())}),a()()(),u(5,"p-divider"),l(6,"app-financing",24),b("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))})("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.financingErrors=s)}),a()}if(t&2){let e=p(2);o(2),m("icon",e.PrimeIcons.PENCIL),o(2),m("isVisibleCancelButton",!0),o(2),m("formInput",e.form.value)}}function Bo(t,n){if(t&1){let e=F();l(0,"p-toolbar")(1,"div",8),u(2,"app-header-form",9),a(),l(3,"div",10)(4,"app-form-button-action",19),b("submit",function(){let s=_(e).nextCallback,r=p(2);return h(r.onSubmitDocuments(s))}),a()()(),u(5,"p-divider"),l(6,"app-document",24),b("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))})("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.documentErrors=s)}),a()}if(t&2){let e=p(2);o(2),m("icon",e.PrimeIcons.PENCIL),o(2),m("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1),o(2),m("formInput",e.form.value)}}function Lo(t,n){if(t&1){let e=F();l(0,"p-toolbar")(1,"div",8),u(2,"app-header-form",9),a(),l(3,"div",10)(4,"app-form-button-action",25),b("submit",function(){_(e);let s=p(2);return h(s.finish())}),a()()(),u(5,"p-divider"),l(6,"app-addendum",24),b("formOutput",function(s){_(e);let r=p(2);return h(r.save(s))})("formErrorsOutput",function(s){_(e);let r=p(2);return h(r.documentErrors=s)}),a()}if(t&2){let e=p(2);o(2),m("icon",e.PrimeIcons.PENCIL),o(2),m("severitySubmitButton",e.SeverityButtonActionEnum.ADD)("isVisibleCancelButton",!1),o(2),m("formInput",e.form.value)}}function Mo(t,n){if(t&1&&(l(0,"p-stepper",0)(1,"p-stepperPanel",2),c(2,wo,21,9,"ng-template",3),a(),l(3,"p-stepperPanel",4),c(4,Oo,7,4,"ng-template",3),a(),l(5,"p-stepperPanel",5),c(6,No,7,3,"ng-template",3),a(),l(7,"p-stepperPanel",6),c(8,Bo,7,4,"ng-template",3),a(),l(9,"p-stepperPanel",7),c(10,Lo,7,4,"ng-template",3),a()()),t&2){let e=p();m("linear",!0)("activeStep",e.activeStep)}}var gi=(()=>{let n=class n{constructor(){this.authService=g(_e),this.agreementsService=g(st),this.agreementsHttpService=g(fe),this.breadcrumbService=g(lt),this.confirmationService=g(Oe),this.formBuilder=g(V),this.messageDialogService=g(D),this.router=g(rt),this.SeverityButtonActionEnum=U,this.PrimeIcons=H,this.formErrors=[],this.basicDataErrors=[],this.agreementDateErrors=[],this.agreementAdministratorErrors=[],this.appearerErrors=[],this.obligationErrors=[],this.financingErrors=[],this.documentErrors=[],this.activeStep=0,this.breadcrumbService.setItems([{label:Qe.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:Qe.AGREEMENTS_REGISTER}]),this.buildForm()}ngOnInit(){this.agreementsService.agreementStorage&&(console.log("Ingreso"),console.log(this.agreementsService.agreementStorage),this.form.patchValue(this.agreementsService.agreementStorage),this.idField.value&&(this.activeStep=3),this.enablingDocumentsField.value.length==2&&this.enablingDocumentsField.value.every(i=>i.id)&&(this.activeStep=4))}buildForm(){this.form=this.formBuilder.group({id:[null],agreementState:[null],name:[null],internalNumber:[null],number:[null],origin:[null],type:[null],specialType:[null],internalInstitutions:[[]],externalInstitutions:[[]],subscribedAt:[new Date],startedAt:[new Date],isFinishDate:[!0],endedAt:[null],endedReason:[null],totalTerm:[null],yearTerm:[null],monthTerm:[null],dayTerm:[null],objective:[null],administrator:[null],obligations:[[]],isFinancing:[!1],financings:[[]],isAddendum:[!1],addendums:[[]],enablingDocuments:[[]],enabled:[!1]})}get validateForms(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.agreementAdministratorErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors=this.formErrors.concat(this.financingErrors),this.formErrors.length===0}validateFormAgreement(i){this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.agreementAdministratorErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors.length===0?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}validateFormObligation(i){this.formErrors=[],this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors.length===0?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}get validateFormDocument(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.documentErrors),this.formErrors.length===0}onSubmitAgreement(i){this.validateForms?this.register(i):this.messageDialogService.fieldErrors(this.formErrors)}onSubmitDocuments(i){this.validateFormDocument?i.emit():this.messageDialogService.fieldErrors(this.formErrors)}save(i){this.form.patchValue(i),this.agreementsService.agreement=this.form.value}register(i){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:H.QUESTION_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.agreementsHttpService.register(this.agreementsService.agreement).subscribe(s=>{this.agreementsService.agreement=s,this.form.patchValue(s),i.emit()})}})}registerDocuments(i){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:H.TIMES_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{let s=new FormData;for(let r of this.enablingDocumentsField.value)s.append("typeIds",r.type.id),s.append("files",r.file);this.idField.valid&&this.agreementsHttpService.uploadEnablingDocuments(this.idField.value,s).subscribe(r=>{this.form.patchValue(r),this.agreementsService.agreement=r,i.emit()})}})}finish(){this.agreementsHttpService.finish(this.idField.value).subscribe(i=>{this.agreementsService.clearAgreement(),this.authService.role.code===ce.NATIONAL_SUPERVISOR&&this.router.navigate(["/core/national-supervisor/agreement-list"]),this.authService.role.code===ce.INTERNATIONAL_SUPERVISOR&&this.router.navigate(["/core/international-supervisor/agreement-list"])})}redirectAgreementList(){this.authService.role.code===ce.NATIONAL_SUPERVISOR&&this.router.navigate(["/core/national-supervisor/agreement-list"]),this.authService.role.code===ce.INTERNATIONAL_SUPERVISOR&&this.router.navigate(["/core/international-supervisor/agreement-list"])}get idField(){return this.form.controls.id}get enablingDocumentsField(){return this.form.controls.enablingDocuments}get enabledField(){return this.form.controls.enabled}};n.\u0275fac=function(s){return new(s||n)},n.\u0275cmp=A({type:n,selectors:[["app-register"]],decls:2,vars:1,consts:[["orientation","horizontal",3,"linear","activeStep"],["key","confirmDialog"],["header","Convenio"],["pTemplate","content"],["header","Obligaciones"],["header","Financiamiento"],["header","Documentaci\xF3n"],["header","Registro de adendas o modificatorios"],[1,"p-toolbar-group-left"],["label","Registro",3,"icon"],[1,"p-toolbar-group-right"],["labelSubmitButton","Siguiente",3,"submit","cancel","iconSubmitButton","isVisibleCancelButton"],[1,"p-fluid","grid"],["header","Datos B\xE1sicos",1,"col-12"],[3,"formErrorsOutput","formOutput","formInput"],["header","Fechas del Convenio",1,"col-12"],[1,"col-12"],["pTemplate","header"],["header","Comparecientes",1,"col-12"],["labelSubmitButton","Siguiente",3,"submit","iconSubmitButton","isVisibleCancelButton"],["content","Registrar conforme se\xF1ala convenio o designaci\xF3n"],[1,"col-12",3,"formErrorsOutput","formOutput","formInput"],["labelSubmitButton","Siguiente","labelCancelButton","Regresar",3,"submit","cancel","iconSubmitButton","isVisibleCancelButton"],["labelSubmitButton","Guardar","labelCancelButton","Regresar",3,"submit","cancel","isVisibleCancelButton"],[3,"formOutput","formErrorsOutput","formInput"],["labelSubmitButton","Finalizar",3,"submit","severitySubmitButton","isVisibleCancelButton"]],template:function(s,r){s&1&&(c(0,Mo,11,2,"p-stepper",0),u(1,"p-confirmDialog",1)),s&2&&I(0,r.form.value?0:-1)},dependencies:[Ht,N,jt,ue,ke,le,Ot,Zt,Qt,$t,li,si,ui,di,ci,fi,_i,hi]});let t=n;return t})();var ko=[{path:"",component:gi,canActivate:[vt],data:{roles:[ce.NATIONAL_SUPERVISOR,ce.INTERNATIONAL_SUPERVISOR]}}],bi=(()=>{let n=class n{};n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=De({type:n}),n.\u0275inj=Ae({imports:[Je.forChild(ko),Je]});let t=n;return t})();var Ml=(()=>{let n=class n{};n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=De({type:n}),n.\u0275inj=Ae({providers:[ct],imports:[ot,bi,gt,zt,_t,xt,Tt,yt,bt,Et,ft,It,Lt,Ft,Kt,Nt,kt,Dt,ii,At,ni,ei,oi,Bt,Mt,Xt,ht,wt,Gt,Ut,Vt,Wt,qt,Yt,Rt]});let t=n;return t})();export{Ml as RegisterModule};
