import{a as be,b as Ae}from"./chunk-B43VRK7P.js";import{a as Pt,b as kt,c as Mt,d as Me}from"./chunk-DCQD2KJT.js";import{a as pt}from"./chunk-K2ZD5453.js";import{a as Se,b as ct}from"./chunk-2HMFN2Z7.js";import"./chunk-VBZFO5L5.js";import{a as qt,b as Ut,c as Rt,d as Gt,e as Ht,f as jt}from"./chunk-X645IHYT.js";import{b as Lt}from"./chunk-OKUVFNC3.js";import{c as ut,e as gt}from"./chunk-ZJUUJKIP.js";import{A as q,B as U,Ga as _e,Ha as ke,Ia as Vt,Ja as wt,Ka as Nt,P as ue,Q as dt,Qa as Bt,Ra as ge,Sa as Ot,U as ft,V as ht,W as _t,Z as bt,_ as Et,ba as de,ca as vt,d as me,da as ce,ea as Ft,i as Y,ia as ne,ja as fe,k as d,m as O,n as L,oa as yt,q as P,qa as It,ra as Ct,s as k,t as at,ta as xt,u as M,ua as Tt,v as A,va as he,w as lt,wa as St,x as st,y as pe,ya as At,z as mt}from"./chunk-4ES35ZDM.js";import{A as it,B as y,C as Pe,G as nt,K as se,b as B,c as V,e as Ze,f as et,g as Oe,h as tt,j as Le,l as ee,m as te,n as W,p as z,r as le,u as ve,v as K,x as re,y as H,z as De}from"./chunk-G2LENOAT.js";import{e as ot,j as ie,k as rt,p as Dt}from"./chunk-CSO23DVT.js";import{e as Xe,k as j,o as N,r as $,v as S,w as ae,x as Qe}from"./chunk-ZFS7MCCM.js";import{B as D,Ba as je,C as Te,Da as c,Ea as E,Fa as w,G as f,Ga as $e,H as h,Hb as Je,Ia as X,Ja as Q,Ka as Z,Kb as Be,M as C,Oa as x,S as n,Ya as We,Za as ze,a as Ne,ba as g,c as He,da as r,ga as J,ia as F,ja as Ee,ka as R,la as G,ma as l,na as m,oa as u,rb as Ke,sa as v,sb as Ye,ta as _,ua as p,w as xe,z as b}from"./chunk-3AQ5X5KI.js";function si(t,a){if(t&1&&(l(0,"div",15),u(1,"label",16)(2,"app-form-help-field",17)(3,"p-calendar",18)(4,"small",4),m(),l(5,"div",14)(6,"label"),c(7,"Plazo total del convenio:"),m()(),l(8,"div",19),u(9,"label",20)(10,"p-inputNumber",21)(11,"small",4),m(),l(12,"div",19),u(13,"label",22)(14,"p-inputNumber",23)(15,"small",4),m(),l(16,"div",19),u(17,"label",24)(18,"p-inputNumber",25)(19,"small",4),m()),t&2){let e=p();n(),r("label",e.AgreementFormEnum.endedAt)("required",e.endedAtField),n(2),r("iconDisplay","input")("showIcon",!0)("minDate",e.startedAtField.value),n(),r("errors",e.endedAtField.errors)("touched",e.endedAtField.touched)("dirty",e.endedAtField.dirty),n(5),r("label",e.AgreementFormEnum.yearTerm)("required",e.yearTermField),n(),r("showButtons",!0)("min",0)("useGrouping",!1),n(),r("errors",e.yearTermField.errors)("touched",e.yearTermField.touched)("dirty",e.yearTermField.dirty),n(2),r("label",e.AgreementFormEnum.monthTerm)("required",e.monthTermField),n(),r("showButtons",!0)("min",0),n(),r("errors",e.monthTermField.errors)("touched",e.monthTermField.touched)("dirty",e.monthTermField.dirty),n(2),r("label",e.AgreementFormEnum.dayTerm)("required",e.dayTermField),n(),r("showButtons",!0)("min",0),n(),r("errors",e.dayTermField.errors)("touched",e.dayTermField.touched)("dirty",e.dayTermField.dirty)}}function mi(t,a){if(t&1&&(l(0,"div",14),u(1,"label",26),l(2,"textarea",27),c(3,"      "),m(),u(4,"small",4),m()),t&2){let e=p();n(),r("label",e.AgreementFormEnum.endedReason)("required",e.endedReasonField),n(3),r("errors",e.endedReasonField.errors)("touched",e.endedReasonField.touched)("dirty",e.endedReasonField.dirty)}}var Kt=(()=>{let a=class a{constructor(){this.formBuilder=b(A),this.coreService=b($),this.cataloguesHttpService=b(B),this.messageDialogService=b(S),this.formOutput=new C,this.formErrorsOutput=new C,this.nextOutput=new C,this.prevOutput=new C,this.formErrors=[],this.Validators=d,this.SkeletonEnum=z,this.AgreementFormEnum=y,this.buildForm()}ngOnInit(){this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({subscribedAt:[{value:null,disabled:!0},d.required],startedAt:[{value:null,disabled:!0},d.required],isFinishDate:[{value:null,disabled:!0},d.required],endedAt:[{value:null,disabled:!0},d.required],endedReason:[null],yearTerm:[null,d.required],monthTerm:[null,d.required],dayTerm:[null,d.required]}),this.checkValueChanges()}patchValueForm(){let I=this.formInput,{endedAt:o,startedAt:s,subscribedAt:i}=I,T=He(I,["endedAt","startedAt","subscribedAt"]);this.form.patchValue(T),s&&this.startedAtField.setValue(Ae(s)),i&&this.subscribedAtField.setValue(Ae(i)),o&&this.endedAtField.setValue(Ae(o))}checkValueChanges(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(o),this.validateForm()}),this.isFinishDateField.valueChanges.subscribe(o=>{o?(this.endedAtField.setValidators(d.required),this.yearTermField.setValidators(d.required),this.monthTermField.setValidators(d.required),this.dayTermField.setValidators(d.required),this.endedReasonField.clearValidators(),this.endedReasonField.reset()):o===!1&&(this.endedReasonField.setValidators(d.required),this.yearTermField.clearValidators(),this.monthTermField.clearValidators(),this.dayTermField.clearValidators(),this.endedAtField.clearValidators(),this.endedAtField.reset(),this.yearTermField.reset(),this.monthTermField.reset(),this.dayTermField.reset()),this.endedReasonField.updateValueAndValidity(),this.endedAtField.updateValueAndValidity(),this.yearTermField.updateValueAndValidity(),this.monthTermField.updateValueAndValidity(),this.dayTermField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.subscribedAtField.invalid&&this.formErrors.push(y.subscribedAt),this.startedAtField.invalid&&this.formErrors.push(y.startedAt),this.isFinishDateField.invalid&&this.formErrors.push(y.isFinishDate),this.endedAtField.invalid&&this.formErrors.push(y.endedAt),this.endedReasonField.invalid&&this.formErrors.push(y.endedReason),this.yearTermField.invalid&&this.formErrors.push(y.yearTerm),this.monthTermField.invalid&&this.formErrors.push(y.monthTerm),this.dayTermField.invalid&&this.formErrors.push(y.dayTerm),this.formErrorsOutput.emit(this.formErrors)}get subscribedAtField(){return this.form.controls.subscribedAt}get startedAtField(){return this.form.controls.startedAt}get isFinishDateField(){return this.form.controls.isFinishDate}get endedAtField(){return this.form.controls.endedAt}get endedReasonField(){return this.form.controls.endedReason}get yearTermField(){return this.form.controls.yearTerm}get monthTermField(){return this.form.controls.monthTerm}get dayTermField(){return this.form.controls.dayTerm}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-agreement-date"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput",nextOutput:"nextOutput",prevOutput:"prevOutput"},decls:23,vars:25,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","subscribedAt",3,"label","required"],["id","subscribedAt","formControlName","subscribedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","startedAt",3,"label","required"],["id","startedAt","formControlName","startedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon","minDate"],["appLabel","","for","isFinishDate",3,"label","required"],[1,"flex","gap-3"],[1,"flex","align-items-center"],["id","isFinishDate","formControlName","isFinishDate","name","isFinishDate",3,"value"],["for","isFinishDate",1,"ml-2"],["id","no","formControlName","isFinishDate","name","isFinishDate",3,"value"],["for","no",1,"ml-2"],[1,"field","col-12"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","endedAt",3,"label","required"],["content","Esto es un mensaje de prueba"],["id","endedAt","formControlName","endedAt","dateFormat","yy-mm-dd",3,"iconDisplay","showIcon","minDate"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","","for","yearTerm",3,"label","required"],["id","yearTerm","formControlName","yearTerm",3,"showButtons","min","useGrouping"],["appLabel","","for","monthTerm",3,"label","required"],["id","monthTerm","formControlName","monthTerm",3,"showButtons","min"],["appLabel","","for","dayTerm",3,"label","required"],["id","dayTerm","formControlName","dayTerm",3,"showButtons","min"],["appLabel","","for","endedReason",3,"label","required"],["pInputTextarea","","id","endedReason","formControlName","endedReason","rows","5","cols","30",2,"resize","none"]],template:function(s,i){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"p-calendar",3)(4,"small",4),m(),l(5,"div",1),u(6,"label",5)(7,"p-calendar",6)(8,"small",4),m(),l(9,"div",1),u(10,"label",7),l(11,"div",8)(12,"div",9),u(13,"p-radioButton",10),l(14,"label",11),c(15," Si "),m()(),l(16,"div",9),u(17,"p-radioButton",12),l(18,"label",13),c(19," No "),m()()(),u(20,"small",4),m(),g(21,si,20,30)(22,mi,5,5,"div",14),m()),s&2&&(r("formGroup",i.form),n(2),r("label",i.AgreementFormEnum.subscribedAt)("required",i.subscribedAtField),n(),r("iconDisplay","input")("showIcon",!0),n(),r("errors",i.subscribedAtField.errors)("touched",i.subscribedAtField.touched)("dirty",i.subscribedAtField.dirty),n(2),r("label",i.AgreementFormEnum.startedAt)("required",i.startedAtField),n(),r("iconDisplay","input")("showIcon",!0)("minDate",i.subscribedAtField.value),n(),r("errors",i.startedAtField.errors)("touched",i.startedAtField.touched)("dirty",i.startedAtField.dirty),n(2),r("label",i.AgreementFormEnum.isFinishDate)("required",i.isFinishDateField),n(3),r("value",!0),n(4),r("value",!1),n(3),r("errors",i.isFinishDateField.errors)("touched",i.isFinishDateField.touched)("dirty",i.isFinishDateField.dirty),n(),F(21,i.isFinishDateField.value?21:-1),n(),F(22,i.isFinishDateField.value===!1?22:-1))},dependencies:[P,Y,O,L,k,M,q,U,ge,ce,bt,Ht,he]});let t=a;return t})();var Yt=()=>["Esto es un listado 1","Esto es un listado 2","Esto es un listado 3"],Ve=()=>["Ayuda 1","Ayuda 2","Ayuda 3"];function ui(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function di(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function ci(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function fi(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function hi(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function _i(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function gi(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function bi(t,a){if(t&1&&(l(0,"div",25)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function Ei(t,a){if(t&1&&(l(0,"div",10),u(1,"label",26)(2,"app-form-help-field",3),l(3,"p-dropdown",27),g(4,gi,3,1,"ng-template",16)(5,bi,3,1,"ng-template",17),m(),u(6,"small",5),m()),t&2){let e=p();n(),r("label",e.AgreementFormEnum.specialType)("required",e.specialTypeField),n(),r("content",x(7,Ve)),n(),r("options",e.specialTypes),n(3),r("errors",e.specialTypeField.errors)("touched",e.specialTypeField.touched)("dirty",e.specialTypeField.dirty)}}var Qt=(()=>{let a=class a{constructor(){this.coreService=b($),this.cataloguesHttpService=b(B),this.formBuilder=b(A),this.messageDialogService=b(S),this.Validators=d,this.formOutput=new C,this.formErrorsOutput=new C,this.formErrors=[],this.origins=[],this.specialTypes=[],this.states=[],this.types=[],this.AgreementFormEnum=y,this.AgreementStateEnum=Pe,this.SkeletonEnum=z,this.buildForm()}ngOnInit(){this.loadStates(),this.loadOrigins(),this.loadTypes(),this.loadSpecialTypes(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({agreementState:this.agreementStateForm,name:[null,[d.required]],internalNumber:[null,[d.required]],number:[null,[d.required]],objective:[null,[d.required]],origin:[{value:null,disabled:!0},[d.required]],specialType:[null],type:[null,[d.required]]}),this.checkValueChanges()}patchValueForm(){this.form.patchValue(this.formInput)}get agreementStateForm(){return this.formBuilder.group({state:[{value:null,disabled:!0},[d.required]]})}checkValueChanges(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(o),this.validateForm()}),this.typeField.valueChanges.subscribe(o=>{o&&o.code===et.SPECIAL?this.specialTypeField.setValidators(d.required):this.specialTypeField.clearValidators(),this.specialTypeField.reset(),this.specialTypeField.updateValueAndValidity()})}validateForm(){this.formErrors=[],this.stateField.invalid&&this.formErrors.push(Pe.state),this.nameField.invalid&&this.formErrors.push(y.name),this.internalNumberField.invalid&&this.formErrors.push(y.internalNumber),this.numberField.invalid&&this.formErrors.push(y.number),this.objectiveField.invalid&&this.formErrors.push(y.objective),this.originField.invalid&&this.formErrors.push(y.origin),this.typeField.invalid&&this.formErrors.push(y.type),this.specialTypeField.invalid&&this.formErrors.push(y.specialType),this.formErrorsOutput.emit(this.formErrors)}loadStates(){this.states=this.cataloguesHttpService.findByType(V.AGREEMENT_STATES_STATE)}loadOrigins(){this.origins=this.cataloguesHttpService.findByType(V.AGREEMENTS_ORIGIN)}loadTypes(){this.types=this.cataloguesHttpService.findByType(V.AGREEMENTS_TYPE)}loadSpecialTypes(){this.specialTypes=this.cataloguesHttpService.findByType(V.AGREEMENTS_SPECIAL_TYPE)}get agreementStateFormField(){return this.form.controls.agreementState}get stateField(){return this.agreementStateFormField.controls.state}get nameField(){return this.form.controls.name}get internalNumberField(){return this.form.controls.internalNumber}get numberField(){return this.form.controls.number}get originField(){return this.form.controls.origin}get typeField(){return this.form.controls.type}get objectiveField(){return this.form.controls.objective}get specialTypeField(){return this.form.controls.specialType}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-basic-data"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:43,vars:51,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-8","xl:col-4"],["appLabel","","for","number",3,"label","required"],[3,"content"],["pInputText","","id","internalNumber","formControlName","number"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-4","xl:col-8"],["appLabel","","for","name",3,"label","required"],["content","Esto es un mensaje de prueba"],["pInputText","","id","name","formControlName","name"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","internalNumber",3,"label","required"],["id","number","formControlName","internalNumber",3,"useGrouping"],["formGroupName","agreementState",1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","state",3,"label","required"],["id","state","formControlName","state","dataKey","id","placeholder","Seleccione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["appLabel","","for","origin",3,"label","required"],["id","origin","formControlName","origin","dataKey","id","placeholder","Selecione",3,"options"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","dataKey","id","placeholder","Selecione",3,"options"],[1,"field","col-12"],["appLabel","","for","objective",3,"label","required"],["pInputTextarea","","id","objective","formControlName","objective","rows","10","cols","30"],[1,"flex","align-items-center","gap-2"],["appLabel","","for","specialType",3,"label","required"],["id","specialType","formControlName","specialType","dataKey","id","placeholder","Selecione",3,"options"]],template:function(s,i){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"app-form-help-field",3)(4,"input",4)(5,"small",5),m(),l(6,"div",6),u(7,"label",7)(8,"app-form-help-field",8)(9,"input",9)(10,"small",5),m(),l(11,"div",10),u(12,"label",11)(13,"app-form-help-field",3)(14,"p-inputNumber",12)(15,"small",5),m(),l(16,"div",13),u(17,"label",14)(18,"app-form-help-field",3),l(19,"p-dropdown",15),g(20,ui,3,1,"ng-template",16)(21,di,3,1,"ng-template",17),m(),u(22,"small",5),m(),l(23,"div",10),u(24,"label",18)(25,"app-form-help-field",3),l(26,"p-dropdown",19),g(27,ci,3,1,"ng-template",16)(28,fi,3,1,"ng-template",17),m(),u(29,"small",5),m(),l(30,"div",10),u(31,"label",20)(32,"app-form-help-field",3),l(33,"p-dropdown",21),g(34,hi,3,1,"ng-template",16)(35,_i,3,1,"ng-template",17),m(),u(36,"small",5),m(),g(37,Ei,7,8,"div",10),l(38,"div",22),u(39,"label",23)(40,"app-form-help-field",8)(41,"textarea",24)(42,"small",5),m()()),s&2&&(r("formGroup",i.form),n(2),r("label",i.AgreementFormEnum.number)("required",i.numberField),n(),r("content",x(46,Yt)),n(2),r("errors",i.numberField.errors)("touched",i.numberField.touched)("dirty",i.numberField.dirty),n(2),r("label",i.AgreementFormEnum.name)("required",i.nameField),n(3),r("errors",i.nameField.errors)("touched",i.nameField.touched)("dirty",i.nameField.dirty),n(2),r("label",i.AgreementFormEnum.internalNumber)("required",i.internalNumberField),n(),r("content",x(47,Yt)),n(),r("useGrouping",!1),n(),r("errors",i.internalNumberField.errors)("touched",i.internalNumberField.touched)("dirty",i.internalNumberField.dirty),n(2),r("label",i.AgreementStateEnum.state)("required",i.stateField),n(),r("content",x(48,Ve)),n(),r("options",i.states),n(3),r("errors",i.stateField.errors)("touched",i.stateField.touched)("dirty",i.stateField.dirty),n(2),r("label",i.AgreementFormEnum.origin)("required",i.originField),n(),r("content",x(49,Ve)),n(),r("options",i.origins),n(3),r("errors",i.originField.errors)("touched",i.originField.touched)("dirty",i.originField.dirty),n(2),r("label",i.AgreementFormEnum.type)("required",i.typeField),n(),r("content",x(50,Ve)),n(),r("options",i.types),n(3),r("errors",i.typeField.errors)("touched",i.typeField.touched)("dirty",i.typeField.dirty),n(),F(37,i.specialTypeField.hasValidator(i.Validators.required)?37:-1),n(2),r("label",i.AgreementFormEnum.objective)("required",i.objectiveField),n(3),r("errors",i.objectiveField.errors)("touched",i.objectiveField.touched)("dirty",i.objectiveField.dirty))},dependencies:[P,Y,O,L,k,M,at,q,U,N,ge,pe,de,ce,he]});let t=a;return t})();var ii=(t,a)=>a.field,qe=()=>({width:"50rem"}),Ue=()=>({"max-height":"150px"});function yi(t,a){if(t&1){let e=v();l(0,"h4"),c(1,"Ministerio de Turismo:"),m(),l(2,"p-button",13),_("click",function(){f(e);let s=p();return h(s.showInternalInstitutionModal())}),m()}if(t&2){let e=p();n(2),r("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Ii(t,a){if(t&1&&(l(0,"th",16),c(1),m()),t&2){let e=a.$implicit;r("pSortableColumn",e.field),n(),w(" ",e.header," ")}}function Ci(t,a){if(t&1&&(l(0,"tr"),R(1,Ii,2,2,"th",16,ii),l(3,"th"),c(4),m()()),t&2){let e=p(3);n(),G(e.internalInstitutionsColumns),n(3),E(e.TableEnum.ACTIONS)}}function xi(t,a){if(t&1&&(l(0,"ul"),c(1),m()),t&2){let e=a.$implicit;n(),w(" ",e.position.name," ")}}function Ti(t,a){if(t&1){let e=v();l(0,"tr")(1,"td"),c(2),m(),l(3,"td"),c(4),m(),l(5,"td"),R(6,xi,2,1,"ul",null,Ee),m(),l(8,"td")(9,"div",17)(10,"p-button",18),_("click",function(){let s=f(e).rowIndex,i=p(3);return h(i.deleteInternalInstitution(s))}),m()()()()}if(t&2){let e=a.$implicit,o=p(3);n(2),E(e.personType.name),n(2),E(e.name),n(2),G(e.internalInstitutionDetails),n(4),r("icon",o.PrimeIcons.TRASH)("severity",o.SeverityButtonActionEnum.DELETE)}}function Di(t,a){if(t&1&&(l(0,"p-table",14),g(1,Ci,5,1,"ng-template",0)(2,Ti,11,4,"ng-template",15),m()),t&2){let e=p(2);r("value",e.formInput.internalInstitutions)("columns",e.internalInstitutionsColumns)}}function Si(t,a){if(t&1&&g(0,Di,3,2,"p-table",14),t&2){let e=p();F(0,e.formInput.internalInstitutions.length>0?0:-1)}}function Ai(t,a){if(t&1){let e=v();l(0,"h4"),c(1,"Contraparte:"),m(),l(2,"p-button",13),_("click",function(){f(e);let s=p();return h(s.showExternalInstitutionModal())}),m()}if(t&2){let e=p();n(2),r("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Vi(t,a){if(t&1&&(l(0,"th",16),c(1),m()),t&2){let e=a.$implicit;r("pSortableColumn",e.field),n(),w(" ",e.header," ")}}function wi(t,a){if(t&1&&(l(0,"tr")(1,"th"),c(2),m(),R(3,Vi,2,2,"th",16,ii),l(5,"th"),c(6),m()()),t&2){let e=a.$implicit,o=p(3);n(2),E(o.TableEnum.ACTIONS),n(),G(e),n(3),E(o.TableEnum.ACTIONS)}}function Ni(t,a){if(t&1){let e=v();l(0,"li",20)(1,"p-button",21),_("click",function(){let s=f(e).$index,i=p().rowIndex,T=p(3);return h(T.deleteExternalInstitutionDetail(i,s))}),m(),l(2,"p-button",19),_("click",function(){let s=f(e).$index,i=p().rowIndex,T=p(3);return h(T.editExternalInstitutionDetail(i,s))}),m(),c(3),m()}if(t&2){let e=a.$implicit,o=p(4);n(),r("icon",o.IconButtonActionEnum.DELETE)("severity",o.SeverityButtonActionEnum.DELETE)("pTooltip",o.LabelButtonActionEnum.DELETE),n(),r("icon",o.IconButtonActionEnum.UPDATE)("severity",o.SeverityButtonActionEnum.UPDATE)("pTooltip",o.LabelButtonActionEnum.UPDATE),n(),$e(" ",e.position," / ",e.unit," ")}}function Bi(t,a){if(t&1){let e=v();l(0,"tr")(1,"td")(2,"div",17)(3,"p-button",19),_("click",function(){let s=f(e).rowIndex,i=p(3);return h(i.deleteExternalInstitution(s))}),m(),l(4,"p-button",19),_("click",function(){let s=f(e).rowIndex,i=p(3);return h(i.editExternalInstitution(s))}),m()()(),l(5,"td"),c(6),m(),l(7,"td"),c(8),m(),l(9,"td")(10,"ul"),R(11,Ni,4,8,"li",20,Ee),m()(),l(13,"td")(14,"p-button",19),_("click",function(){let s=f(e).rowIndex,i=p(3);return h(i.showExternalInstitutionDetailModal(s))}),m()()()}if(t&2){let e=a.$implicit,o=p(3);n(3),r("icon",o.IconButtonActionEnum.DELETE)("severity",o.SeverityButtonActionEnum.DELETE)("pTooltip",o.LabelButtonActionEnum.DELETE),n(),r("icon",o.IconButtonActionEnum.UPDATE)("severity",o.SeverityButtonActionEnum.UPDATE)("pTooltip",o.LabelButtonActionEnum.UPDATE),n(2),E(e.personType.name),n(2),E(e.name),n(3),G(e.externalInstitutionDetails),n(3),r("icon",o.IconButtonActionEnum.ADD)("severity",o.SeverityButtonActionEnum.ADD)("pTooltip",o.LabelButtonActionEnum.ADD)}}function Oi(t,a){if(t&1&&(l(0,"p-table",14),g(1,wi,7,2,"ng-template",0)(2,Bi,15,11,"ng-template",15),m()),t&2){let e=p(2);r("value",e.formInput.externalInstitutions)("columns",e.externalInstitutionsColumns)}}function Li(t,a){if(t&1&&g(0,Oi,3,2,"p-table",14),t&2){let e=p();F(0,e.formInput.externalInstitutions.length>0?0:-1)}}function Pi(t,a){if(t&1){let e=v();l(0,"p-button",22),_("click",function(){f(e);let s=p();return h(s.isVisibleInternalInstitutionForm=!1)}),m(),l(1,"p-button",23),_("click",function(){f(e);let s=p();return h(s.addInternalInstitution())}),m()}if(t&2){let e=p();r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),n(),r("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function ki(t,a){if(t&1&&(l(0,"form",3)(1,"div",4),u(2,"label",24)(3,"input",25)(4,"small",7),m(),l(5,"div",4),u(6,"label",26)(7,"p-listbox",27)(8,"small",7),m()(),l(9,"form",3)(10,"div",28),u(11,"label",29)(12,"input",30)(13,"small",7),m(),l(14,"div",28),u(15,"label",31)(16,"input",32)(17,"small",7),m()()),t&2){let e=p();r("formGroup",e.externalInstitutionForm),n(2),r("label",e.ExternalInstitutionsFormEnum.name)("required",e.externalInstitutionNameField),n(2),r("errors",e.externalInstitutionNameField.errors)("touched",e.externalInstitutionNameField.touched)("dirty",e.externalInstitutionNameField.dirty),n(2),r("label",e.ExternalInstitutionsFormEnum.personType)("required",e.externalInstitutionPersonTypeField),n(),r("options",e.externalPersonTypes)("filter",!0)("listStyle",x(25,Ue)),n(),r("errors",e.externalInstitutionPersonTypeField.errors)("touched",e.externalInstitutionPersonTypeField.touched)("dirty",e.externalInstitutionPersonTypeField.dirty),n(),r("formGroup",e.externalInstitutionDetailForm),n(2),r("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),n(2),r("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),n(2),r("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),n(2),r("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function Mi(t,a){if(t&1){let e=v();l(0,"div",17)(1,"p-button",19),_("click",function(){f(e);let s=p(2);return h(s.updateExternalInstitution())}),m(),l(2,"p-button",22),_("click",function(){f(e);let s=p(2);return h(s.cancelEdit())}),m()()}if(t&2){let e=p(2);n(),r("icon",e.IconButtonActionEnum.UPDATE)("severity",e.SeverityButtonActionEnum.UPDATE)("pTooltip",e.LabelButtonActionEnum.UPDATE),n(),r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL)}}function qi(t,a){if(t&1){let e=v();l(0,"p-button",22),_("click",function(){f(e);let s=p(2);return h(s.isVisibleExternalInstitutionForm=!1)}),m(),l(1,"p-button",23),_("click",function(){f(e);let s=p(2);return h(s.addExternalInstitution())}),m()}if(t&2){let e=p(2);r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),n(),r("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)("label",e.LabelButtonActionEnum.ADD)}}function Ui(t,a){if(t&1&&g(0,Mi,3,7,"div",17)(1,qi,2,7),t&2){let e=p();F(0,e.isEditing?0:1)}}function Ri(t,a){if(t&1&&(l(0,"form",3)(1,"div",4),u(2,"label",33)(3,"input",34)(4,"small",7),m(),l(5,"div",4),u(6,"label",35)(7,"input",36)(8,"small",7),m()()),t&2){let e=p();r("formGroup",e.externalInstitutionDetailForm),n(2),r("label",e.ExternalInstitutionsFormEnum.position)("required",e.externalInstitutionDetailPositionField),n(2),r("errors",e.externalInstitutionDetailPositionField.errors)("touched",e.externalInstitutionDetailPositionField.touched)("dirty",e.externalInstitutionDetailPositionField.dirty),n(2),r("label",e.ExternalInstitutionsFormEnum.unit)("required",e.externalInstitutionDetailUnitField),n(2),r("errors",e.externalInstitutionDetailUnitField.errors)("touched",e.externalInstitutionDetailUnitField.touched)("dirty",e.externalInstitutionDetailUnitField.dirty)}}function Gi(t,a){if(t&1){let e=v();l(0,"div",17)(1,"p-button",19),_("click",function(){f(e);let s=p(2);return h(s.updateExternalInstitutionDetail())}),m(),l(2,"p-button",22),_("click",function(){f(e);let s=p(2);return h(s.cancelEditDetail())}),m()()}if(t&2){let e=p(2);n(),r("icon",e.IconButtonActionEnum.UPDATE)("severity",e.SeverityButtonActionEnum.UPDATE)("pTooltip",e.LabelButtonActionEnum.UPDATE),n(),r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL)}}function Hi(t,a){if(t&1){let e=v();l(0,"p-button",22),_("click",function(){f(e);let s=p(2);return h(s.isVisibleExternalInstitutionDetailForm=!1)}),m(),l(1,"p-button",37),_("click",function(){f(e);let s=p(2);return h(s.addExternalInstitutionDetail())}),m()}if(t&2){let e=p(2);r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),n(),r("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function ji(t,a){if(t&1&&g(0,Gi,3,7,"div",17)(1,Hi,2,7),t&2){let e=p();F(0,e.isEditingDetail?0:1)}}var ni=(()=>{let a=class a{constructor(){this.authService=b(se),this.cataloguesHttpService=b(B),this.coreService=b($),this.formBuilder=b(A),this.messageDialogService=b(S),this.formInput=ae(),this.formOutput=new C,this.formErrorsOutput=new C,this.id=Ze.NEW,this.externalInstitutionsColumns=[],this.internalInstitutionsColumns=[],this.formErrors=[],this.isVisibleExternalInstitutionDetailForm=!1,this.isVisibleInternalInstitutionForm=!1,this.isVisibleExternalInstitutionForm=!1,this.index=-1,this.isEditing=!1,this.isEditingDetail=!1,this.detailIndex=-1,this.internalPersonTypes=[],this.externalPersonTypes=[],this.positions=[],this.ExternalInstitutionsFormEnum=H,this.InternalInstitutionsFormEnum=re,this.SkeletonEnum=z,this.PrimeIcons=j,this.SeverityButtonActionEnum=W,this.LabelButtonActionEnum=ee,this.IconButtonActionEnum=te,this.AgreementFormEnum=y,this.TableEnum=le,this.buildForm(),this.buildExternalInstitutionForm(),this.buildInternalInstitutionForm(),this.buildExternalInstitutionDetailForm(),this.buildInternalInstitutionDetailForm(),this.buildExternalInstitutionsColumns(),this.buildInternalInstitutionsColumns(),this.checkValueChanges()}ngOnInit(){this.loadInternalPersonTypes(),this.loadExternalPersonTypes(),this.loadPositions(),this.patchValueForm(),this.validateForm()}buildForm(){this.form=this.formBuilder.group({internalInstitutions:this.formBuilder.array([],d.required),externalInstitutions:this.formBuilder.array([],d.required)})}patchValueForm(){this.form.patchValue(this.formInput)}checkValueChanges(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(this.formInput),this.validateForm()})}validateForm(){this.formErrors=[],this.formInput.internalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Mintur"),this.formInput.externalInstitutions?.length===0&&this.formErrors.push("Comparecientes - Contraparte"),this.formErrorsOutput.emit(this.formErrors)}buildInternalInstitutionForm(){this.internalInstitutionForm=this.formBuilder.group({name:["Ministerio de Turismo"],personType:[null,[d.required]]})}buildInternalInstitutionDetailForm(){this.internalInstitutionDetailForm=this.formBuilder.group({position:[null,[d.required]],unit:[null]})}buildExternalInstitutionForm(){this.externalInstitutionForm=this.formBuilder.group({personType:[null,[d.required]],name:[null,[d.required,d.pattern(be())]]})}buildExternalInstitutionDetailForm(){this.externalInstitutionDetailForm=this.formBuilder.group({position:[null,[d.required]],unit:[null,[d.required,d.pattern(be())]]})}buildInternalInstitutionsColumns(){this.internalInstitutionsColumns=[{field:"personType",header:re.personType},{field:"name",header:re.name},{field:"position",header:re.position}]}buildExternalInstitutionsColumns(){this.externalInstitutionsColumns=[{field:"personType",header:H.personType},{field:"name",header:H.name},{field:"position",header:H.position}]}addInternalInstitution(){this.validateInternalInstitutionForm()&&this.validateInternalInstitutionDetailForm()?(this.formInput.internalInstitutions.push(this.internalInstitutionForm.value),this.form.patchValue(this.formInput),this.index=this.formInput.internalInstitutions.length-1,this.addInternalInstitutionDetail(),this.internalInstitutionPersonTypeField.reset(),this.isVisibleInternalInstitutionForm=!1):(this.internalInstitutionForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addInternalInstitutionDetail(){this.validateInternalInstitutionDetailForm()?(this.formInput?.internalInstitutions&&(this.formInput?.internalInstitutions[this.index].internalInstitutionDetails?this.formInput.internalInstitutions[this.index].internalInstitutionDetails.push(this.internalInstitutionDetailForm.value):this.formInput.internalInstitutions[this.index].internalInstitutionDetails=[this.internalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.internalInstitutionDetailPositionField.reset()):(this.internalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitution(){this.validateExternalInstitutionForm()&&this.validateExternalInstitutionDetailForm()?(this.formInput.externalInstitutions.push(this.externalInstitutionForm.value),this.form.patchValue(this.formInput),this.index=this.formInput.externalInstitutions.length-1,this.addExternalInstitutionDetail(),this.externalInstitutionForm.reset(),this.isVisibleExternalInstitutionForm=!1):(this.externalInstitutionForm.markAllAsTouched(),this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}addExternalInstitutionDetail(){this.validateExternalInstitutionDetailForm()?(this.formInput?.externalInstitutions&&(this.formInput?.externalInstitutions[this.index].externalInstitutionDetails?this.formInput.externalInstitutions[this.index].externalInstitutionDetails.push(this.externalInstitutionDetailForm.value):this.formInput.externalInstitutions[this.index].externalInstitutionDetails=[this.externalInstitutionDetailForm.value]),this.form.patchValue(this.formInput),this.isVisibleExternalInstitutionDetailForm=!1,this.externalInstitutionDetailForm.reset()):(this.externalInstitutionDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}showExternalInstitutionModal(){this.isVisibleExternalInstitutionForm=!0}showExternalInstitutionDetailModal(o){this.isVisibleExternalInstitutionDetailForm=!0,this.index=o}deleteExternalInstitution(o){if(this.formInput.obligations.some(s=>s.institutionName===this.formInput.externalInstitutions[o].name)){this.messageDialogService.errorCustom("Existe obligaciones asignadas","Por favor elimine primero las obligaciones");return}if(this.formInput.financings.some(s=>s.institutionName===this.formInput.externalInstitutions[o].name)){this.messageDialogService.errorCustom("Existe financiamientos asignados","Por favor elimine primero los financiamientos");return}this.formInput.externalInstitutions.splice(o,1),this.form.patchValue(this.formInput)}deleteInternalInstitutionDetail(o,s){this.formInput.internalInstitutions[o].internalInstitutionDetails.splice(s,1)}deleteInternalInstitution(o){this.formInput.internalInstitutions.splice(o,1),this.form.patchValue(this.formInput)}deleteExternalInstitutionDetail(o,s){this.formInput.externalInstitutions[o].externalInstitutionDetails.splice(s,1),this.formInput.externalInstitutions[o].externalInstitutionDetails.length===0&&this.formInput.externalInstitutions.splice(o,1)}editExternalInstitution(o){if(this.formInput.externalInstitutions&&o>=0&&o<this.formInput.externalInstitutions.length){let s=this.formInput.externalInstitutions[o];s&&(this.externalInstitutionForm.patchValue({name:s.name,personType:s.personType}),this.index=o,this.isEditing=!0,this.isVisibleExternalInstitutionForm=!0)}else console.error("no vale")}updateExternalInstitution(){this.formInput.externalInstitutions&&Array.isArray(this.formInput.externalInstitutions)&&this.index>=0&&this.index<this.formInput.externalInstitutions.length?(this.formInput.externalInstitutions[this.index]=Ne(Ne({},this.formInput.externalInstitutions[this.index]),this.externalInstitutionForm.value),this.externalInstitutionForm.reset(),this.isEditing=!1,this.isVisibleExternalInstitutionForm=!1,this.form.patchValue(this.formInput)):console.error("no vale")}cancelEdit(){this.externalInstitutionForm.reset(),this.isEditing=!1,this.index=-1,this.isVisibleExternalInstitutionForm=!1}editExternalInstitutionDetail(o,s){if(this.formInput?.externalInstitutions&&o>=0&&o<this.formInput.externalInstitutions.length&&this.formInput.externalInstitutions[o]?.externalInstitutionDetails&&s>=0&&s<this.formInput.externalInstitutions[o].externalInstitutionDetails.length){let i=this.formInput.externalInstitutions[o].externalInstitutionDetails[s];this.externalInstitutionDetailForm.patchValue(i),this.index=o,this.detailIndex=s,this.isEditingDetail=!0,this.isVisibleExternalInstitutionDetailForm=!0}else console.error("no vale")}updateExternalInstitutionDetail(){if(this.formInput?.externalInstitutions&&this.index>=0&&this.index<this.formInput.externalInstitutions.length&&this.formInput.externalInstitutions[this.index]?.externalInstitutionDetails){let o=this.formInput.externalInstitutions[this.index].externalInstitutionDetails;this.detailIndex>=0&&this.detailIndex<o.length&&(o[this.detailIndex]=this.externalInstitutionDetailForm.value,this.form.patchValue(this.formInput)),this.isEditingDetail=!1,this.isVisibleExternalInstitutionDetailForm=!1,this.externalInstitutionDetailForm.reset()}else console.error("error")}cancelEditDetail(){this.isEditingDetail=!1,this.isVisibleExternalInstitutionDetailForm=!1,this.externalInstitutionDetailForm.reset()}validateExternalInstitutionForm(){return this.formErrors=[],this.externalInstitutionNameField.invalid&&this.formErrors.push(H.name),this.externalInstitutionPersonTypeField.invalid&&this.formErrors.push(H.personType),this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(H.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(H.position),this.formInput.externalInstitutions&&this.formInput.externalInstitutions?.findIndex(o=>o.name===this.externalInstitutionNameField.value)>-1&&this.formErrors.push("Ya existe la instituci\xF3n"),this.formErrors.length===0}validateExternalInstitutionDetailForm(){return this.formErrors=[],this.externalInstitutionDetailUnitField.invalid&&this.formErrors.push(H.unit),this.externalInstitutionDetailPositionField.invalid&&this.formErrors.push(H.position),this.formErrors.length===0}validateInternalInstitutionForm(){return this.formErrors=[],this.internalInstitutionPersonTypeField.invalid&&this.formErrors.push(re.personType),this.formErrors.length===0}validateInternalInstitutionDetailForm(){return this.formErrors=[],this.internalInstitutionDetailPositionField.invalid&&this.formErrors.push(re.position),this.internalInstitutionDetailForm.valid&&this.formErrors.length===0}loadInternalPersonTypes(){this.internalPersonTypes=this.cataloguesHttpService.findByType(V.INTERNAL_INSTITUTIONS_PERSON_TYPE)}loadExternalPersonTypes(){this.externalPersonTypes=this.cataloguesHttpService.findByType(V.EXTERNAL_INSTITUTIONS_PERSON_TYPE)}loadPositions(){this.positions=this.cataloguesHttpService.findByType(V.INTERNAL_INSTITUTIONS_POSITION),this.internalInstitutionPersonTypeField.patchValue(this.internalPersonTypes.find(o=>o.code===tt.PUBLIC))}save(){this.formOutput.emit(this.form.value)}showInternalInstitutionModal(){if(this.formInput.internalInstitutions.length>0){this.messageDialogService.errorCustom("No puede agregar","Solo se puede agregar 1 cargo");return}this.isVisibleInternalInstitutionForm=!0}get internalInstitutionsField(){return this.form.get("internalInstitutions")}get externalInstitutionsField(){return this.form.get("externalInstitutions")}get internalInstitutionPersonTypeField(){return this.internalInstitutionForm.controls.personType}get internalInstitutionDetailPositionField(){return this.internalInstitutionDetailForm.controls.position}get externalInstitutionNameField(){return this.externalInstitutionForm.controls.name}get externalInstitutionPersonTypeField(){return this.externalInstitutionForm.controls.personType}get externalInstitutionDetailUnitField(){return this.externalInstitutionDetailForm.controls.unit}get externalInstitutionDetailPositionField(){return this.externalInstitutionDetailForm.controls.position}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-appearer"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:24,vars:36,consts:[["pTemplate","header"],["pTemplate","content"],["header","Agregar",3,"visibleChange","visible","modal","maximizable"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","internalPosition",3,"label","required"],["id","internalPosition","formControlName","position","optionLabel","name",3,"options","filter","listStyle"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","internalPersonType",3,"label","required"],["id","internalPersonType","formControlName","personType","optionLabel","name",3,"options","filter","listStyle"],["pTemplate","footer"],["header","Agregar",3,"visibleChange","visible","modal"],["header","Contraparte",3,"visibleChange","visible","modal"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"button-group"],[3,"click","icon","severity"],[3,"click","icon","severity","pTooltip"],[1,"mt-1"],[1,"ml-1",3,"click","icon","severity","pTooltip"],[3,"click","label","icon","text","severity"],[3,"click","icon","severity","label"],["appLabel","","for","name",3,"label","required"],["pInputText","","id","name","formControlName","name"],["appLabel","","for","externalPersonType",3,"label","required"],["id","externalPersonType","formControlName","personType","optionLabel","name",3,"options","filter","listStyle"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","externalPosition2",3,"label","required"],["pInputText","","id","externalPosition2","formControlName","position"],["appLabel","","for","unit2",3,"label","required"],["pInputText","","id","unit2","formControlName","unit"],["appLabel","","for","externalPosition1",3,"label","required"],["pInputText","","id","externalPosition1","formControlName","position"],["appLabel","","for","unit1",3,"label","required"],["pInputText","","id","unit1","formControlName","unit"],[3,"click","label","icon","severity"]],template:function(s,i){s&1&&(l(0,"p-panel"),g(1,yi,3,3,"ng-template",0)(2,Si,1,1,"ng-template",1),m(),l(3,"p-panel"),g(4,Ai,3,3,"ng-template",0)(5,Li,1,1,"ng-template",1),m(),l(6,"p-dialog",2),Z("visibleChange",function(I){return Q(i.isVisibleInternalInstitutionForm,I)||(i.isVisibleInternalInstitutionForm=I),I}),l(7,"form",3)(8,"div",4),u(9,"label",5)(10,"p-listbox",6)(11,"small",7),m()(),l(12,"form",3)(13,"div",4),u(14,"label",8)(15,"p-listbox",9)(16,"small",7),m()(),g(17,Pi,2,7,"ng-template",10),m(),l(18,"p-dialog",11),Z("visibleChange",function(I){return Q(i.isVisibleExternalInstitutionForm,I)||(i.isVisibleExternalInstitutionForm=I),I}),g(19,ki,18,26,"ng-template",1)(20,Ui,2,1,"ng-template",10),m(),l(21,"p-dialog",12),Z("visibleChange",function(I){return Q(i.isVisibleExternalInstitutionDetailForm,I)||(i.isVisibleExternalInstitutionDetailForm=I),I}),g(22,Ri,9,11,"ng-template",1)(23,ji,2,1,"ng-template",10),m()),s&2&&(n(6),J(x(31,qe)),X("visible",i.isVisibleInternalInstitutionForm),r("modal",!0)("maximizable",!0),n(),r("formGroup",i.internalInstitutionDetailForm),n(2),r("label",i.InternalInstitutionsFormEnum.position)("required",i.internalInstitutionDetailPositionField),n(),r("options",i.positions)("filter",!0)("listStyle",x(32,Ue)),n(),r("errors",i.internalInstitutionDetailPositionField.errors)("touched",i.internalInstitutionDetailPositionField.touched)("dirty",i.internalInstitutionDetailPositionField.dirty),n(),r("formGroup",i.internalInstitutionForm),n(2),r("label",i.InternalInstitutionsFormEnum.personType)("required",i.internalInstitutionPersonTypeField),n(),r("options",i.internalPersonTypes)("filter",!0)("listStyle",x(33,Ue)),n(),r("errors",i.internalInstitutionPersonTypeField.errors)("touched",i.internalInstitutionPersonTypeField.touched)("dirty",i.internalInstitutionPersonTypeField.dirty),n(2),J(x(34,qe)),X("visible",i.isVisibleExternalInstitutionForm),r("modal",!0),n(3),J(x(35,qe)),X("visible",i.isVisibleExternalInstitutionDetailForm),r("modal",!0))},dependencies:[P,Y,O,L,k,M,q,U,me,N,ie,pe,ue,ne,fe,_e,Se],styles:[".text-center[_ngcontent-%COMP%]{text-align:center}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:.5rem}.button-adjustment[_ngcontent-%COMP%]{margin-top:11px}"]});let t=a;return t})();var Wi=()=>({width:"50%"});function zi(t,a){if(t&1&&(l(0,"div",21)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e==null?null:e.name)}}function Ki(t,a){if(t&1&&(l(0,"div",21)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e==null?null:e.name)}}function Yi(t,a){if(t&1&&u(0,"label",8),t&2){let e=p();r("label",e.ObligationForEnum.institutionName)("required",e.obligationInstitutionNameField)}}function Ji(t,a){if(t&1&&(l(0,"div",21)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e==null?null:e.name)}}function Xi(t,a){if(t&1&&(l(0,"div",21)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e==null?null:e.name)}}function Qi(t,a){if(t&1&&(l(0,"p-dropdown",9),g(1,Ji,3,1,"ng-template",5)(2,Xi,3,1,"ng-template",6),m()),t&2){let e=p();r("options",e.institutions)("filter",!1)}}function Zi(t,a){if(t&1&&u(0,"p-multiSelect",10),t&2){let e=p();r("options",e.institutions)}}function en(t,a){t&1&&(l(0,"tr")(1,"th"),c(2,"Entidad"),m(),l(3,"th"),c(4,"Tipo de Obligaci\xF3n"),m(),l(5,"th"),c(6,"Descripci\xF3n"),m(),l(7,"th"),c(8,"Acciones"),m()())}function tn(t,a){if(t&1&&(l(0,"li"),c(1),m()),t&2){let e=a.$implicit;n(),E(e.description)}}function nn(t,a){if(t&1){let e=v();l(0,"tr")(1,"td"),c(2),m(),l(3,"td"),c(4),m(),l(5,"td")(6,"ul"),R(7,tn,2,1,"li",null,Ee),m()(),l(9,"td")(10,"p-button",24),_("click",function(){let s=f(e).rowIndex,i=p(2);return h(i.deleteObligation(s))}),m(),l(11,"p-button",24),_("click",function(){let s=f(e).rowIndex,i=p(2);return h(i.showObligationDetailModal(s))}),m()()()}if(t&2){let e=a.$implicit,o=p(2);n(2),E(e.institutionName),n(2),E(e.type==null?null:e.type.name),n(3),G(e.obligationDetails),n(3),r("icon",o.IconButtonActionEnum.DELETE)("severity",o.SeverityButtonActionEnum.DELETE),n(),r("icon",o.IconButtonActionEnum.ADD)("severity",o.SeverityButtonActionEnum.ADD)}}function on(t,a){if(t&1&&(l(0,"p-table",17),g(1,en,9,0,"ng-template",22)(2,nn,12,6,"ng-template",23),m()),t&2){let e=p();r("value",e.agreement.obligations)("columns",e.columns)("loading",e.coreService.isLoading)}}var we=(()=>{let a=class a{constructor(){this.formBuilder=b(A),this.messageDialogService=b(S),this.formOutput=new C,this.formErrorsOutput=new C,this.nextOutput=new C,this.prevOutput=new C,this.cataloguesHttpService=b(B),this.coreService=b($),this.obligationTypes=[],this.institutions=[],this.SkeletonEnum=z,this.SeverityButtonActionEnum=W,this.PrimeIcons=j,this.formErrors=[],this.IconButtonActionEnum=te,this.LabelButtonActionEnum=ee,this.isVisibleObligationDetailForm=!1,this.ObligationForEnum=De,this.ObligationDetailForEnum=it,this.columns=[],this.index=-1,this.CatalogueObligationsTypeEnum=Oe,this.buildForm(),this.buildObligationForm(),this.buildObligationDetailForm(),this.buildColumns(),this.checkValueChanges()}ngOnInit(){this.loadObligationTypes(),this.loadInstitutions(),this.patchValueForm()}buildColumns(){this.columns=[{field:"institutionName",header:De.institutionName},{field:"type",header:De.type}]}buildForm(){this.form=this.formBuilder.group({obligations:this.formBuilder.array([])})}buildObligationForm(){this.obligationForm=this.formBuilder.group({institutionName:[null,[d.required]],type:[null,[d.required]]})}buildObligationDetailForm(){this.obligationDetailForm=this.formBuilder.group({description:[null,[d.required]]})}patchValueForm(){this.agreement=this.formInput,this.form.patchValue(this.agreement)}checkValueChanges(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(this.agreement)}),this.obligationTypeField.valueChanges.subscribe(o=>{o&&o.code===Oe.INTERNAL&&this.formInput.internalInstitutions&&this.obligationInstitutionNameField.setValue(this.formInput.internalInstitutions[0].name)})}validateObligationForm(){return this.formErrors=[],this.obligationTypeField.invalid&&this.formErrors.push(this.ObligationForEnum.type),this.obligationInstitutionNameField.invalid&&this.formErrors.push(this.ObligationForEnum.institutionName),this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}validateObligationDetailForm(){return this.formErrors=[],this.obligationDetailDescriptionField.invalid&&this.formErrors.push(this.ObligationDetailForEnum.description),this.formErrors.length===0}loadObligationTypes(){this.obligationTypes=this.cataloguesHttpService.findByType(V.OBLIGATIONS_TYPE)}loadInstitutions(){this.institutions=[],this.formInput.internalInstitutions&&(this.institutions=this.formInput.internalInstitutions),this.formInput.externalInstitutions&&(this.institutions=this.formInput.externalInstitutions)}addObligation(){if(this.validateObligationForm()){let o=this.obligationForm.value;if(o.obligationDetails=[this.obligationDetailForm.value],!this.agreement.obligations)this.agreement.obligations=[];else if(this.agreement.obligations.findIndex(s=>{s.institutionName,o.institutionName.toString()})>-1){this.messageDialogService.errorCustom("La entidad ya est\xE1 registrada","Intente con otra por favor");return}this.agreement.obligations.push(o),this.form.patchValue({obligations:this.agreement.obligations}),this.obligationForm.reset(),this.obligationDetailForm.reset()}else this.obligationForm.markAllAsTouched(),this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}addObligationDetail(){this.validateObligationDetailForm()?(this.agreement.obligations&&(this.agreement.obligations[this.index].obligationDetails?this.agreement.obligations[this.index].obligationDetails?.push(this.obligationDetailDescriptionField.value):this.agreement.obligations[this.index].obligationDetails=[this.obligationDetailDescriptionField.value]),this.form.patchValue(this.agreement),this.obligationForm.reset(),this.obligationDetailDescriptionField.reset(),this.isVisibleObligationDetailForm=!1):(this.obligationDetailForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}deleteObligation(o){this.form.get("obligations").removeAt(o),this.agreement.obligations?.splice(o,1),this.form.patchValue({obligations:this.agreement.obligations})}showObligationDetailModal(o){this.isVisibleObligationDetailForm=!0,this.index=o}get obligationInstitutionNameField(){return this.obligationForm.controls.institutionName}get obligationTypeField(){return this.obligationForm.controls.type}get obligationDetailDescriptionField(){return this.obligationDetailForm.controls.description}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-obligation"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput",nextOutput:"nextOutput",prevOutput:"prevOutput"},decls:31,vars:41,consts:[[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","type",3,"label","required"],["content","Esto es un mensaje de prueba"],["id","type","formControlName","type","dataKey","id","placeholder","Seleccione",3,"options","filter"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","institutionName",3,"label","required"],["id","institutionName","formControlName","institutionName","dataKey","id","placeholder","Seleccione","optionValue","name",3,"options","filter"],["formControlName","institutionName","optionLabel","name","optionValue","name","placeholder","Select Institutions",3,"options"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],[3,"formGroup"],["appLabel","","for","description",3,"label","required"],["pInputTextarea","","id","description","formControlName","description"],[1,"field","col-12","xl:col-2","lg:col-2","md:col-2","sm:col-12"],[3,"click","icon","label","severity"],["dataKey","id","styleClass","p-datatable-striped",3,"value","columns","loading"],["header","Agregar Detalle de Obligaci\xF3n",3,"visibleChange","visible","modal"],["appLabel","","for","descriptionEdit",3,"label","required"],["pInputTextarea","","id","descriptionEdit","formControlName","description"],[1,"flex","align-items-center","gap-2"],["pTemplate","header"],["pTemplate","body"],[3,"click","icon","severity"]],template:function(s,i){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"app-form-help-field",3),l(4,"p-dropdown",4),g(5,zi,3,1,"ng-template",5)(6,Ki,3,1,"ng-template",6),m(),u(7,"small",7),m(),l(8,"div",1),c(9),We(10,"json"),g(11,Yi,1,2,"label",8)(12,Qi,3,2,"p-dropdown",9)(13,Zi,1,1,"p-multiSelect",10),u(14,"small",7),m(),l(15,"div",11)(16,"form",12),u(17,"label",13)(18,"textarea",14)(19,"small",7),m()(),l(20,"div",15)(21,"p-button",16),_("click",function(){return i.addObligation()}),m()()(),g(22,on,3,3,"p-table",17),l(23,"p-dialog",18),Z("visibleChange",function(I){return Q(i.isVisibleObligationDetailForm,I)||(i.isVisibleObligationDetailForm=I),I}),l(24,"form",0)(25,"div",11),u(26,"label",19)(27,"textarea",20)(28,"small",7),m(),l(29,"div",11)(30,"p-button",16),_("click",function(){return i.addObligationDetail()}),m()()()()),s&2&&(r("formGroup",i.obligationForm),n(2),r("label",i.ObligationForEnum.type)("required",i.obligationTypeField),n(2),r("options",i.obligationTypes)("filter",!1),n(3),r("errors",i.obligationTypeField.errors)("touched",i.obligationTypeField.touched)("dirty",i.obligationTypeField.dirty),n(2),w(" ",ze(10,38,i.obligationInstitutionNameField.value)," "),n(2),F(11,i.obligationTypeField.value&&(i.obligationTypeField.value.code===i.CatalogueObligationsTypeEnum.EXTERNAL||i.obligationTypeField.value.code===i.CatalogueObligationsTypeEnum.JOIN)?11:-1),n(),F(12,i.obligationTypeField.value&&i.obligationTypeField.value.code===i.CatalogueObligationsTypeEnum.EXTERNAL?12:-1),n(),F(13,i.obligationTypeField.value&&i.obligationTypeField.value.code===i.CatalogueObligationsTypeEnum.JOIN?13:-1),n(),r("errors",i.obligationInstitutionNameField.errors)("touched",i.obligationInstitutionNameField.touched)("dirty",i.obligationInstitutionNameField.dirty),n(2),r("formGroup",i.obligationDetailForm),n(),r("label",i.ObligationDetailForEnum.description)("required",i.obligationDetailDescriptionField),n(2),r("errors",i.obligationDetailDescriptionField.errors)("touched",i.obligationDetailDescriptionField.touched)("dirty",i.obligationDetailDescriptionField.dirty),n(2),r("icon",i.IconButtonActionEnum.ADD)("label",i.LabelButtonActionEnum.ADD)("severity",i.SeverityButtonActionEnum.ADD),n(),F(22,i.agreement.obligations&&i.agreement.obligations.length>0?22:-1),n(),J(x(40,Wi)),X("visible",i.isVisibleObligationDetailForm),r("modal",!0),n(),r("formGroup",i.obligationDetailForm),n(2),r("label",i.ObligationDetailForEnum.description)("required",i.obligationDetailDescriptionField),n(2),r("errors",i.obligationDetailDescriptionField.errors)("touched",i.obligationDetailDescriptionField.touched)("dirty",i.obligationDetailDescriptionField.dirty),n(2),r("icon",i.IconButtonActionEnum.ADD)("label",i.LabelButtonActionEnum.ADD)("severity",i.SeverityButtonActionEnum.ADD))},dependencies:[P,Y,O,L,k,M,q,U,N,ge,ie,de,ne,he,Mt,_e,Ke]});let t=a;return t})();var an=(t,a)=>a.field,ln=()=>({width:"50rem"}),sn=()=>({"max-height":"150px"});function mn(t,a){if(t&1){let e=v();l(0,"p-button",9),_("click",function(){f(e);let s=p(3);return h(s.showFinancingModal())}),m()}if(t&2){let e=p(3);r("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function pn(t,a){if(t&1&&(l(0,"h4"),c(1),m(),g(2,mn,1,3,"p-button",8)),t&2){let e=p(2);n(),w("",e.FinancingsFormEnum.header,":"),n(),F(2,e.isFinancingField.value?2:-1)}}function un(t,a){if(t&1&&(l(0,"th",12),c(1),m()),t&2){let e=a.$implicit;r("pSortableColumn",e.field),n(),w(" ",e.header," ")}}function dn(t,a){if(t&1&&(l(0,"tr"),R(1,un,2,2,"th",12,an),l(3,"th",13),c(4),m()()),t&2){let e=a.$implicit,o=p(4);n(),G(e),n(3),w(" ",o.TableEnum.ACTIONS," ")}}function cn(t,a){if(t&1){let e=v();l(0,"tr")(1,"td"),c(2),m(),l(3,"td"),c(4),m(),l(5,"td"),c(6),m(),l(7,"td"),c(8),m(),l(9,"td")(10,"p-button",14),_("click",function(){let s=f(e).rowIndex,i=p(4);return h(i.deleteFinancing(s))}),m()()()}if(t&2){let e=a.$implicit,o=p(4);n(2),E(e.institutionName),n(2),E(e.budget),n(2),E(e.paymentMethod),n(2),E(e.source),n(2),r("icon",o.IconButtonActionEnum.DELETE)("severity",o.SeverityButtonActionEnum.DELETE)("pTooltip",o.LabelButtonActionEnum.DELETE)}}function fn(t,a){if(t&1&&(l(0,"p-table",10),g(1,dn,5,1,"ng-template",7)(2,cn,11,7,"ng-template",11),m()),t&2){let e=p(3);r("value",e.formInput.financings)("columns",e.financingsColumns)}}function hn(t,a){if(t&1&&g(0,fn,3,2,"p-table",10),t&2){let e=p(2);F(0,e.isFinancingField.value&&e.formInput.financings.length>0?0:-1)}}function _n(t,a){t&1&&(l(0,"p-panel"),g(1,pn,3,2,"ng-template",7)(2,hn,1,1,"ng-template",5),m())}function gn(t,a){if(t&1&&(l(0,"form",15)(1,"div",16),u(2,"label",17)(3,"p-inputNumber",18)(4,"small",19),m(),l(5,"div",16),u(6,"label",20)(7,"input",21)(8,"small",19),m(),l(9,"div",16),u(10,"label",22)(11,"input",23)(12,"small",19),m(),l(13,"div",1),u(14,"label",24)(15,"p-listbox",25)(16,"small",19),m()()),t&2){let e=p();r("formGroup",e.financingForm),n(2),r("label",e.FinancingsFormEnum.budget)("required",e.budgetField),n(),r("minFractionDigits",2)("maxFractionDigits",2),n(),r("errors",e.budgetField.errors)("touched",e.budgetField.touched)("dirty",e.budgetField.dirty),n(2),r("label",e.FinancingsFormEnum.paymentMethod)("required",e.paymentMethodField),n(2),r("errors",e.paymentMethodField.errors)("touched",e.paymentMethodField.touched)("dirty",e.paymentMethodField.dirty),n(2),r("label",e.FinancingsFormEnum.source)("required",e.sourceField),n(2),r("errors",e.sourceField.errors)("touched",e.sourceField.touched)("dirty",e.sourceField.dirty),n(2),r("label",e.FinancingsFormEnum.institutionName)("required",e.institutionNameField),n(),r("options",e.combinedInstitutions)("filter",!0)("listStyle",x(26,sn)),n(),r("errors",e.institutionNameField.errors)("touched",e.institutionNameField.touched)("dirty",e.institutionNameField.dirty)}}function bn(t,a){if(t&1){let e=v();l(0,"p-button",26),_("click",function(){f(e);let s=p();return h(s.isVisibleFinancingForm=!1)}),m(),l(1,"p-button",27),_("click",function(){f(e);let s=p();return h(s.addFinancing())}),m()}if(t&2){let e=p();r("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),n(),r("label",e.LabelButtonActionEnum.ADD)("icon",e.IconButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}var oi=(()=>{let a=class a{constructor(){this.authService=b(se),this.cataloguesHttpService=b(B),this.coreService=b($),this.formBuilder=b(A),this.messageDialogService=b(S),this.financingsColumns=[],this.formInput=ae(),this.formOutput=new C,this.formErrorsOutput=new C,this.formErrors=[],this.combinedInstitutions=[],this.AgreementFormEnum=y,this.SeverityButtonActionEnum=W,this.IconButtonActionEnum=te,this.LabelButtonActionEnum=ee,this.FinancingsFormEnum=K,this.SkeletonEnum=z,this.TableEnum=le,this.isVisibleFinancingForm=!1,this.buildForm(),this.buildFinancingForm(),this.buildFinancingsColumns(),this.checkValueChanges()}ngOnInit(){this.loadCombineInstitutions(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({isFinancing:[null,[d.required]],financings:this.formBuilder.array([],d.required)})}buildFinancingForm(){this.financingForm=this.formBuilder.group({institutionName:[null,[d.required]],budget:[null,[d.required,d.pattern(/^\d+(\.\d{2,2})?$/)]],paymentMethod:[null,[d.required,d.pattern(be())]],source:[null,[d.required,d.pattern(be())]]})}buildFinancingsColumns(){this.financingsColumns=[{field:"institutionName",header:K.institutionName},{field:"budget",header:K.budget},{field:"paymentMethod",header:K.paymentMethod},{field:"source",header:K.source}]}addFinancing(){if(this.validateFinancingForm()){if(this.formInput.financings.findIndex(o=>o.institutionName===this.financingForm.value.institutionName)>-1){this.messageDialogService.errorCustom("La entidad ya est\xE1 registrada","Intente con otra por favor");return}this.formInput.financings.push(this.financingForm.value),this.form.patchValue(this.formInput),this.financingForm.reset(),this.isVisibleFinancingForm=!1}else this.financingForm.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}deleteFinancing(o){this.formInput.financings.splice(o,1),this.form.patchValue(this.formInput)}loadCombineInstitutions(){this.combinedInstitutions=[];let o=[],s=[];this.formInput.internalInstitutions&&(o=this.formInput.internalInstitutions.map(i=>i.name)),this.formInput.externalInstitutions&&(s=this.formInput.externalInstitutions.map(i=>i.name)),this.combinedInstitutions=o.concat(s)}validateForm(){this.formErrors=[],this.isFinancingField.value&&this.formInput.financings&&this.formInput.financings.length===0&&this.formErrors.push("Financiamientos"),this.formErrorsOutput.emit(this.formErrors)}validateFinancingForm(){return this.formErrors=[],this.institutionNameField.invalid&&this.formErrors.push(K.institutionName),this.budgetField.invalid&&this.formErrors.push(K.budget),this.paymentMethodField.invalid&&this.formErrors.push(K.paymentMethod),this.sourceField.invalid&&this.formErrors.push(K.source),this.formErrors.length===0}checkValueChanges(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(this.formInput),this.validateForm()}),this.isFinancingField.valueChanges.subscribe(o=>{this.formInput.isFinancing=o,o?(this.institutionNameField.setValidators(d.required),this.budgetField.setValidators(d.required),this.paymentMethodField.setValidators(d.required),this.sourceField.setValidators(d.required)):(this.institutionNameField.clearValidators(),this.budgetField.clearValidators(),this.paymentMethodField.clearValidators(),this.sourceField.clearValidators()),this.financingForm.reset(),this.institutionNameField.updateValueAndValidity(),this.budgetField.updateValueAndValidity(),this.paymentMethodField.updateValueAndValidity(),this.sourceField.updateValueAndValidity()})}showFinancingModal(){this.isVisibleFinancingForm=!0}get isFinancingField(){return this.form.controls.isFinancing}get institutionNameField(){return this.financingForm.controls.institutionName}get budgetField(){return this.financingForm.controls.budget}get paymentMethodField(){return this.financingForm.controls.paymentMethod}get sourceField(){return this.financingForm.controls.source}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-financing"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:8,vars:9,consts:[[1,"p-fluid","grid","text-center",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","",3,"label","required"],["formControlName","isFinancing",1,"ml-2"],["header","Agregar",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["pTemplate","header"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],["styleClass","p-datatable-striped",3,"value","columns"],["pTemplate","body"],[3,"pSortableColumn"],[1,"text-center"],[3,"click","icon","severity","pTooltip"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","","for","budget",3,"label","required"],["id","budget","formControlName","budget","mode","decimal",3,"minFractionDigits","maxFractionDigits"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","paymentMethod",3,"label","required"],["pInputText","","id","paymentMethod","formControlName","paymentMethod"],["appLabel","","for","source",3,"label","required"],["pInputText","","id","source","formControlName","source"],["appLabel","","for","combinedInstitution",3,"label","required"],["id","combinedInstitution","formControlName","institutionName",3,"options","filter","listStyle"],[3,"click","label","icon","text","severity"],[3,"click","label","icon","severity"]],template:function(s,i){s&1&&(l(0,"form",0)(1,"div",1),u(2,"label",2)(3,"p-inputSwitch",3),m()(),g(4,_n,3,0,"p-panel"),l(5,"p-dialog",4),Z("visibleChange",function(I){return Q(i.isVisibleFinancingForm,I)||(i.isVisibleFinancingForm=I),I}),g(6,gn,17,27,"ng-template",5)(7,bn,2,7,"ng-template",6),m()),s&2&&(r("formGroup",i.form),n(2),r("label",i.AgreementFormEnum.isFinancing)("required",i.isFinancingField),n(2),F(4,i.isFinancingField.value?4:-1),n(),J(x(8,ln)),X("visible",i.isVisibleFinancingForm),r("modal",!0))},dependencies:[P,Y,O,L,k,M,q,U,me,N,ie,pe,ue,ce,ne,fe,_e,Se,Pt]});let t=a;return t})();var vn=(t,a)=>a.field;function Fn(t,a){if(t&1&&(l(0,"div",12)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function yn(t,a){if(t&1&&(l(0,"div",12)(1,"div"),c(2),m()()),t&2){let e=a.$implicit;n(2),E(e.name)}}function In(t,a){if(t&1){let e=v();l(0,"form",1)(1,"div",3),u(2,"label",4),l(3,"p-dropdown",5),g(4,Fn,3,1,"ng-template",6)(5,yn,3,1,"ng-template",7),m(),u(6,"small",8),m(),l(7,"div",9),u(8,"label",10),l(9,"p-fileUpload",11,0),_("uploadHandler",function(s){f(e);let i=je(10),T=p();return h(T.onUpload(s,i))}),m(),u(11,"small",8),m()()}if(t&2){let e=p();r("formGroup",e.fileForm),n(2),r("label",e.FileFormEnum.type)("required",e.typeField),n(),r("options",e.types)("filter",!1),n(3),r("errors",e.typeField.errors)("touched",e.typeField.touched)("dirty",e.typeField.dirty),n(2),r("label",e.FileFormEnum.myFile)("required",e.fileField),n(),r("chooseIcon",e.PrimeIcons.UPLOAD)("auto",!0)("customUpload",!0),n(2),r("errors",e.fileField.errors)("touched",e.fileField.touched)("dirty",e.fileField.dirty)}}function Cn(t,a){if(t&1&&(l(0,"th",15),c(1),m()),t&2){let e=a.$implicit;r("pSortableColumn",e.field),n(),w(" ",e.header," ")}}function xn(t,a){if(t&1&&(l(0,"tr"),R(1,Cn,2,2,"th",15,vn),l(3,"th"),c(4),m()()),t&2){let e=a.$implicit,o=p(2);n(),G(e),n(3),E(o.TableEnum.ACTIONS)}}function Tn(t,a){if(t&1){let e=v();l(0,"tr")(1,"td"),c(2),m(),l(3,"td"),c(4),m(),l(5,"td")(6,"p-button",16),_("click",function(){let s=f(e).rowIndex,i=p(2);return h(i.removeFile(s))}),m()()()}if(t&2){let e=a.$implicit,o=p(2);n(2),E(e.type.name),n(2),E(e.name),n(2),r("icon",o.IconButtonActionEnum.DELETE)("pTooltip",o.LabelButtonActionEnum.DELETE)("severity",o.SeverityButtonActionEnum.DELETE)}}function Dn(t,a){if(t&1&&(l(0,"p-table",2),g(1,xn,5,1,"ng-template",13)(2,Tn,7,5,"ng-template",14),m()),t&2){let e=p();r("value",e.formInput.enablingDocuments)("columns",e.columns)}}var ri=(()=>{let a=class a{constructor(){this.formInput=ae(),this.formOutput=new C,this.formErrorsOutput=new C,this.cataloguesHttpService=b(B),this.messageDialogService=b(S),this.formBuilder=b(A),this.formErrors=[],this.LabelButtonActionEnum=ee,this.IconButtonActionEnum=te,this.FileFormEnum=ve,this.TableEnum=le,this.SeverityButtonActionEnum=W,this.PrimeIcons=j,this.types=[],this.columns=[],this.buildForm(),this.buildFileForm(),this.buildColumns()}ngOnInit(){this.loadTypes(),this.patchValueForm(),this.validateForm()}patchValueForm(){this.form.patchValue(this.formInput)}buildForm(){this.form=this.formBuilder.group({files:this.formBuilder.array([],d.required)}),this.checkValuesChange()}buildFileForm(){this.fileForm=this.formBuilder.group({type:[null,d.required],myFile:[null,d.required]}),this.checkValuesChange()}checkValuesChange(){this.form.valueChanges.subscribe(o=>{this.formOutput.emit(this.formInput),this.validateForm()})}buildColumns(){this.columns=[{field:"type",header:ve.type},{field:"name",header:ve.name}]}loadTypes(){this.types=this.cataloguesHttpService.findByType(V.AGREEMENTS_ENABLING_DOCUMENT)}validateForm(){this.formErrors=[],this.formInput.enablingDocuments.length<2&&this.formErrors.push(`Debe cargar los ${this.types.length} tipos de archivos`),this.formErrorsOutput.emit(this.formErrors)}validateFileForm(){return this.formErrors=[],this.typeField.invalid&&this.formErrors.push(ve.type),this.formInput.enablingDocuments.findIndex(o=>o.type?.id===this.typeField.value?.id)>-1&&this.formErrors.push(`${this.typeField.value.name} ya se encuentra cargado`),this.formErrors.length===0}onUpload(o,s){if(this.validateFileForm()){let i=o.files[0];this.formInput.enablingDocuments.push({type:this.typeField.value,name:i.name,file:i}),this.form.patchValue(this.formInput)}else this.messageDialogService.fieldErrors(this.formErrors),this.form.markAllAsTouched();s.clear()}removeFile(o){this.formInput.enablingDocuments.splice(o,1),this.form.patchValue(this.formInput.enablingDocuments)}get typeField(){return this.fileForm.controls.type}get fileField(){return this.fileForm.controls.myFile}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-document"]],inputs:{formInput:"formInput"},outputs:{formOutput:"formOutput",formErrorsOutput:"formErrorsOutput"},decls:2,vars:2,consts:[["uploadFiles",""],[1,"p-fluid","grid",3,"formGroup"],["styleClass","p-datatable-striped",3,"value","columns"],[1,"field","col-12","xl:col-4","lg:col-4","md:col-4","sm:col-12"],["appLabel","","for","type",3,"label","required"],["id","type","formControlName","type","dataKey","id","placeholder","Seleccione",3,"options","filter"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-7","lg:col-7","md:col-7","sm:col-12"],["appLabel","","for","file",3,"label","required"],["id","file","mode","basic","chooseLabel","Choose","name","files[]","accept",".pdf","maxFileSize","1000000",3,"uploadHandler","chooseIcon","auto","customUpload"],[1,"flex","align-items-center","gap-2"],["pTemplate","header"],["pTemplate","body"],[3,"pSortableColumn"],[3,"click","icon","pTooltip","severity"]],template:function(s,i){s&1&&g(0,In,12,16,"form",1)(1,Dn,3,2,"p-table",2),s&2&&(F(0,i.formInput.enablingDocuments.length<i.types.length?0:-1),n(),F(1,i.formInput.enablingDocuments.length>0?1:-1))},dependencies:[P,O,L,k,M,q,U,me,N,ie,de,xt,ne,fe]});let t=a;return t})();function An(t,a){if(t&1){let e=v();l(0,"p-toolbar")(1,"div",7),u(2,"app-header-form",8),m(),l(3,"div",9)(4,"app-form-button-action",10),_("submit",function(){let s=f(e).nextCallback,i=p(2);return h(i.validateFormAgreement(s))}),m()()(),u(5,"p-divider"),l(6,"div",11)(7,"p-panel",12)(8,"app-basic-data",13),_("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.basicDataErrors=s)})("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))}),m()(),l(9,"p-panel",14)(10,"app-agreement-date",13),_("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.agreementDateErrors=s)})("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))}),m()(),l(11,"p-panel",15)(12,"app-appearer",13),_("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.appearerErrors=s)})("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))}),m()()(),l(13,"p-toolbar")(14,"div",7),u(15,"app-header-form",8),m(),l(16,"div",9)(17,"app-form-button-action",10),_("submit",function(){let s=f(e).nextCallback,i=p(2);return h(i.validateFormAgreement(s))}),m()()()}if(t&2){let e=p(2);n(2),r("icon",e.PrimeIcons.PENCIL),n(2),r("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1),n(4),r("formInput",e.form.value),n(2),r("formInput",e.form.value),n(2),r("formInput",e.form.value),n(3),r("icon",e.PrimeIcons.PENCIL),n(2),r("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!1)}}function Vn(t,a){if(t&1){let e=v();l(0,"p-toolbar")(1,"div",7),u(2,"app-header-form",8),m(),l(3,"div",9)(4,"app-form-button-action",16),_("submit",function(){let s=f(e).nextCallback,i=p(2);return h(i.validateFormObligation(s))})("cancel",function(){let s=f(e).prevCallback;return h(s.emit())}),m()()(),u(5,"p-divider"),l(6,"app-obligation",13),_("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.obligationErrors=s)})("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))}),m()}if(t&2){let e=p(2);n(2),r("icon",e.PrimeIcons.PENCIL),n(2),r("iconSubmitButton",e.PrimeIcons.ARROW_RIGHT)("isVisibleCancelButton",!0),n(2),r("formInput",e.form.value)}}function wn(t,a){if(t&1){let e=v();l(0,"p-toolbar")(1,"div",7),u(2,"app-header-form",8),m(),l(3,"div",9)(4,"app-form-button-action",17),_("submit",function(){let s=f(e).nextCallback,i=p(2);return h(i.onSubmitAgreement(s))})("cancel",function(){let s=f(e).prevCallback;return h(s.emit())}),m()()(),u(5,"p-divider"),l(6,"app-financing",18),_("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))})("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.financingErrors=s)}),m()}if(t&2){let e=p(2);n(2),r("icon",e.PrimeIcons.PENCIL),n(2),r("isVisibleCancelButton",!0),n(2),r("formInput",e.form.value)}}function Nn(t,a){if(t&1){let e=v();l(0,"p-toolbar")(1,"div",7),u(2,"app-header-form",8),m(),l(3,"div",9)(4,"app-form-button-action",19),_("submit",function(){let s=f(e).nextCallback,i=p(2);return h(i.onSubmitDocuments(s))}),m()()(),u(5,"p-divider"),l(6,"app-document",18),_("formOutput",function(s){f(e);let i=p(2);return h(i.save(s))})("formErrorsOutput",function(s){f(e);let i=p(2);return h(i.documentErrors=s)}),m()}if(t&2){let e=p(2);n(2),r("icon",e.PrimeIcons.PENCIL),n(2),r("isVisibleCancelButton",!1),n(2),r("formInput",e.form.value)}}function Bn(t,a){if(t&1&&(l(0,"p-stepper",0)(1,"p-stepperPanel",2),g(2,An,18,9,"ng-template",3),m(),l(3,"p-stepperPanel",4),g(4,Vn,7,4,"ng-template",3),m(),l(5,"p-stepperPanel",5),g(6,wn,7,3,"ng-template",3),m(),l(7,"p-stepperPanel",6),g(8,Nn,7,3,"ng-template",3),m()()),t&2){let e=p();r("linear",!1)("activeStep",e.activeStep)}}var ai=(()=>{let a=class a{constructor(){this.authService=b(se),this.agreementsService=b(Qe),this.agreementsHttpService=b(nt),this.confirmationService=b(Xe),this.formBuilder=b(A),this.messageDialogService=b(S),this.router=b(Je),this.formErrors=[],this.basicDataErrors=[],this.agreementDateErrors=[],this.appearerErrors=[],this.obligationErrors=[],this.financingErrors=[],this.documentErrors=[],this.activeStep=0,this.SeverityButtonActionEnum=W,this.PrimeIcons=j,this.buildForm()}ngOnInit(){this.findAgreement()}buildForm(){this.form=this.formBuilder.group({id:[null,d.required],agreementState:[null],name:[null],internalNumber:[null],number:[null],origin:[null],type:[null],specialType:[null],internalInstitutions:[[]],externalInstitutions:[[]],subscribedAt:[null],startedAt:[null],isFinishDate:[null],endedAt:[null],endedReason:[null],yearTerm:[null],monthTerm:[null],dayTerm:[null],objective:[null],obligations:[[]],isFinancing:[null],financings:[[]],enablingDocuments:[[]],enabled:[null]})}findAgreement(){this.agreementsHttpService.findOne(this.id).subscribe(o=>{this.form.patchValue(o)})}get validateForms(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors=this.formErrors.concat(this.financingErrors),this.formErrors.length===0}validateFormAgreement(o){this.formErrors=[],this.formErrors=this.formErrors.concat(this.basicDataErrors),this.formErrors=this.formErrors.concat(this.agreementDateErrors),this.formErrors=this.formErrors.concat(this.appearerErrors),this.formErrors.length===0?o.emit():this.messageDialogService.fieldErrors(this.formErrors)}validateFormObligation(o){this.formErrors=[],this.formErrors=this.formErrors.concat(this.obligationErrors),this.formErrors.length===0?o.emit():this.messageDialogService.fieldErrors(this.formErrors)}get validateFormDocument(){return this.formErrors=[],this.formErrors=this.formErrors.concat(this.documentErrors),this.formErrors.length===0}onSubmitAgreement(o){this.validateForms?this.update(o):this.messageDialogService.fieldErrors(this.formErrors)}onSubmitDocuments(o){this.validateFormDocument?this.registerDocuments(o):this.messageDialogService.fieldErrors(this.formErrors)}save(o){this.form.patchValue(o)}update(o){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:j.TIMES_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.agreementsHttpService.update("",this.form.value).subscribe(s=>{this.form.patchValue(s),o.emit()})}})}registerDocuments(o){this.confirmationService.confirm({key:"confirmDialog",message:"Despu\xE9s de guardar, no podr\xE1 realizar cambios en la informaci\xF3n del convenio",header:"\xBFEst\xE1 seguro de guardar?",icon:j.TIMES_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{let s=new FormData;for(let i of this.enablingDocumentsField.value)s.append("typeIds",i.type.id),s.append("files",i.file);this.idField.valid&&this.agreementsHttpService.uploadEnablingDocuments(this.idField.value,s).subscribe(i=>{this.enabledField.setValue(!0),this.agreementsService.agreement=this.form.value,o.emit()})}})}finish(){this.authService.role.code===Le.NATIONAL_SUPERVISOR&&this.router.navigate(["/core/national-supervisor/agreement-list"]),this.authService.role.code===Le.INTERNATIONAL_SUPERVISOR&&this.router.navigate(["/core/international-supervisor/agreement-list"])}get idField(){return this.form.controls.id}get enablingDocumentsField(){return this.form.controls.enablingDocuments}get enabledField(){return this.form.controls.enabled}};a.\u0275fac=function(s){return new(s||a)},a.\u0275cmp=D({type:a,selectors:[["app-update"]],inputs:{id:"id"},decls:2,vars:1,consts:[["orientation","horizontal",3,"linear","activeStep"],["key","confirmDialog"],["header","Convenio"],["pTemplate","content"],["header","Obligaciones"],["header","Financiamiento"],["header","Documentos Habilitantes"],[1,"p-toolbar-group-left"],["label","Registro",3,"icon"],[1,"p-toolbar-group-right"],["labelSubmitButton","Siguiente",3,"submit","iconSubmitButton","isVisibleCancelButton"],[1,"p-fluid","grid"],["header","Datos B\xE1sicos",1,"col-12"],[3,"formErrorsOutput","formOutput","formInput"],["header","Fechas del Convenio",1,"col-12"],["header","Comparecientes",1,"col-12"],["labelSubmitButton","Siguiente","labelCancelButton","Regresar",3,"submit","cancel","iconSubmitButton","isVisibleCancelButton"],["labelSubmitButton","Guardar","labelCancelButton","Regresar",3,"submit","cancel","isVisibleCancelButton"],[3,"formOutput","formErrorsOutput","formInput"],["labelSubmitButton","Guardar",3,"submit","isVisibleCancelButton"]],template:function(s,i){s&1&&(g(0,Bn,9,2,"p-stepper",0),u(1,"p-confirmDialog",1)),s&2&&F(0,i.form.valid?0:-1)},dependencies:[Vt,N,Bt,ft,ue,It,Ut,qt,wt,Kt,Qt,ni,we,oi,ri]});let t=a;return t})();var On=[{path:"",component:ai},{title:"Obligaciones de las partes",path:"part-obligation",component:we,canDeactivate:[pt]}],li=(()=>{let a=class a{};a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=Te({type:a}),a.\u0275inj=xe({imports:[Be.forChild(On),Be]});let t=a;return t})();var sa=(()=>{let a=class a{};a.\u0275fac=function(s){return new(s||a)},a.\u0275mod=Te({type:a}),a.\u0275inj=xe({imports:[Ye,li,st,lt,Ot,rt,_t,gt,ht,mt,ut,ot,vt,Dt,dt,Lt,Ct,At,Ft,Gt,Et,jt,Rt,Tt,yt,St,Me,ke,Me,ke,ct,Nt,kt]});let t=a;return t})();export{sa as UpdateModule};
