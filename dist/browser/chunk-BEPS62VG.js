import{a as Jt,b as Xt}from"./chunk-GVO3AHEU.js";import{b as Dt}from"./chunk-ZJEYRZXI.js";import{c as Kt}from"./chunk-GWWWG5FF.js";import{a as Qt,b as Yt}from"./chunk-ELWEMSC7.js";import"./chunk-LD55VJOR.js";import"./chunk-ISADC5UE.js";import"./chunk-EH24ARRV.js";import{A as At,Aa as Ut,B as Ce,C as ye,Ga as xe,Ha as Gt,Ia as zt,Ja as nt,Ka as qt,La as be,Q as yt,R as It,Ra as Wt,Xa as jt,Y as wt,aa as Pt,ba as Mt,d as ke,fa as kt,ha as te,i as Ye,ia as ie,ja as ne,k as U,ka as oe,m as Je,n as Xe,na as Vt,p as ee,pa as G,qa as Nt,r as Ze,ra as he,sa as Rt,t as et,ta as Ie,ua as Ot,v as tt,va as it,w as fe,wa as Ht,y as Ft,z as St,za as $t}from"./chunk-JIMEKKLT.js";import{i as Qe,j as Z,k as Tt,m as ve,n as Bt}from"./chunk-CM3ZXFC4.js";import{A as _e,D as Ct,E as Te,I as Re,K as V,L as I,M as D,N as Y,O as S,P as vt,R as J,S as Fe,aa as ue,ba as qe,da as ht,e as pe,ea as Se,fa as E,ga as We,ha as Pe,ia as Oe,ja as Ae,k as P,ka as ge,o as R,pa as xt,qa as je,r as O,ra as X,s as K,sa as bt,ta as Lt,u as Q,v as H,va as Et,wa as Ke,x as Ee,ya as $,z as de}from"./chunk-4W4WMVPF.js";import{Aa as b,Ba as h,Ca as o,E as Ge,H as _,J as N,Ja as re,K as ze,La as p,Ma as B,Mb as Me,Na as f,O as C,Oa as ae,Ob as me,P as v,Pa as _t,Qa as z,Ra as q,Rb as ct,Sa as W,Wa as se,Xa as ut,_ as l,eb as y,fb as Be,gb as k,ja as u,ka as j,la as m,oa as le,pa as w,qa as g,ra as A,sa as T,ta as F,tb as gt,ua as s,va as c,w as Le,wa as d,yb as ce,zb as ft}from"./chunk-EUOB27Q6.js";var si=t=>({enabled:t});function ci(t,n){if(t&1&&(s(0,"div",12)(1,"h1"),p(2),c()()),t&2){let e=o();l(2),B(e.BreadcrumbEnum.AGREEMENTS)}}function mi(t,n){if(t&1&&(s(0,"th",13),p(1),d(2,"p-sortIcon",15),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function pi(t,n){if(t&1&&(s(0,"tr"),T(1,mi,3,3,"th",13,A),s(3,"th",14),p(4),c()()),t&2){let e=n.$implicit,i=o();l(),F(e),l(3),f(" ",i.TableEnum.ACTIONS," ")}}function di(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field].unit.name," ")}}function _i(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field].state.name," ")}}function ui(t,n){if(t&1&&u(0,di,1,1)(1,_i,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="administrator"?0:e==="agreementState"?1:-1)}}function gi(t,n){if(t&1&&(p(0),y(1,"customFormatDate")),t&2){let e=o(4).$implicit;f(" ",Be(1,1,e.subscribedAt)," ")}}function fi(t,n){if(t&1&&u(0,gi,2,3),t&2){let e=o(3).$implicit;g(0,e.subscribedAt?0:-1)}}function Ci(t,n){if(t&1&&(p(0),y(1,"customFormatDate")),t&2){let e=o(4).$implicit;f(" ",Be(1,1,e.endedAt)," ")}}function vi(t,n){t&1&&p(0," Indefinido ")}function hi(t,n){if(t&1&&u(0,Ci,2,3)(1,vi,1,0),t&2){let e=o(3).$implicit;g(0,e.endedAt?0:1)}}function xi(t,n){if(t&1&&(p(0),y(1,"yesNo")),t&2){let e=o(3).$implicit;f(" ",Be(1,1,e.isFinancing)," ")}}function bi(t,n){t&1&&d(0,"p-tag",18)}function Li(t,n){t&1&&d(0,"p-tag",19)}function Ei(t,n){if(t&1&&u(0,bi,1,0,"p-tag",18)(1,Li,1,0),t&2){let e=o(3).$implicit;g(0,e.enabled?0:1)}}function Ti(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function Fi(t,n){if(t&1&&u(0,fi,1,1)(1,hi,2,1)(2,xi,2,3)(3,Ei,2,1)(4,Ti,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="subscribedAt"?0:e==="endedAt"?1:e==="isFinancing"?2:e==="enabled"?3:4)}}function Si(t,n){if(t&1&&(s(0,"td"),u(1,ui,2,1)(2,Fi,5,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function Ai(t,n){if(t&1){let e=b();s(0,"tr",16),T(1,Si,3,2,"td",null,A),s(3,"td",14)(4,"p-button",17),h("click",function(){let r=C(e).$implicit,a=o();return v(a.selectItem(r))}),c()()()}if(t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex,a=o();m("pSelectableRow",e)("pSelectableRowIndex",r)("ngClass",ut(4,si,!e.enabled)),l(),F(i),l(3),m("icon",a.PrimeIcons.ELLIPSIS_V)}}function yi(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function Ii(t,n){}function Di(t,n){if(t&1&&d(0,"app-view",11),t&2){let e=o();m("id",e.selectedItem.id)}}var Zt=(()=>{let n=class n{constructor(){this.authService=_($),this.coreService=_(O),this.administratorsHttpService=_(xt),this.agreementsHttpService=_(ge),this.agreementsService=_(Ee),this.router=_(me),this.breadcrumbService=_(Q),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ee(""),this.items=[],this.isVisibleAgreementView=!1,this.breadcrumbService.setItems([{label:S.AGREEMENTS}]),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(i=>{this.findAgreements()})}ngOnInit(){this.findAgreements()}findAgreements(){this.administratorsHttpService.findAgreementsByAdministrator(this.authService.auth.id).subscribe(i=>{this.items=i})}buildColumns(){this.columns=[{field:"number",header:ue.number},{field:"internalNumber",header:ue.internalNumber},{field:"name",header:ue.name},{field:"administrator",header:ht.header},{field:"agreementState",header:qe.state},{field:"subscribedAt",header:ue.subscribedAt},{field:"endedAt",header:ue.endedAt},{field:"isFinancing",header:ue.isFinancing},{field:"enabled",header:ue.enabled}]}buildButtonActions(){this.buttonActions=[{id:V.AGREEMENT,label:I.AGREEMENT,icon:D.AGREEMENT,command:()=>{this.redirectViewAgreement()}},{id:V.AGREEMENT_PERIOD,label:I.AGREEMENT_PERIOD,icon:D.AGREEMENT_PERIOD,command:()=>{this.selectedItem?.id&&this.redirectTrackingLogList(this.selectedItem.id)}},{id:V.AGREEMENT_CLOSING_MANAGEMENT_ADMINISTRATOR,label:I.AGREEMENT_CLOSING_MANAGEMENT_ADMINISTRATOR,icon:D.AGREEMENT_CLOSING_MANAGEMENT_ADMINISTRATOR,command:()=>{this.selectedItem?.id&&this.redirectAgreementTerminationList(this.selectedItem.id)}}]}validateButtonActions(i){this.buildButtonActions()}redirectViewAgreement(){this.isVisibleAgreementView=!0}redirectTrackingLogList(i){this.router.navigate(["/core/agreement-administrator/period-list",i],{queryParams:{type:"execution"}})}redirectAgreementTerminationList(i){this.router.navigate(["/core/agreement-administrator/agreement-termination-list",i],{queryParams:{type:"closing"}})}remove(i){}paginate(i){}selectItem(i){this.agreementsHttpService.findOne(i.id).subscribe(r=>{this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i),this.agreementsService.agreement=r})}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-agreement-list"]],decls:13,vars:10,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Convenio",3,"visibleChange","visible","modal"],[3,"id"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex","ngClass"],[3,"click","icon"],["severity","info","value","Registrado"],["severity","danger","value","En Proceso"]],template:function(r,a){if(r&1){let L=b();s(0,"p-toolbar"),d(1,"div",1)(2,"div",2),c(),s(3,"p-table",3,0),u(5,ci,3,1,"ng-template",4)(6,pi,5,1,"ng-template",5)(7,Ai,5,6,"ng-template",6)(8,yi,3,2,"ng-template",7)(9,Ii,0,0,"ng-template",8),c(),s(10,"app-button-action",9),h("isHide",function(x){return C(L),v(a.isButtonActions=!x)}),c(),s(11,"p-dialog",10),W("visibleChange",function(x){return C(L),q(a.isVisibleAgreementView,x)||(a.isVisibleAgreementView=x),v(x)}),u(12,Di,1,1,"app-view",11),c()}r&2&&(l(3),m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading),l(7),m("buttonActions",a.buttonActions)("enabled",a.isButtonActions),l(),z("visible",a.isVisibleAgreementView),m("modal",!0),l(),g(12,a.selectedItem&&a.isVisibleAgreementView?12:-1))},dependencies:[gt,be,R,G,Z,te,ie,oe,ne,$t,xe,Qt,Et,Ke],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();function wi(t,n){if(t&1&&(s(0,"div",10)(1,"h2"),p(2),y(3,"customFormatDate"),y(4,"customFormatDate"),c()()),t&2){let e=o();l(2),_t(" ",e.period.name,": ",Be(3,3,e.period.startedAt)," - ",Be(4,5,e.period.endedAt)," ")}}function Bi(t,n){if(t&1&&(s(0,"th",11),p(1),d(2,"p-sortIcon",12),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function Pi(t,n){if(t&1&&(s(0,"tr"),T(1,Bi,3,3,"th",11,A),c()),t&2){let e=n.$implicit;l(),F(e)}}function Mi(t,n){if(t&1&&(d(0,"br"),s(1,"b"),p(2,"Comentario: "),c(),p(3)),t&2){let e=o(4).$implicit;l(3),f("",e.observation," ")}}function ki(t,n){if(t&1&&(p(0),u(1,Mi,4,1)),t&2){let e=o(3).$implicit;ae(" ",e.user.name," ",e.user.lastname," "),l(),g(1,e.observation?1:-1)}}function Vi(t,n){if(t&1&&p(0),t&2){let e=o(3).$implicit;f(" ",e.state.name," ")}}function Ni(t,n){if(t&1&&u(0,ki,2,3)(1,Vi,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="user"?0:e==="state"?1:-1)}}function Ri(t,n){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(4).$implicit;f(" ",k(1,1,e.registeredAt,"dd/MM/yy - HH:mm")," ")}}function Oi(t,n){if(t&1&&u(0,Ri,2,4),t&2){let e=o(3).$implicit;g(0,e.registeredAt?0:-1)}}function Hi(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function $i(t,n){if(t&1&&u(0,Oi,1,1)(1,Hi,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="registeredAt"?0:1)}}function Ui(t,n){if(t&1&&(s(0,"td"),u(1,Ni,2,1)(2,$i,2,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function Gi(t,n){if(t&1&&(s(0,"tr",13),T(1,Ui,3,2,"td",null,A),c()),t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex;m("pSelectableRow",e)("pSelectableRowIndex",r),l(),F(i)}}function zi(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function qi(t,n){}var we=(()=>{let n=class n{constructor(){this.authService=_($),this.coreService=_(O),this.router=_(me),this.trackingLogsHttpService=_(X),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.columns=[],this.search=new ee(""),this.items=[],this.isVisibleAgreementView=!1,this.buildColumns()}ngOnInit(){this.items=this.period.trackingLogs}buildColumns(){this.columns=[{field:"state",header:We.state},{field:"registeredAt",header:We.registeredAt},{field:"user",header:We.user}]}redirectAgreementLogForm(i){this.router.navigate(["/core/agreements/log",i])}downloadLog(){this.trackingLogsHttpService.downloadLog(this.period.id,this.trackingLogType)}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-tracking-log-list"]],inputs:{period:"period",trackingLogType:"trackingLogType"},decls:11,vars:9,consts:[["dt",""],[1,"p-toolbar-group-left"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"flex"],[3,"pSortableColumn"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"]],template:function(r,a){if(r&1){let L=b();s(0,"p-toolbar")(1,"div",1)(2,"p-button",2),h("click",function(){return C(L),v(a.downloadLog())}),c()(),d(3,"div",3),c(),s(4,"p-table",4,0),u(6,wi,5,7,"ng-template",5)(7,Pi,3,0,"ng-template",6)(8,Gi,3,2,"ng-template",7)(9,zi,3,2,"ng-template",8)(10,qi,0,0,"ng-template",9),c()}r&2&&(l(2),m("icon",a.IconButtonActionEnum.DOWNLOAD)("label",a.LabelButtonActionEnum.DOWNLOAD)("loading",a.coreService.isLoading)("severity",a.SeverityButtonActionEnum.SYNC),l(2),m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading))},dependencies:[R,G,Z,te,ie,oe,ne,ce,Ke],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();var Qi=()=>({width:"50rem"});function Yi(t,n){if(t&1&&(s(0,"div",16)(1,"h2"),p(2),c()()),t&2){let e=o();l(2),B(e.BreadcrumbEnum.ADDITIONAL_DOCUMENTS)}}function Ji(t,n){if(t&1&&(s(0,"th",17),p(1),d(2,"p-sortIcon",19),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function Xi(t,n){if(t&1&&(s(0,"tr"),T(1,Ji,3,3,"th",17,A),s(3,"th",18),p(4),c()()),t&2){let e=n.$implicit,i=o();l(),F(e),l(3),f(" ",i.TableEnum.ACTIONS," ")}}function Zi(t,n){if(t&1&&p(0),t&2){let e=o(4).$implicit;ae(" ",e.user.name," ",e.user.lastname," ")}}function en(t,n){if(t&1&&u(0,Zi,1,2),t&2){let e=o(3).$implicit;g(0,e!=null&&e.user?0:-1)}}function tn(t,n){if(t&1&&u(0,en,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="user"?0:-1)}}function nn(t,n){if(t&1){let e=b();s(0,"span"),p(1),c(),s(2,"p-button",22),h("click",function(){let r=C(e).$implicit,a=o(5);return v(a.downloadFile(r))}),c(),d(3,"p-divider")}if(t&2){let e=n.$implicit,i=o(5);l(),f("",e.type.name,": "),l(),m("icon",i.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}function on(t,n){if(t&1&&T(0,nn,4,5,null,null,A),t&2){let e=o(3).$implicit;F(e==null?null:e.additionalDocuments)}}function ln(t,n){if(t&1&&p(0),t&2){let e=o(3).$implicit;ae(" ",e.name," ",e.sequence," ")}}function rn(t,n){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;f(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function an(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function sn(t,n){if(t&1&&u(0,on,2,0)(1,ln,1,2)(2,rn,2,4)(3,an,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="additionalDocuments"?0:e==="name"?1:e==="uploadedAt"?2:3)}}function cn(t,n){if(t&1&&(s(0,"td"),u(1,tn,1,1)(2,sn,4,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function mn(t,n){if(t&1){let e=b();s(0,"tr",20),T(1,cn,3,2,"td",null,A),s(3,"td",18)(4,"p-button",21),h("click",function(){let r=C(e).$implicit,a=o();return v(a.remove(r.id))}),c()()()}if(t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex,a=o();m("pSelectableRow",e)("pSelectableRowIndex",r),l(),F(i),l(3),m("icon",a.PrimeIcons.TRASH)}}function pn(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function dn(t,n){}function _n(t,n){if(t&1&&(d(0,"i"),s(1,"div",35),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.reportFileField.value==null?null:e.reportFileField.value.name)}}function un(t,n){t&1&&(s(0,"div",28)(1,"p-messages",33),u(2,_n,3,3,"ng-template",34),c()())}function gn(t,n){if(t&1&&(d(0,"i"),s(1,"div",35),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.evidenceFileField.value==null?null:e.evidenceFileField.value.name)}}function fn(t,n){t&1&&(s(0,"div",28)(1,"p-messages",33),u(2,gn,3,3,"ng-template",34),c()())}function Cn(t,n){if(t&1){let e=b();s(0,"form",23)(1,"div",24),d(2,"label",25),s(3,"p-fileUpload",26,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadReportFile(r,a))}),c(),d(5,"small",27),c(),u(6,un,3,0,"div",28),s(7,"div",24),d(8,"label",29),s(9,"p-fileUpload",30,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadEvidenceFile(r,a))}),c(),d(11,"small",27),c(),u(12,fn,3,0,"div",28),s(13,"div",28),d(14,"label",31)(15,"textarea",32)(16,"small",27),c()()}if(t&2){let e=o();m("formGroup",e.form),l(2),m("label",e.AdditionalDocumentEnum.reportFile)("required",e.reportFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.reportFileField.errors)("touched",e.reportFileField.touched)("dirty",e.reportFileField.dirty),l(),g(6,e.reportFileField.value?6:-1),l(2),m("label",e.AdditionalDocumentEnum.evidenceFile)("required",e.evidenceFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.evidenceFileField.errors)("touched",e.evidenceFileField.touched)("dirty",e.evidenceFileField.dirty),l(),g(12,e.evidenceFileField.value?12:-1),l(2),m("label",e.AdditionalDocumentEnum.detail)("required",e.detailField),l(2),m("errors",e.detailField.errors)("touched",e.detailField.touched)("dirty",e.detailField.dirty)}}function vn(t,n){if(t&1){let e=b();s(0,"p-button",36),h("click",function(){C(e);let r=o();return v(r.closeModal())}),c(),s(1,"p-button",37),h("click",function(){C(e);let r=o();return v(r.onUpload())}),c()}if(t&2){let e=o();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),l(),m("icon",e.IconButtonActionEnum.REPORT)("label",e.LabelButtonActionEnum.REPORT)("severity",e.SeverityButtonActionEnum.REPORT)}}var ei=(()=>{let n=class n{constructor(){this.authService=_($),this.coreService=_(O),this.formBuilder=_(fe),this.cataloguesHttpService=_(de),this.trackingLogsHttpService=_(X),this.filesHttpService=_(Ae),this.confirmationService=_(pe),this.breadcrumbService=_(Q),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ee(""),this.items=[],this.formErrors=[],this.types=[],this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Se,this.CatalogueTrackingLogsStateEnum=Te,this.AdditionalDocumentEnum=Pe,this.FileEnum=Fe,this.breadcrumbService.setItems([{label:S.AGREEMENTS,routerLink:["/core/agreement-administrator/agreement-list"]},{label:S.PERIODS}]),this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(i=>{this.findAdditionalDocumentsByAgreement()})}ngOnInit(){this.findAdditionalDocumentsByAgreement(),this.loadTypes()}buildForm(){this.form=this.formBuilder.group({reportFile:[null],evidenceFile:[null],detail:[null,U.required]})}findAdditionalDocumentsByAgreement(){this.trackingLogsHttpService.findExecutionAdditionalDocumentsByAgreement(this.agreementId).subscribe(i=>{this.items=i})}loadTypes(){this.types=this.cataloguesHttpService.findByType(_e.PERIODS_TRACKING_LOG)}buildColumns(){this.columns=[{field:"name",header:Pe.name},{field:"detail",header:Pe.detail},{field:"additionalDocuments",header:Pe.additionalDocuments},{field:"uploadedAt",header:Pe.uploadedAt},{field:"user",header:Pe.user}]}buildButtonActions(){this.buttonActions=[{id:V.TRACKING_LOG,label:I.TRACKING_LOG,icon:D.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}}]}validateButtonActions(i){this.buildButtonActions()}remove(i){this.confirmationService.confirm({key:"confirmDialog",message:"No se podr\xE1 recuperar la informaci\xF3n",header:"\xBFEst\xE1 seguro de eliminar?",icon:P.TRASH,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.trackingLogsHttpService.deleteAdditionalDocument(i).subscribe(r=>{this.findAdditionalDocumentsByAgreement()})}})}selectItem(i){this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i)}showFilesModal(){this.isVisibleFilesModal=!0}downloadFile(i){this.filesHttpService.downloadFile(i)}onUpload(){if(this.validateFilesForm()){let i=new FormData;i.append("report",this.reportFileField.value),i.append("evidence",this.evidenceFileField.value),i.append("detail",this.detailField.value),this.trackingLogsHttpService.createExecutionAdditionalDocument(this.agreementId,i).subscribe(r=>{this.findAdditionalDocumentsByAgreement(),this.isVisibleFilesModal=!1})}else this.form.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors)}validateFilesForm(){return this.formErrors=[],this.reportFileField.invalid&&this.formErrors.push(E.reportFile),this.evidenceFileField.invalid&&this.formErrors.push(E.evidenceFile),this.detailField.invalid&&this.formErrors.push(E.detail),this.formErrors.length===0}uploadReportFile(i,r){this.reportFileField.patchValue(i.files[0]),r.clear()}uploadEvidenceFile(i,r){this.evidenceFileField.patchValue(i.files[0]),r.clear()}closeModal(){this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}get detailField(){return this.form.controls.detail}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-additional-document-list"]],inputs:{agreementId:"agreementId"},decls:16,vars:16,consts:[["dt",""],["uploadFiles",""],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Subir archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["key","confirmDialog"],[1,"flex"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],["severity","danger",3,"click","icon"],[1,"ml-2",3,"click","icon","label","text","severity"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","report",3,"label","required"],["id","report","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","evidence",3,"label","required"],["id","evidence","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appLabel","","for","detail",3,"label","required"],["pInputTextarea","","id","detail","formControlName","detail"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(r,a){if(r&1){let L=b();s(0,"p-toolbar")(1,"div",2)(2,"p-button",3),h("click",function(){return C(L),v(a.showFilesModal())}),c()(),d(3,"div",4),c(),s(4,"p-table",5,0),u(6,Yi,3,1,"ng-template",6)(7,Xi,5,1,"ng-template",7)(8,mn,5,3,"ng-template",8)(9,pn,3,2,"ng-template",9)(10,dn,0,0,"ng-template",10),c(),s(11,"app-button-action",11),h("isHide",function(x){return C(L),v(a.isButtonActions=!x)}),c(),s(12,"p-dialog",12),W("visibleChange",function(x){return C(L),q(a.isVisibleFilesModal,x)||(a.isVisibleFilesModal=x),v(x)}),u(13,Cn,17,28,"ng-template",13)(14,vn,2,7,"ng-template",14),c(),d(15,"p-confirmDialog",15)}r&2&&(l(2),m("icon",a.IconButtonActionEnum.CREATE)("label",a.LabelButtonActionEnum.CREATE_ADDITIONAL_DOCUMENT)("loading",a.coreService.isLoading)("severity",a.SeverityButtonActionEnum.CREATE),l(2),m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading),l(7),m("buttonActions",a.buttonActions)("enabled",a.isButtonActions),l(),le(se(15,Qi)),z("visible",a.isVisibleFilesModal),m("modal",!0))},dependencies:[Ce,ye,be,R,G,Z,Ze,Ye,Je,Xe,te,ie,oe,ne,et,tt,xe,Ie,he,ve,nt,it,ce],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();var xn=()=>({width:"50rem"}),bn=()=>({width:"100%"});function Ln(t,n){if(t&1){let e=b();s(0,"p-button",18),h("click",function(){C(e);let r=o();return v(r.createPeriod())}),c()}if(t&2){let e=o();m("icon",e.IconButtonActionEnum.CREATE)("label",e.LabelButtonActionEnum.CREATE_PERIOD)("loading",e.coreService.isLoading)("severity",e.SeverityButtonActionEnum.CREATE)}}function En(t,n){if(t&1&&(s(0,"h2"),p(1),c(),s(2,"h3"),p(3,"Descargue aqu\xED el Formato de Informe de avance semestral del convenio:"),c(),d(4,"a",19)),t&2){let e=o();l(),B(e.BreadcrumbEnum.PERIODS),l(3),m("label",e.LabelButtonActionEnum.DOWNLOAD)("icon",e.IconButtonActionEnum.DOWNLOAD)}}function Tn(t,n){if(t&1&&(s(0,"th",20),p(1),d(2,"p-sortIcon",22),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function Fn(t,n){if(t&1&&(s(0,"tr"),T(1,Tn,3,3,"th",20,A),s(3,"th",21),p(4),c()()),t&2){let e=n.$implicit,i=o();l(),F(e),l(3),f(" ",i.TableEnum.ACTIONS," ")}}function Sn(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field].unit.name," ")}}function An(t,n){if(t&1&&u(0,Sn,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="administrator"?0:-1)}}function yn(t,n){if(t&1){let e=b();s(0,"p-button",26),h("click",function(){C(e);let r=o(4).$implicit,a=o();return v(a.showFilesModal(r))}),c()}if(t&2){let e=o(5);m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function In(t,n){if(t&1){let e=b();s(0,"span"),p(1),c(),s(2,"p-button",27),h("click",function(){let r=C(e).$implicit,a=o(6);return v(a.downloadFile(r))}),c(),d(3,"p-divider")}if(t&2){let e=n.$implicit,i=o(6);l(),f("",e.type.name,": "),l(),m("icon",i.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}function Dn(t,n){if(t&1&&T(0,In,4,5,null,null,A),t&2){let e=o(4).$implicit;F(e==null?null:e.trackingLogDocuments)}}function wn(t,n){if(t&1&&u(0,yn,1,3,"p-button",25)(1,Dn,2,0),t&2){let e=o(3).$implicit,i=o();g(0,!(e!=null&&e.trackingLog)||e.trackingLog.state.code===i.CatalogueTrackingLogsStateEnum.REFUSED?0:1)}}function Bn(t,n){if(t&1&&d(0,"i",29),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function Pn(t,n){if(t&1&&d(0,"i",30),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function Mn(t,n){if(t&1&&u(0,Bn,1,2,"i",28)(1,Pn,1,2),t&2){let e=o(4).$implicit;g(0,e.trackingLog.state.code==="REPORTED"||e.trackingLog.state.code==="ACCEPTED"?0:1)}}function kn(t,n){if(t&1&&d(0,"i",30),t&2){let e=o(5);w(e.PrimeIcons.CIRCLE_FILL)}}function Vn(t,n){if(t&1&&u(0,Mn,2,1)(1,kn,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog?0:1)}}function Nn(t,n){if(t&1&&(p(0),d(1,"br"),p(2),y(3,"date"),d(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;f(" ",e.name," "),l(2),f(" ",k(3,3,e.startedAt,"d MMMM y")," - "),l(3),f(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function Rn(t,n){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;f(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function On(t,n){if(t&1&&p(0),t&2){let e=o(3).$implicit;f(" ",e.trackingLog==null||e.trackingLog.state==null?null:e.trackingLog.state.name," ")}}function Hn(t,n){if(t&1&&p(0),t&2){let e=o(4).$implicit;ae(" ",e.trackingLog.user.name," ",e.trackingLog.user.lastname," ")}}function $n(t,n){if(t&1&&u(0,Hn,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog!=null&&e.trackingLog.user?0:-1)}}function Un(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function Gn(t,n){if(t&1&&u(0,wn,2,1)(1,Vn,2,1)(2,Nn,7,9)(3,Rn,2,4)(4,On,1,1)(5,$n,1,1)(6,Un,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="files"?0:e==="trafficLight"?1:e==="name"?2:e==="uploadedAt"?3:e==="state"?4:e==="user"?5:6)}}function zn(t,n){if(t&1&&(s(0,"td"),u(1,An,1,1)(2,Gn,7,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function qn(t,n){if(t&1){let e=b();s(0,"tr",23),T(1,zn,3,2,"td",null,A),s(3,"td",21)(4,"p-button",24),h("click",function(){let r=C(e).$implicit,a=o();return v(a.selectItem(r))}),c()()()}if(t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex,a=o();m("pSelectableRow",e)("pSelectableRowIndex",r),l(),F(i),l(3),m("icon",a.PrimeIcons.ELLIPSIS_V)}}function Wn(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function jn(t,n){}function Kn(t,n){if(t&1&&(d(0,"i"),s(1,"div",41),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.reportFileField.value==null?null:e.reportFileField.value.name)}}function Qn(t,n){t&1&&(s(0,"div",36)(1,"p-messages",39),u(2,Kn,3,3,"ng-template",40),c()())}function Yn(t,n){if(t&1&&(d(0,"i"),s(1,"div",41),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.evidenceFileField.value==null?null:e.evidenceFileField.value.name)}}function Jn(t,n){t&1&&(s(0,"div",36)(1,"p-messages",39),u(2,Yn,3,3,"ng-template",40),c()())}function Xn(t,n){if(t&1){let e=b();s(0,"div",31)(1,"div",32),d(2,"label",33),s(3,"p-fileUpload",34,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadReportFile(r,a))}),c(),d(5,"small",35),c(),u(6,Qn,3,0,"div",36),s(7,"div",32),d(8,"label",37),s(9,"p-fileUpload",38,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadEvidenceFile(r,a))}),c(),d(11,"small",35),c(),u(12,Jn,3,0,"div",36),c()}if(t&2){let e=o();l(2),m("label",e.PeriodEnum.reportFile)("required",e.reportFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.reportFileField.errors)("touched",e.reportFileField.touched)("dirty",e.reportFileField.dirty),l(),g(6,e.reportFileField.value?6:-1),l(2),m("label",e.PeriodEnum.evidenceFile)("required",e.evidenceFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.evidenceFileField.errors)("touched",e.evidenceFileField.touched)("dirty",e.evidenceFileField.dirty),l(),g(12,e.evidenceFileField.value?12:-1)}}function Zn(t,n){if(t&1){let e=b();s(0,"p-button",42),h("click",function(){C(e);let r=o();return v(r.closeModal())}),c(),s(1,"p-button",43),h("click",function(){C(e);let r=o();return v(r.onUpload())}),c()}if(t&2){let e=o();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),l(),m("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.UPLOAD)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function eo(t,n){if(t&1&&d(0,"app-tracking-log-list",17),t&2){let e=o();m("period",e.selectedItem)}}var ii=(()=>{let n=class n{constructor(){this.activatedRoute=_(Me),this.authService=_($),this.coreService=_(O),this.confirmationService=_(pe),this.formBuilder=_(fe),this.cataloguesHttpService=_(de),this.periodsHttpService=_(je),this.trackingLogsHttpService=_(X),this.agreementsHttpService=_(ge),this.filesHttpService=_(Ae),this.agreementsService=_(Ee),this.router=_(me),this.breadcrumbService=_(Q),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ee(""),this.items=[],this.formErrors=[],this.types=[],this.trackingLogType="execution",this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Se,this.CatalogueTrackingLogsStateEnum=Te,this.PeriodEnum=E,this.FileEnum=Fe,this.breadcrumbService.setItems([{label:S.AGREEMENTS,routerLink:["/core/agreement-administrator/agreement-list"]},{label:S.PERIODS}]),this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(i=>{this.findPeriodsByAgreement()})}ngOnInit(){this.findPeriodsByAgreement(),this.findAgreement(this.agreementId),this.loadTypes(),this.activatedRoute.queryParams.subscribe(i=>{this.trackingLogType=i.type})}buildForm(){this.form=this.formBuilder.group({reportFile:[null,U.required],evidenceFile:[null]})}findAgreement(i){this.agreementsHttpService.findOne(i).subscribe(r=>{this.agreement=r})}findPeriodsByAgreement(){this.trackingLogsHttpService.findPeriodsByAgreement(this.agreementId,this.trackingLogType).subscribe(i=>{this.items=i})}loadTypes(){this.types=this.cataloguesHttpService.findByType(_e.PERIODS_TRACKING_LOG)}createPeriod(){this.trackingLogsHttpService.createPeriod(this.agreementId,this.trackingLogType).subscribe(i=>{this.findPeriodsByAgreement()})}buildColumns(){this.columns=[{field:"name",header:E.reportPeriod},{field:"documentName",header:E.name},{field:"files",header:E.documentName},{field:"trafficLight",header:E.trafficLight},{field:"uploadedAt",header:E.uploadedAt},{field:"user",header:E.user},{field:"state",header:E.state}]}buildButtonActions(){this.buttonActions=[{id:V.TRACKING_LOG,label:I.TRACKING_LOG,icon:D.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}},{id:V.DELETE,label:I.DELETE,icon:D.DELETE,command:()=>{this.deletePeriod()}}]}validateButtonActions(i){this.buildButtonActions(),i.agreement?.isFinishDate&&this.buttonActions.splice(this.buttonActions.findIndex(r=>r.id===V.DELETE),1)}remove(i){}paginate(i){}selectItem(i){this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i)}showFilesModal(i){this.selectedItem=i,this.isVisibleFilesModal=!0}downloadFile(i){this.filesHttpService.downloadFile(i)}onUpload(){this.validateFilesForm()?this.confirmationService.confirm({key:"confirmDialog",message:"\xBFEst\xE1 seguro de subir los archivos?",header:"",icon:P.QUESTION_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{let i=new FormData;i.append("report",this.reportFileField.value),i.append("evidence",this.evidenceFileField.value),this.trackingLogsHttpService.createTrackingLog(this.selectedItem.id,i,this.trackingLogType).subscribe(r=>{this.findPeriodsByAgreement(),this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)})}}):this.messageDialogService.fieldErrors(this.formErrors)}validateFilesForm(){return this.formErrors=[],this.reportFileField.invalid&&this.formErrors.push(E.reportFile),this.evidenceFileField.invalid&&this.formErrors.push(E.evidenceFile),this.formErrors.length===0}uploadReportFile(i,r){this.reportFileField.patchValue(i.files[0]),r.clear()}uploadEvidenceFile(i,r){this.evidenceFileField.patchValue(i.files[0]),r.clear()}closeModal(){this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)}deletePeriod(){if(this.selectedItem.trackingLog){this.messageDialogService.errorCustom("Su mensaje va aqui","Su mensaje va aqui");return}this.periodsHttpService.delete(this.selectedItem.id).subscribe(()=>{this.findPeriodsByAgreement()})}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-period-list"]],inputs:{agreementId:"agreementId"},decls:18,vars:20,consts:[["dt",""],["uploadFiles",""],[1,"p-toolbar-group-left"],[3,"icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"agreementId"],[3,"isHide","buttonActions","enabled"],["header","Subir Archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["header","Bit\xE1cora",3,"visibleChange","visible","modal"],["trackingLogType","execution",3,"period"],[3,"click","icon","label","loading","severity"],["pButton","","target","_blank","href","assets/files/informe_periodo.pdf",3,"label","icon"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[1,"p-fluid","grid"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","report",3,"label","required"],["id","report","mode","basic","chooseLabel","Cargar","invalidFileSizeMessageDetail","","name","files[]","accept",".pdf",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","evidence",3,"label","required"],["id","evidence","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(r,a){if(r&1){let L=b();s(0,"p-toolbar")(1,"div",2),u(2,Ln,1,4,"p-button",3),c(),d(3,"div",4),c(),s(4,"p-table",5,0),u(6,En,5,3,"ng-template",6)(7,Fn,5,1,"ng-template",7)(8,qn,5,3,"ng-template",8)(9,Wn,3,2,"ng-template",9)(10,jn,0,0,"ng-template",10),c(),d(11,"app-additional-document-list",11),s(12,"app-button-action",12),h("isHide",function(x){return C(L),v(a.isButtonActions=!x)}),c(),s(13,"p-dialog",13),W("visibleChange",function(x){return C(L),q(a.isVisibleFilesModal,x)||(a.isVisibleFilesModal=x),v(x)}),u(14,Xn,13,22,"ng-template",14)(15,Zn,2,7,"ng-template",15),c(),s(16,"p-dialog",16),W("visibleChange",function(x){return C(L),q(a.isVisibleTrackingLogModal,x)||(a.isVisibleTrackingLogModal=x),v(x)}),u(17,eo,1,1,"app-tracking-log-list",17),c()}r&2&&(l(2),g(2,a.agreement&&!a.agreement.isFinishDate?2:-1),l(2),m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading),l(7),m("agreementId",a.agreementId),l(),m("buttonActions",a.buttonActions)("enabled",a.isButtonActions),l(),le(se(18,xn)),z("visible",a.isVisibleFilesModal),m("modal",!0),l(3),le(se(19,bn)),z("visible",a.isVisibleTrackingLogModal),m("modal",!0),l(),g(17,a.isVisibleTrackingLogModal?17:-1))},dependencies:[Ce,ye,be,ke,R,G,Qe,Z,te,ie,oe,ne,xe,Ie,he,ve,we,ei,ce],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();var to=()=>({width:"50rem"}),io=()=>({width:"100%"});function no(t,n){if(t&1){let e=b();s(0,"p-button",17),h("click",function(){C(e);let r=o();return v(r.createPeriod())}),c()}if(t&2){let e=o();m("icon",e.IconButtonActionEnum.CREATE)("label",e.LabelButtonActionEnum.CREATE_PERIOD)("loading",e.coreService.isLoading)("severity",e.SeverityButtonActionEnum.CREATE)}}function oo(t,n){if(t&1&&(s(0,"h2"),p(1),c(),s(2,"h3"),p(3,"Descargue aqu\xED el Formato de Informe de avance de avance semestral de cierre del convenio:"),c(),d(4,"a",18)),t&2){let e=o();l(),B(e.BreadcrumbEnum.PERIODS_CLOSING_ADMINISTRATOR),l(3),m("label",e.LabelButtonActionEnum.DOWNLOAD)("icon",e.IconButtonActionEnum.DOWNLOAD)}}function lo(t,n){if(t&1&&(s(0,"th",19),p(1),d(2,"p-sortIcon",21),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function ro(t,n){if(t&1&&(s(0,"tr"),T(1,lo,3,3,"th",19,A),s(3,"th",20),p(4),c()()),t&2){let e=n.$implicit,i=o();l(),F(e),l(3),f(" ",i.TableEnum.ACTIONS," ")}}function ao(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field].unit.name," ")}}function so(t,n){if(t&1&&u(0,ao,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="administrator"?0:-1)}}function co(t,n){if(t&1){let e=b();s(0,"p-button",25),h("click",function(){C(e);let r=o(4).$implicit,a=o();return v(a.showFilesModal(r))}),c()}if(t&2){let e=o(5);m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function mo(t,n){if(t&1){let e=b();s(0,"span"),p(1),c(),s(2,"p-button",26),h("click",function(){let r=C(e).$implicit,a=o(6);return v(a.downloadFile(r))}),c(),d(3,"p-divider")}if(t&2){let e=n.$implicit,i=o(6);l(),f("",e.type.name,": "),l(),m("icon",i.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}function po(t,n){if(t&1&&T(0,mo,4,5,null,null,A),t&2){let e=o(4).$implicit;F(e==null?null:e.trackingLogDocuments)}}function _o(t,n){if(t&1&&u(0,co,1,3,"p-button",24)(1,po,2,0),t&2){let e=o(3).$implicit,i=o();g(0,!(e!=null&&e.trackingLog)||e.trackingLog.state.code===i.CatalogueTrackingLogsStateEnum.REFUSED?0:1)}}function uo(t,n){if(t&1&&d(0,"i",28),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function go(t,n){if(t&1&&d(0,"i",29),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function fo(t,n){if(t&1&&u(0,uo,1,2,"i",27)(1,go,1,2),t&2){let e=o(4).$implicit;g(0,e.trackingLog.state.code==="REPORTED"||e.trackingLog.state.code==="ACCEPTED"?0:1)}}function Co(t,n){if(t&1&&d(0,"i",29),t&2){let e=o(5);w(e.PrimeIcons.CIRCLE_FILL)}}function vo(t,n){if(t&1&&u(0,fo,2,1)(1,Co,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog?0:1)}}function ho(t,n){if(t&1&&(p(0),d(1,"br"),p(2),y(3,"date"),d(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;f(" ",e.name," "),l(2),f(" ",k(3,3,e.startedAt,"d MMMM y")," - "),l(3),f(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function xo(t,n){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;f(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function bo(t,n){if(t&1&&p(0),t&2){let e=o(3).$implicit;f(" ",e.trackingLog==null||e.trackingLog.state==null?null:e.trackingLog.state.name," ")}}function Lo(t,n){if(t&1&&p(0),t&2){let e=o(4).$implicit;ae(" ",e.trackingLog.user.name," ",e.trackingLog.user.lastname," ")}}function Eo(t,n){if(t&1&&u(0,Lo,1,2),t&2){let e=o(3).$implicit;g(0,e.trackingLog!=null&&e.trackingLog.user?0:-1)}}function To(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function Fo(t,n){if(t&1&&u(0,_o,2,1)(1,vo,2,1)(2,ho,7,9)(3,xo,2,4)(4,bo,1,1)(5,Eo,1,1)(6,To,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="files"?0:e==="trafficLight"?1:e==="name"?2:e==="uploadedAt"?3:e==="state"?4:e==="user"?5:6)}}function So(t,n){if(t&1&&(s(0,"td"),u(1,so,1,1)(2,Fo,7,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function Ao(t,n){if(t&1){let e=b();s(0,"tr",22),T(1,So,3,2,"td",null,A),s(3,"td",20)(4,"p-button",23),h("click",function(){let r=C(e).$implicit,a=o();return v(a.selectItem(r))}),c()()()}if(t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex,a=o();m("pSelectableRow",e)("pSelectableRowIndex",r),l(),F(i),l(3),m("icon",a.PrimeIcons.ELLIPSIS_V)}}function yo(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function Io(t,n){}function Do(t,n){if(t&1&&(d(0,"i"),s(1,"div",40),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.reportFileField.value==null?null:e.reportFileField.value.name)}}function wo(t,n){t&1&&(s(0,"div",35)(1,"p-messages",38),u(2,Do,3,3,"ng-template",39),c()())}function Bo(t,n){if(t&1&&(d(0,"i"),s(1,"div",40),p(2),c()),t&2){let e=o(3);w(e.PrimeIcons.FILE_PDF),l(2),B(e.evidenceFileField.value==null?null:e.evidenceFileField.value.name)}}function Po(t,n){t&1&&(s(0,"div",35)(1,"p-messages",38),u(2,Bo,3,3,"ng-template",39),c()())}function Mo(t,n){if(t&1){let e=b();s(0,"div",30)(1,"div",31),d(2,"label",32),s(3,"p-fileUpload",33,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadReportFile(r,a))}),c(),d(5,"small",34),c(),u(6,wo,3,0,"div",35),s(7,"div",31),d(8,"label",36),s(9,"p-fileUpload",37,1),h("uploadHandler",function(r){C(e);let a=re(4),L=o();return v(L.uploadEvidenceFile(r,a))}),c(),d(11,"small",34),c(),u(12,Po,3,0,"div",35),c()}if(t&2){let e=o();l(2),m("label",e.PeriodEnum.reportClosingFile)("required",e.reportFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.reportFileField.errors)("touched",e.reportFileField.touched)("dirty",e.reportFileField.dirty),l(),g(6,e.reportFileField.value?6:-1),l(2),m("label",e.PeriodEnum.evidenceClosingFile)("required",e.evidenceFileField),l(),m("chooseIcon",e.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",e.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",e.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",e.evidenceFileField.errors)("touched",e.evidenceFileField.touched)("dirty",e.evidenceFileField.dirty),l(),g(12,e.evidenceFileField.value?12:-1)}}function ko(t,n){if(t&1){let e=b();s(0,"p-button",41),h("click",function(){C(e);let r=o();return v(r.closeModal())}),c(),s(1,"p-button",42),h("click",function(){C(e);let r=o();return v(r.onUpload())}),c()}if(t&2){let e=o();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),l(),m("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.UPLOAD)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function Vo(t,n){if(t&1&&d(0,"app-tracking-log-list",16),t&2){let e=o();m("period",e.selectedItem)}}var ni=(()=>{let n=class n{constructor(){this.activatedRoute=_(Me),this.authService=_($),this.coreService=_(O),this.confirmationService=_(pe),this.formBuilder=_(fe),this.cataloguesHttpService=_(de),this.trackingLogsHttpService=_(X),this.agreementsHttpService=_(ge),this.filesHttpService=_(Ae),this.agreementsService=_(Ee),this.router=_(me),this.breadcrumbService=_(Q),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ee(""),this.items=[],this.formErrors=[],this.types=[],this.trackingLogType="closing",this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Se,this.CatalogueTrackingLogsStateEnum=Te,this.PeriodEnum=E,this.FileEnum=Fe,this.breadcrumbService.setItems([{label:S.AGREEMENTS,routerLink:["/core/agreement-administrator/agreement-list"]},{label:S.PERIODS_CLOSING_ADMINISTRATOR}]),this.buildForm(),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(Le(500)).subscribe(i=>{this.findPeriodsByAgreement()})}ngOnInit(){this.findPeriodsByAgreement(),this.findAgreement(this.agreementId),this.loadTypes()}buildForm(){this.form=this.formBuilder.group({reportFile:[null,U.required],evidenceFile:[null]})}findAgreement(i){this.agreementsHttpService.findOne(i).subscribe(r=>{this.agreement=r})}findPeriodsByAgreement(){this.trackingLogsHttpService.findPeriodsByAgreement(this.agreementId,this.trackingLogType).subscribe(i=>{this.items=i})}loadTypes(){this.types=this.cataloguesHttpService.findByType(_e.PERIODS_TRACKING_LOG)}createPeriod(){this.trackingLogsHttpService.createPeriod(this.agreementId,this.trackingLogType).subscribe(i=>{this.findPeriodsByAgreement()})}buildColumns(){this.columns=[{field:"name",header:E.reportPeriod},{field:"documentName",header:E.name},{field:"files",header:E.documentName},{field:"trafficLight",header:E.trafficLight},{field:"uploadedAt",header:E.uploadedAt},{field:"user",header:E.user},{field:"state",header:E.state}]}buildButtonActions(){this.buttonActions=[{id:V.TRACKING_LOG,label:I.TRACKING_LOG,icon:D.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}}]}validateButtonActions(i){this.buildButtonActions()}remove(i){}paginate(i){}selectItem(i){this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i)}showFilesModal(i){this.selectedItem=i,this.isVisibleFilesModal=!0}downloadFile(i){this.filesHttpService.downloadFile(i)}onUpload(){this.validateFilesForm()?this.confirmationService.confirm({key:"confirmDialog",message:"\xBFEst\xE1 seguro de subir los archivos?",header:"",icon:P.QUESTION_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{let i=new FormData;i.append("report",this.reportFileField.value),i.append("evidence",this.evidenceFileField.value),this.trackingLogsHttpService.createTrackingLog(this.selectedItem.id,i,this.trackingLogType).subscribe(r=>{this.findPeriodsByAgreement(),this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)})}}):this.messageDialogService.fieldErrors(this.formErrors)}validateFilesForm(){return this.formErrors=[],this.reportFileField.invalid&&this.formErrors.push(E.reportFile),this.evidenceFileField.invalid&&this.formErrors.push(E.evidenceFile),this.formErrors.length===0}uploadReportFile(i,r){this.reportFileField.patchValue(i.files[0]),r.clear()}uploadEvidenceFile(i,r){this.evidenceFileField.patchValue(i.files[0]),r.clear()}closeModal(){this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-period-closing-list"]],inputs:{agreementId:"agreementId"},decls:17,vars:19,consts:[["dt",""],["uploadFiles",""],[1,"p-toolbar-group-left"],[3,"icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Subir Archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["header","Bit\xE1cora",3,"visibleChange","visible","modal"],["trackingLogType","closing",3,"period"],[3,"click","icon","label","loading","severity"],["pButton","","target","_blank","href","assets/files/informe_periodo.pdf",3,"label","icon"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[1,"p-fluid","grid"],[1,"field","col-12","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","report",3,"label","required"],["id","report","mode","basic","chooseLabel","Cargar","invalidFileSizeMessageDetail","","name","files[]","accept",".pdf",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","evidence",3,"label","required"],["id","evidence","mode","basic","chooseLabel","Cargar","name","files[]","accept",".pdf,.zip,.rar","invalidFileSizeMessageDetail","",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(r,a){if(r&1){let L=b();s(0,"p-toolbar")(1,"div",2),u(2,no,1,4,"p-button",3),c(),d(3,"div",4),c(),s(4,"p-table",5,0),u(6,oo,5,3,"ng-template",6)(7,ro,5,1,"ng-template",7)(8,Ao,5,3,"ng-template",8)(9,yo,3,2,"ng-template",9)(10,Io,0,0,"ng-template",10),c(),s(11,"app-button-action",11),h("isHide",function(x){return C(L),v(a.isButtonActions=!x)}),c(),s(12,"p-dialog",12),W("visibleChange",function(x){return C(L),q(a.isVisibleFilesModal,x)||(a.isVisibleFilesModal=x),v(x)}),u(13,Mo,13,22,"ng-template",13)(14,ko,2,7,"ng-template",14),c(),s(15,"p-dialog",15),W("visibleChange",function(x){return C(L),q(a.isVisibleTrackingLogModal,x)||(a.isVisibleTrackingLogModal=x),v(x)}),u(16,Vo,1,1,"app-tracking-log-list",16),c()}r&2&&(l(2),g(2,a.agreement&&!a.agreement.isFinishDate?2:-1),l(2),m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading),l(7),m("buttonActions",a.buttonActions)("enabled",a.isButtonActions),l(),le(se(17,to)),z("visible",a.isVisibleFilesModal),m("modal",!0),l(3),le(se(18,io)),z("visible",a.isVisibleTrackingLogModal),m("modal",!0),l(),g(16,a.isVisibleTrackingLogModal?16:-1))},dependencies:[Ce,ye,be,ke,R,G,Qe,Z,te,ie,oe,ne,xe,Ie,he,ve,we,ce],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();var Ro=(t,n)=>n.id,Oo=()=>({width:"50rem"}),Ho=()=>({width:"100%"});function $o(t,n){if(t&1){let e=b();s(0,"p-button",17),h("click",function(){C(e);let r=o(2);return v(r.openFilesModal())}),c()}if(t&2){let e=o(2);m("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.CREATE_CLOSING_LOG)("loading",e.coreService.isLoading)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function Uo(t,n){if(t&1&&(s(0,"h2"),p(1),c(),s(2,"p-toolbar")(3,"div",14),u(4,$o,1,4,"p-button",15),c(),d(5,"div",16),c()),t&2){let e=o();l(),B(e.BreadcrumbEnum.CLOSING_LOG_ADMINISTRATOR),l(3),g(4,e.items.length===0?4:-1)}}function Go(t,n){if(t&1&&(s(0,"th",18),p(1),d(2,"p-sortIcon",20),c()),t&2){let e=n.$implicit;m("pSortableColumn",e.field),l(),f(" ",e.header," "),l(),m("field",e.field)}}function zo(t,n){if(t&1&&(s(0,"tr"),T(1,Go,3,3,"th",18,A),s(3,"th",19),p(4),c()()),t&2){let e=n.$implicit,i=o();l(),F(e),l(3),f(" ",i.TableEnum.ACTIONS," ")}}function qo(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field].unit.name," ")}}function Wo(t,n){if(t&1&&p(0),t&2){let e=o(4).$implicit;ae(" ",e.user.name," ",e.user.lastname," ")}}function jo(t,n){if(t&1&&u(0,Wo,1,2),t&2){let e=o(3).$implicit;g(0,e!=null&&e.user?0:-1)}}function Ko(t,n){if(t&1&&p(0),t&2){let e=o(3).$implicit;f(" ",e==null||e.state==null?null:e.state.name," ")}}function Qo(t,n){if(t&1&&u(0,qo,1,1)(1,jo,1,1)(2,Ko,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="administrator"?0:e==="user"?1:e==="state"?2:-1)}}function Yo(t,n){if(t&1){let e=b();s(0,"p-button",24),h("click",function(){C(e);let r=o(4).$implicit,a=o();return v(a.showFilesModal(r))}),c()}if(t&2){let e=o(5);m("icon",e.IconButtonActionEnum.ADD)("pTooltip",e.LabelButtonActionEnum.ADD)("severity",e.SeverityButtonActionEnum.ADD)}}function Jo(t,n){if(t&1&&(s(0,"span"),p(1),c(),d(2,"p-divider")),t&2){let e=n.$implicit;l(),f("",e.type.name,": ")}}function Xo(t,n){if(t&1&&T(0,Jo,3,1,null,null,A),t&2){let e=o(4).$implicit;F(e==null?null:e.closingLogDocuments)}}function Zo(t,n){if(t&1&&u(0,Yo,1,3,"p-button",23)(1,Xo,2,0),t&2){let e=o(3).$implicit,i=o();g(0,!(e!=null&&e.closingLogDocuments)||e.state.code===i.CatalogueTrackingLogsStateEnum.REFUSED?0:1)}}function el(t,n){if(t&1){let e=b();s(0,"p-button",25),h("click",function(){let r=C(e).$implicit,a=o(6);return v(a.downloadFile(r))}),c(),d(1,"p-divider")}if(t&2){let e=n.$implicit,i=o(6);m("icon",i.IconButtonActionEnum.DOWNLOAD)("label",e.name)("text",!0)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}function tl(t,n){if(t&1&&T(0,el,2,4,null,null,A),t&2){let e=o(4).$implicit;F(e==null?null:e.closingLogDocuments)}}function il(t,n){if(t&1&&u(0,tl,2,0),t&2){let e=o(3).$implicit;g(0,e!=null&&e.closingLogDocuments?0:-1)}}function nl(t,n){if(t&1&&d(0,"i",27),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function ol(t,n){if(t&1&&d(0,"i",28),t&2){let e=o(6);w(e.PrimeIcons.CIRCLE_FILL)}}function ll(t,n){if(t&1&&u(0,nl,1,2,"i",26)(1,ol,1,2),t&2){let e=o(4).$implicit;g(0,e.state.code==="REPORTED"||e.state.code==="ACCEPTED"?0:1)}}function rl(t,n){if(t&1&&d(0,"i",28),t&2){let e=o(5);w(e.PrimeIcons.CIRCLE_FILL)}}function al(t,n){if(t&1&&u(0,ll,2,1)(1,rl,1,2),t&2){let e=o(3).$implicit;g(0,e.closingLogDocuments?0:1)}}function sl(t,n){if(t&1&&(p(0),d(1,"br"),p(2),y(3,"date"),d(4,"br"),p(5),y(6,"date")),t&2){let e=o(3).$implicit;f(" ",e.name," "),l(2),f(" ",k(3,3,e.startedAt,"d MMMM y")," - "),l(3),f(" ",k(6,6,e.endedAt,"d MMMM y")," ")}}function cl(t,n){if(t&1&&(p(0),y(1,"date")),t&2){let e=o(3).$implicit;f(" ",k(1,1,e.uploadedAt,"dd/MM/y - HH:mm")," ")}}function ml(t,n){if(t&1&&p(0),t&2){let e=o(2).$implicit,i=o().$implicit;f(" ",i[e.field]," ")}}function pl(t,n){if(t&1&&u(0,Zo,2,1)(1,il,1,1)(2,al,2,1)(3,sl,7,9)(4,cl,2,4)(5,ml,1,1),t&2){let e,i=o().$implicit;g(0,(e=i.field)==="closingLogDocumentsUpload"?0:e==="closingLogDocuments"?1:e==="trafficLight"?2:e==="name"?3:e==="uploadedAt"?4:5)}}function dl(t,n){if(t&1&&(s(0,"td"),u(1,Qo,3,1)(2,pl,6,1),c()),t&2){let e=n.$implicit,i=o().$implicit;l(),g(1,i[e.field]!=null&&i[e.field].id?1:-1),l(),g(2,i[e.field]!=null&&i[e.field].id?-1:2)}}function _l(t,n){if(t&1){let e=b();s(0,"tr",21),T(1,dl,3,2,"td",null,A),s(3,"td",19)(4,"p-button",22),h("click",function(){let r=C(e).$implicit,a=o();return v(a.selectItem(r))}),c()()()}if(t&2){let e=n.$implicit,i=n.columns,r=n.rowIndex,a=o();m("pSelectableRow",e)("pSelectableRowIndex",r),l(),F(i),l(3),m("icon",a.PrimeIcons.ELLIPSIS_V)}}function ul(t,n){if(t&1&&(s(0,"tr")(1,"td"),p(2),c()()),t&2){let e=n.$implicit,i=o();l(),j("colspan",e.length),l(),f(" ",i.messageService.paginatorNoRecordsFound," ")}}function gl(t,n){}function fl(t,n){if(t&1&&(d(0,"i"),s(1,"div",37),p(2),c()),t&2){let e=o(2).$index,i=o(2);w(i.PrimeIcons.FILE_PDF),l(2),B(i.files[e].file.name)}}function Cl(t,n){t&1&&(s(0,"div",30)(1,"p-messages",35),u(2,fl,3,3,"ng-template",36),c()())}function vl(t,n){if(t&1){let e=b();s(0,"div",30)(1,"label",31),p(2),s(3,"b",32),p(4,"*"),c()(),s(5,"p-fileUpload",33,1),h("uploadHandler",function(r){let a=C(e).$implicit,L=re(6),M=o(2);return v(M.onUpload(r,L,a))}),c(),d(7,"small",34),c(),u(8,Cl,3,0,"div",30)}if(t&2){let e=n.$implicit,i=n.$index,r=o(2);l(),m("for",e.id),l(),f(" ",e.name," "),l(3),m("chooseIcon",r.PrimeIcons.UPLOAD)("invalidFileSizeMessageSummary",r.FileEnum.invalidFileSizeMessageSummary)("maxFileSize",r.FileEnum.maxFileSize)("auto",!0)("customUpload",!0),l(2),m("errors",r.reportFileField.errors)("touched",r.reportFileField.touched)("dirty",r.reportFileField.dirty),l(),g(8,r.files.length>i?8:-1)}}function hl(t,n){if(t&1&&(s(0,"div",29),T(1,vl,9,11,null,null,Ro),c()),t&2){let e=o();l(),F(e.closeTypes)}}function xl(t,n){if(t&1){let e=b();s(0,"p-button",38),h("click",function(){C(e);let r=o();return v(r.closeModal())}),c(),s(1,"p-button",39),h("click",function(){C(e);let r=o();return v(r.onSubmit())}),c()}if(t&2){let e=o();m("label",e.LabelButtonActionEnum.CANCEL)("icon",e.IconButtonActionEnum.CANCEL)("text",!0)("severity",e.SeverityButtonActionEnum.CANCEL),l(),m("icon",e.IconButtonActionEnum.UPLOAD)("label",e.LabelButtonActionEnum.UPLOAD)("severity",e.SeverityButtonActionEnum.UPLOAD)}}function bl(t,n){if(t&1&&d(0,"app-tracking-log-list",13),t&2){let e=o();m("period",e.selectedItem)}}var oi=(()=>{let n=class n{constructor(){this.activatedRoute=_(Me),this.authService=_($),this.coreService=_(O),this.confirmationService=_(pe),this.formBuilder=_(fe),this.cataloguesHttpService=_(de),this.periodsHttpService=_(je),this.trackingLogsHttpService=_(X),this.closingLogsHttpService=_(Lt),this.agreementsHttpService=_(ge),this.filesHttpService=_(Ae),this.agreementsService=_(Ee),this.router=_(me),this.breadcrumbService=_(Q),this.PrimeIcons=P,this.IconButtonActionEnum=D,this.SeverityButtonActionEnum=Y,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=S,this.TableEnum=J,this.messageService=_(K),this.messageDialogService=_(H),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new ee(""),this.items=[],this.formErrors=[],this.files=[],this.types=[],this.closeTypes=[],this.trackingLogType="execution",this.isVisibleFilesModal=!1,this.isVisibleTrackingLogModal=!1,this.AddendumEnum=Se,this.CatalogueTrackingLogsStateEnum=Te,this.PeriodEnum=E,this.FileEnum=Fe,this.onsubmit=onsubmit,this.breadcrumbService.setItems([{label:S.AGREEMENTS,routerLink:["/core/agreement-administrator/agreement-list"]},{label:S.PERIODS}]),this.buildForm(),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findClosingLogCurrentByAgreement(),this.findAgreement(this.agreementId),this.loadTypes(),this.loadTypesByCloseType(),this.activatedRoute.queryParams.subscribe(i=>{this.trackingLogType=i.type})}buildForm(){this.form=this.formBuilder.group({reportFile:[null,U.required],evidenceFile:[null]})}findAgreement(i){this.agreementsHttpService.findOne(i).subscribe(r=>{this.agreement=r})}findClosingLogCurrentByAgreement(){this.closingLogsHttpService.findClosingLogCurrentByAgreement(this.agreementId).subscribe(i=>{i&&(this.items=[i])})}loadTypes(){this.types=this.cataloguesHttpService.findByType(_e.PERIODS_TRACKING_LOG)}loadTypesByCloseType(){this.closeTypes=this.cataloguesHttpService.findByParent(this.closingNotification?.closeType?.id)}createClosingLog(){let i=new FormData;for(let r of this.files)i.append("typeIds",r.type.id),i.append("files",r.file);this.closingLogsHttpService.createClosingLog(this.agreementId,i).subscribe(r=>{this.findClosingLogCurrentByAgreement(),this.isVisibleFilesModal=!1})}onUpload(i,r,a){let L=this.files.findIndex(M=>M.type?.id===a.id);L===-1?this.files.push({type:a,file:i.files[0]}):this.files[L]={type:a,file:i.files[0]},r.clear()}openFilesModal(){this.isVisibleFilesModal=!0}onSubmit(){this.validateFilesForm()?this.createClosingLog():this.messageDialogService.fieldErrors(this.formErrors)}buildColumns(){this.columns=[{field:"closingLogDocumentsUpload",header:E.documentName},{field:"closingLogDocuments",header:E.fileName},{field:"trafficLight",header:E.trafficLight},{field:"uploadedAt",header:E.uploadedAt},{field:"user",header:E.user},{field:"state",header:E.state}]}buildButtonActions(){this.buttonActions=[{id:V.TRACKING_LOG,label:I.TRACKING_LOG,icon:D.TRACKING_LOG,command:()=>{this.isVisibleTrackingLogModal=!0}},{id:V.DELETE,label:I.DELETE,icon:D.DELETE,command:()=>{this.deletePeriod()}}]}validateButtonActions(i){this.buildButtonActions(),i.agreement?.isFinishDate&&this.buttonActions.splice(this.buttonActions.findIndex(r=>r.id===V.DELETE),1)}remove(i){}selectItem(i){this.isButtonActions=!0,this.selectedItem=i,this.validateButtonActions(i)}showFilesModal(i){this.selectedItem=i,this.isVisibleFilesModal=!0}downloadFile(i){this.filesHttpService.downloadFile(i)}validateFilesForm(){return this.formErrors=[],this.closeTypes.forEach(i=>{this.files.find(a=>a.type?.id===i?.id)||this.formErrors.push(i.name)}),this.formErrors.length===0}closeModal(){this.isVisibleFilesModal=!1,this.reportFileField.setValue(null),this.evidenceFileField.setValue(null)}deletePeriod(){if(this.selectedItem.trackingLog){this.messageDialogService.errorCustom("Su mensaje va aqui","Su mensaje va aqui");return}this.periodsHttpService.delete(this.selectedItem.id).subscribe(()=>{this.findClosingLogCurrentByAgreement()})}get reportFileField(){return this.form.controls.reportFile}get evidenceFileField(){return this.form.controls.evidenceFile}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-closing-log-list"]],inputs:{agreementId:"agreementId",closingNotification:"closingNotification"},decls:13,vars:18,consts:[["dt",""],["uploadFiles",""],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Subir Archivos",3,"visibleChange","visible","modal"],["pTemplate","content"],["pTemplate","footer"],["header","Bit\xE1cora",3,"visibleChange","visible","modal"],["trackingLogType","execution",3,"period"],[1,"p-toolbar-group-left"],[3,"icon","label","loading","severity"],[1,"p-toolbar-group-right"],[3,"click","icon","label","loading","severity"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex"],[3,"click","icon"],[1,"ml-2",3,"icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","pTooltip","severity"],[1,"ml-2",3,"click","icon","label","text","severity"],[2,"color","var(--green-400)","font-size","3rem",3,"class"],[2,"color","var(--green-400)","font-size","3rem"],[2,"color","var(--red-400)","font-size","3rem"],[1,"p-fluid","grid"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],[3,"for"],[1,"p-error"],["id","report","mode","basic","chooseLabel","Cargar","invalidFileSizeMessageDetail","","name","files[]","accept",".pdf,.rar,.zip",3,"uploadHandler","chooseIcon","invalidFileSizeMessageSummary","maxFileSize","auto","customUpload"],["appErrorMessage","",3,"errors","touched","dirty"],["severity","info"],["pTemplate",""],[1,"ml-2"],[3,"click","label","icon","text","severity"],[3,"click","icon","label","severity"]],template:function(r,a){if(r&1){let L=b();s(0,"p-table",2,0),u(2,Uo,6,2,"ng-template",3)(3,zo,5,1,"ng-template",4)(4,_l,5,3,"ng-template",5)(5,ul,3,2,"ng-template",6)(6,gl,0,0,"ng-template",7),c(),s(7,"app-button-action",8),h("isHide",function(x){return C(L),v(a.isButtonActions=!x)}),c(),s(8,"p-dialog",9),W("visibleChange",function(x){return C(L),q(a.isVisibleFilesModal,x)||(a.isVisibleFilesModal=x),v(x)}),u(9,hl,3,0,"ng-template",10)(10,xl,2,7,"ng-template",11),c(),s(11,"p-dialog",12),W("visibleChange",function(x){return C(L),q(a.isVisibleTrackingLogModal,x)||(a.isVisibleTrackingLogModal=x),v(x)}),u(12,bl,1,1,"app-tracking-log-list",13),c()}r&2&&(m("value",a.items)("columns",a.columns)("paginator",!0)("rows",10)("loading",a.coreService.isLoading),l(7),m("buttonActions",a.buttonActions)("enabled",a.isButtonActions),l(),le(se(16,Oo)),z("visible",a.isVisibleFilesModal),m("modal",!0),l(3),le(se(17,Ho)),z("visible",a.isVisibleTrackingLogModal),m("modal",!0),l(),g(12,a.isVisibleTrackingLogModal?12:-1))},dependencies:[Ce,be,ke,R,G,Z,te,ie,oe,ne,xe,Ie,he,ve,we,ce],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let t=n;return t})();function El(t,n){if(t&1){let e=b();s(0,"app-form-button-action",20),h("submit",function(){C(e);let r=o(2);return v(r.onSubmit())}),c()}if(t&2){let e=o(2);m("iconSubmitButton",e.PrimeIcons.SEND)("isVisibleCancelButton",!1)}}function Tl(t,n){if(t&1&&(s(0,"div",21)(1,"div"),p(2),c()()),t&2){let e=n.$implicit;l(2),B(e.name)}}function Fl(t,n){if(t&1&&(s(0,"div",21)(1,"div"),p(2),c()()),t&2){let e=n.$implicit;l(2),B(e.name)}}function Sl(t,n){t&1&&d(0,"input",17)}function Al(t,n){t&1&&d(0,"p-calendar",22),t&2&&m("iconDisplay","input")("showIcon",!0)("inline",!0)}function yl(t,n){if(t&1&&(s(0,"p-panel",0)(1,"p-toolbar")(2,"div",5),d(3,"app-header-form",6),c(),s(4,"div",7),u(5,El,1,2,"app-form-button-action",8),c()(),d(6,"p-divider"),s(7,"h3"),p(8,"Notificar fecha de Acta de Terminaci\xF3n y Cierre del Convenio"),c(),s(9,"form",9)(10,"div",10),d(11,"label",11),s(12,"p-dropdown",12),u(13,Tl,3,1,"ng-template",13)(14,Fl,3,1,"ng-template",14),c(),d(15,"small",15),c(),s(16,"div",10),d(17,"label",16),u(18,Sl,1,0,"input",17)(19,Al,1,3),d(20,"small",15),c(),s(21,"div",10),d(22,"label",18)(23,"textarea",19)(24,"small",15),c()()()),t&2){let e=o();l(3),m("icon",e.PrimeIcons.PENCIL),l(2),g(5,e.idField.value?-1:5),l(4),m("formGroup",e.form),l(2),m("label",e.ClosingNotificationEnum.closeType)("required",e.closeTypeField),l(),m("options",e.closeTypes),l(3),m("errors",e.closeTypeField.errors)("touched",e.closeTypeField.touched)("dirty",e.closeTypeField.dirty),l(2),m("label",e.ClosingNotificationEnum.closedAt)("required",e.closedAtField),l(),g(18,e.idField.value?18:19),l(2),m("errors",e.closedAtField.errors)("touched",e.closedAtField.touched)("dirty",e.closedAtField.dirty),l(2),m("label",e.ClosingNotificationEnum.closeDetail)("required",e.closeDetailField),l(2),m("errors",e.closeDetailField.errors)("touched",e.closeDetailField.touched)("dirty",e.closeDetailField.dirty)}}function Il(t,n){if(t&1){let e=b();s(0,"app-form-button-action",20),h("submit",function(){C(e);let r=o(2);return v(r.onSubmit())}),c()}if(t&2){let e=o(2);m("iconSubmitButton",e.PrimeIcons.SEND)("isVisibleCancelButton",!1)}}function Dl(t,n){t&1&&d(0,"input",17)}function wl(t,n){if(t&1&&d(0,"p-calendar",24),t&2){let e=o(3);m("iconDisplay","input")("showIcon",!0)("inline",!0)("minDate",e.endedAt)}}function Bl(t,n){if(t&1&&u(0,wl,1,4,"p-calendar",24),t&2){let e=o(2);g(0,e.closingNotification.agreement.endedAt?0:-1)}}function Pl(t,n){if(t&1&&(s(0,"p-panel",0)(1,"p-toolbar")(2,"div",5),d(3,"app-header-form",6),c(),s(4,"div",7),u(5,Il,1,2,"app-form-button-action",8),c()(),d(6,"p-divider"),s(7,"h3"),p(8,"Notificar fecha de Acta de Terminaci\xF3n y Cierre del Convenio"),c(),s(9,"form",9)(10,"div",10),d(11,"label",23),u(12,Dl,1,0,"input",17)(13,Bl,1,1),d(14,"small",15),c()()()),t&2){let e=o();l(3),m("icon",e.PrimeIcons.PENCIL),l(2),g(5,e.closedAtField.value?-1:5),l(4),m("formGroup",e.form),l(2),m("label",e.ClosingNotificationEnum.closedAt)("required",e.closedAtField),l(),g(12,e.closedAtField.value?12:13),l(2),m("errors",e.closedAtField.errors)("touched",e.closedAtField.touched)("dirty",e.closedAtField.dirty)}}function Ml(t,n){t&1&&(s(0,"div",26),p(1," Previo a reportar la documentaci\xF3n en las secciones REPORTE AVANCE PROCESO DE CIERRE DEL CONVENIO y GESTI\xD3N DE CIERRE DE CONVENIO \xE9stos (reportes de ejecuci\xF3n) deber\xE1 contar con todos los reportes de ejecuci\xF3n en estado ACEPTADO. "),c())}function kl(t,n){t&1&&(s(0,"p-messages",2),u(1,Ml,2,0,"ng-template",25),c())}function Vl(t,n){if(t&1&&(u(0,kl,2,0,"p-messages",2),d(1,"app-period-closing-list",1)),t&2){let e=o();g(0,e.validPeriodsExecution?-1:0),l(),m("agreementId",e.agreementId)}}function Nl(t,n){t&1&&(s(0,"div",26),p(1," Previo a reportar la documentaci\xF3n en la secciones GESTI\xD3N DE CIERRE DE CONVENIO \xE9stos (reportes de avence de cierre) deber\xE1 contar con todos los reportes en estado ACEPTADO. "),c())}function Rl(t,n){t&1&&(s(0,"p-messages",2),u(1,Nl,2,0,"ng-template",25),c())}function Ol(t,n){if(t&1&&d(0,"app-closing-log-list",3),t&2){let e=o();m("agreementId",e.agreementId)("closingNotification",e.closingNotification)}}var li=(()=>{let n=class n{constructor(){this.authService=_($),this.breadcrumbService=_(Q),this.agreementsHttpService=_(ge),this.confirmationService=_(pe),this.closingNotificationsHttpService=_(bt),this.trackingLogsHttpService=_(X),this.cataloguesHttpService=_(de),this.coreService=_(O),this.messageDialogService=_(H),this.formBuilder=_(fe),this.validPeriodsExecution=!1,this.validPeriodsClosing=!1,this.Validators=U,this.formErrors=[],this.closeTypes=[],this.AgreementFormEnum=ue,this.AgreementStateEnum=qe,this.SkeletonEnum=vt,this.ClosingNotificationEnum=Oe,this.PrimeIcons=P,this.CatalogueAgreementsTypeEnum=Ct,this.CatalogueClosingNotificationsCloseTypeEnum=Re,this.breadcrumbService.setItems([{label:S.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:S.CLOSING_NOTIFICATION}]),this.buildForm()}ngOnInit(){this.loadCloseTypes(),this.findClosingNotificationByAgreement(),this.validationPeriodsExecution(),this.validationPeriodsClosing()}buildForm(){this.form=this.formBuilder.group({id:[null],agreement:[null,U.required],closedAt:[null,U.required],closeDetail:[null,U.required],closeType:[null,U.required]})}createClosingNotification(){this.agreementField.patchValue({id:this.agreementId}),this.closingNotificationsHttpService.createClosingNotificationByAgreement(this.form.value).subscribe(i=>{this.findClosingNotificationByAgreement()})}updateClosedAt(){this.closingNotificationsHttpService.updateClosedAt(this.idField.value,this.closedAtField.value).subscribe(i=>{this.findClosingNotificationByAgreement()})}validationPeriodsExecution(){this.trackingLogsHttpService.validationPeriods(this.agreementId,"execution").subscribe(i=>{this.validPeriodsExecution=i})}validationPeriodsClosing(){this.trackingLogsHttpService.validationPeriods(this.agreementId,"closing").subscribe(i=>{this.validPeriodsClosing=i})}findClosingNotificationByAgreement(){this.closingNotificationsHttpService.findClosingNotificationByAgreement(this.agreementId).subscribe(i=>{i&&(this.closingNotification=i,this.form.patchValue(i),(this.closingNotification.closeType?.code===Re.MUTUAL||this.closingNotification.closeType?.code===Re.OBJECT||this.closingNotification.closeType?.code===Re.UNILATERAL)&&this.form.disable(),i.closedAt&&(this.closedAtField.setValue(Kt(i.closedAt)),this.form.disable()),this.endedAt=new Date(this.closingNotification.agreement.endedAt+"T05:00:00"))})}validateForm(){return this.formErrors=[],this.closedAtField.invalid&&this.formErrors.push(Oe.closedAt),this.closeDetailField.invalid&&this.formErrors.push(Oe.closeDetail),this.closeTypeField.invalid&&this.formErrors.push(Oe.closeType),this.formErrors.length===0}onSubmit(){this.validateForm()?this.confirmationService.confirm({key:"confirmDialog",message:"\xBFEst\xE1 seguro de notificar la terminiaci\xF3n del convenio?",header:"",icon:P.QUESTION_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.createClosingNotification()}}):(this.form.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}onUpdate(){this.validateForm()?this.confirmationService.confirm({key:"confirmDialog",message:"\xBFEst\xE1 seguro de notificar la terminiaci\xF3n del convenio?",header:"",icon:P.QUESTION_CIRCLE,acceptLabel:"Si",rejectLabel:"No",rejectButtonStyleClass:"p-button-text",accept:()=>{this.createClosingNotification()}}):(this.form.markAllAsTouched(),this.messageDialogService.fieldErrors(this.formErrors))}loadCloseTypes(){this.closeTypes=this.cataloguesHttpService.findByType(_e.CLOSING_NOTIFICATIONS_CLOSE_TYPE)}get idField(){return this.form.controls.id}get agreementField(){return this.form.controls.agreement}get closedAtField(){return this.form.controls.closedAt}get closeDetailField(){return this.form.controls.closeDetail}get closeTypeField(){return this.form.controls.closeType}};n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=N({type:n,selectors:[["app-agreement-termination-list"]],inputs:{agreementId:"agreementId"},decls:6,vars:5,consts:[["header","Acta de Terminaci\xF3n y Cierre del Convenio"],[3,"agreementId"],["severity","error"],[3,"agreementId","closingNotification"],["key","confirmDialog"],[1,"p-toolbar-group-left"],["label","Registro",3,"icon"],[1,"p-toolbar-group-right"],["labelSubmitButton","Notificar",3,"iconSubmitButton","isVisibleCancelButton"],[1,"p-fluid","grid",3,"formGroup"],[1,"field","col-12","xl:col-12","lg:col-12","md:col-12","sm:col-12"],["appLabel","","for","closeType",3,"label","required"],["id","closeType","formControlName","closeType","dataKey","id","placeholder","Selecione",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["appErrorMessage","",3,"errors","touched","dirty"],["appLabel","","for","closedAt",3,"label","required"],["pInputText","","formControlName","closedAt"],["appLabel","","for","closeDetail",3,"label","required"],["pInputTextarea","","id","closeDetail","formControlName","closeDetail"],["labelSubmitButton","Notificar",3,"submit","iconSubmitButton","isVisibleCancelButton"],[1,"flex","align-items-center","gap-2"],["id","closedAt","formControlName","closedAt","dateFormat","dd/mm/yy",3,"iconDisplay","showIcon","inline"],["appLabel","","for","closedAt2",3,"label","required"],["id","closedAt2","formControlName","closedAt","dateFormat","dd/mm/yy",3,"iconDisplay","showIcon","inline","minDate"],["pTemplate",""],[1,"ml-2"]],template:function(r,a){r&1&&(u(0,yl,25,20,"p-panel",0)(1,Pl,15,9,"p-panel",0)(2,Vl,2,2,"app-period-closing-list",1)(3,Rl,2,0,"p-messages",2)(4,Ol,1,2,"app-closing-log-list",3),d(5,"p-confirmDialog",4)),r&2&&(g(0,!a.closingNotification||(a.closingNotification.closeType==null?null:a.closingNotification.closeType.code)===a.CatalogueClosingNotificationsCloseTypeEnum.MUTUAL||(a.closingNotification.closeType==null?null:a.closingNotification.closeType.code)===a.CatalogueClosingNotificationsCloseTypeEnum.OBJECT||(a.closingNotification.closeType==null?null:a.closingNotification.closeType.code)===a.CatalogueClosingNotificationsCloseTypeEnum.UNILATERAL?0:-1),l(),g(1,a.closingNotification&&(a.closingNotification.closeType==null?null:a.closingNotification.closeType.code)===a.CatalogueClosingNotificationsCloseTypeEnum.TERM?1:-1),l(),g(2,a.closingNotification&&(a.closingNotification.closeType==null?null:a.closingNotification.closeType.code)===a.CatalogueClosingNotificationsCloseTypeEnum.TERM?2:-1),l(),g(3,a.validPeriodsClosing?-1:3),l(),g(4,a.closingNotification?4:-1))},dependencies:[Ce,ye,zt,R,Wt,G,wt,Ze,Ye,Je,Xe,et,tt,St,he,ve,nt,it,Pt,yt,ni,oi]});let t=n;return t})();var Hl=[{path:"agreement-list",component:Zt},{path:"period-list/:agreementId",component:ii},{path:"agreement-termination-list/:agreementId",component:li},{path:"tracking-log-list",component:we}],ri=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=ze({type:n}),n.\u0275inj=Ge({imports:[ct.forChild(Hl),ct]});let t=n;return t})();var os=(()=>{let n=class n{};n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=ze({type:n}),n.\u0275inj=Ge({imports:[ft,ri,jt,Nt,Tt,kt,Vt,Dt,Ut,Ft,At,Gt,Yt,Jt,Xt,Ot,Rt,Bt,qt,Ht,Mt,It]});let t=n;return t})();export{os as AgreementAdministratorModule};
