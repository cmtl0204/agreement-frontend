import{a as le}from"./chunk-MNTWIDOC.js";import{a as fe}from"./chunk-DEX7Y7TP.js";import{Ga as ue,La as ge,i as ie,ia as me,ja as se,ka as ce,la as pe,m as ne,o as oe,qa as de,r as re,y as ae,za as _e}from"./chunk-4ES35ZDM.js";import{B as C,C as Q,D as X,G as Z,K as ee,j as y,k as v,l as h,m as S,n as z,o as L,r as J}from"./chunk-G2LENOAT.js";import{j as te}from"./chunk-CSO23DVT.js";import{k as W,o as G,r as Y,s as U,u as j,v as K,x as q}from"./chunk-ZFS7MCCM.js";import{B,Da as g,Ea as P,Fa as f,G as V,H as F,Hb as H,Ia as D,Ja as $,Ka as O,Pa as k,S as r,ba as d,ca as R,da as c,ia as _,ja as x,ka as T,la as I,lb as M,ma as l,na as s,oa as u,r as w,sa as N,ta as A,ua as a,z as p}from"./chunk-3AQ5X5KI.js";var Ce=e=>({enabled:e});function be(e,n){if(e&1&&(l(0,"div",13)(1,"h1"),g(2),s(),l(3,"div",14)(4,"p-inputGroup"),u(5,"p-button",15)(6,"input",16),s()()()),e&2){let i=a();r(2),P(i.BreadcrumbEnum.AGREEMENTS),r(3),c("icon",i.PrimeIcons.SEARCH),r(),c("formControl",i.search)}}function Ae(e,n){if(e&1&&(l(0,"th",17),g(1),u(2,"p-sortIcon",19),s()),e&2){let i=n.$implicit;c("pSortableColumn",i.field),r(),f(" ",i.header," "),r(),c("field",i.field)}}function ve(e,n){if(e&1&&(l(0,"tr"),T(1,Ae,3,3,"th",17,x),l(3,"th",18),g(4),s()()),e&2){let i=n.$implicit,t=a();r(),I(i),r(3),f(" ",t.TableEnum.ACTIONS," ")}}function he(e,n){if(e&1&&g(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field].unit.name," ")}}function Se(e,n){if(e&1&&g(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field].state.name," ")}}function Ee(e,n){if(e&1&&d(0,he,1,1)(1,Se,1,1),e&2){let i,t=a().$implicit;_(0,(i=t.field)==="administrator"?0:i==="agreementState"?1:-1)}}function xe(e,n){e&1&&u(0,"p-tag",22)}function Te(e,n){if(e&1&&d(0,xe,1,0,"p-tag",22),e&2){let i=a(3).$implicit;_(0,i.suspendedAt?0:-1)}}function Ie(e,n){e&1&&u(0,"p-tag",23)}function ye(e,n){e&1&&u(0,"p-tag",24)}function Le(e,n){if(e&1&&d(0,Ie,1,0,"p-tag",23)(1,ye,1,0),e&2){let i=a(3).$implicit;_(0,i.enabled?0:1)}}function we(e,n){if(e&1&&g(0),e&2){let i=a(2).$implicit,t=a().$implicit;f(" ",t[i.field]," ")}}function Be(e,n){if(e&1&&d(0,Te,1,1)(1,Le,2,1)(2,we,1,1),e&2){let i,t=a().$implicit;_(0,(i=t.field)==="isFinancing"?0:i==="enabled"?1:2)}}function Ve(e,n){if(e&1&&(l(0,"td"),d(1,Ee,2,1)(2,Be,3,1),s()),e&2){let i=n.$implicit,t=a().$implicit;r(),_(1,t[i.field]!=null&&t[i.field].id?1:-1),r(),_(2,t[i.field]!=null&&t[i.field].id?-1:2)}}function Fe(e,n){if(e&1){let i=N();l(0,"tr",20),T(1,Ve,3,2,"td",null,x),l(3,"td",18)(4,"p-button",21),A("click",function(){let m=V(i).$implicit,o=a();return F(o.selectItem(m))}),s()()()}if(e&2){let i=n.$implicit,t=n.columns,m=n.rowIndex,o=a();c("pSelectableRow",i)("pSelectableRowIndex",m)("ngClass",k(4,Ce,!i.enabled)),r(),I(t),r(3),c("icon",o.PrimeIcons.ELLIPSIS_V)}}function Re(e,n){if(e&1&&(l(0,"tr")(1,"td"),g(2),s()()),e&2){let i=n.$implicit,t=a();r(),R("colspan",i.length),r(),f(" ",t.messageService.paginatorNoRecordsFound," ")}}function Ne(e,n){}function Pe(e,n){if(e&1&&u(0,"app-view",12),e&2){let i=a();c("id",i.selectedItem.id)}}var rt=(()=>{let n=class n{constructor(){this.authService=p(ee),this.coreService=p(Y),this.agreementsHttpService=p(Z),this.agreementsService=p(q),this.router=p(H),this.breadcrumbService=p(j),this.PrimeIcons=W,this.IconButtonActionEnum=S,this.SeverityButtonActionEnum=z,this.LabelButtonActionEnum=h,this.BreadcrumbEnum=L,this.TableEnum=J,this.messageService=p(U),this.messageDialogService=p(K),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new oe(""),this.items=[],this.isVisibleAgreementView=!1,this.breadcrumbService.setItems([{label:L.AGREEMENTS}]),this.buildButtonActions(),this.buildColumns(),this.search.valueChanges.pipe(w(500)).subscribe(t=>{this.findAgreements()})}ngOnInit(){this.findAgreements()}findAgreements(){this.authService.role.code===y.NATIONAL_SUPERVISOR&&this.agreementsHttpService.findNationalAgreementsByOrigin().subscribe(t=>{this.items=t}),this.authService.role.code===y.INTERNATIONAL_SUPERVISOR&&this.agreementsHttpService.findInternationalAgreementsByOrigin().subscribe(t=>{this.items=t})}buildColumns(){this.columns=[{field:"name",header:C.name},{field:"internalNumber",header:C.internalNumber},{field:"number",header:C.number},{field:"administrator",header:X.unit},{field:"endedAt",header:C.endedAt},{field:"agreementState",header:Q.state},{field:"enabled",header:C.enabled}]}buildButtonActions(){this.buttonActions=[{id:v.VIEW,label:h.VIEW,icon:S.VIEW,command:()=>{this.redirectViewAgreement()}},{id:v.COMPLETE,label:h.COMPLETE,icon:S.COMPLETE,command:()=>{this.selectedItem?.id&&this.redirectCompleteForm(this.selectedItem)}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}redirectCompleteForm(t){this.router.navigate(["/core/agreements","register"])}redirectEditForm(t){this.router.navigate(["/core/agreements/update",t])}redirectViewAgreement(){this.messageDialogService.successCustom("Sitio en construcci\xF3n","Pronto estar\xE1 disponibel")}remove(t){}validateButtonActions(t){this.buildButtonActions(),t.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(m=>m.id===v.COMPLETE),1),t.enabled||this.buttonActions.splice(this.buttonActions.findIndex(m=>m.id===v.VIEW),1)}paginate(t){}selectItem(t){this.agreementsHttpService.findOne(t.id).subscribe(m=>{this.isButtonActions=!0,this.selectedItem=t,this.validateButtonActions(t),this.agreementsService.agreement=m})}};n.\u0275fac=function(m){return new(m||n)},n.\u0275cmp=B({type:n,selectors:[["app-agreement-list"]],decls:14,vars:18,consts:[[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"ml-2",3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["dataKey","id","styleClass","p-datatable-striped","paginatorPosition","both",3,"value","columns","paginator","rows","loading"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[3,"isHide","buttonActions","enabled"],["header","Convenio",3,"visibleChange","visible","modal"],[3,"id"],[1,"flex"],[1,"p-input-icon-right","ml-auto"],[3,"icon"],["type","text","pInputText","","placeholder","Buscar...",3,"formControl"],[3,"pSortableColumn"],[1,"text-center"],[3,"field"],[3,"pSelectableRow","pSelectableRowIndex","ngClass"],[3,"click","icon"],["severity","danger","value","Suspendido",1,"mr-1"],["severity","info","value","Registrado"],["severity","danger","value","En Proceso"]],template:function(m,o){m&1&&(l(0,"p-toolbar")(1,"div",0)(2,"p-button",1),A("click",function(){return o.redirectCreateForm()}),s(),l(3,"p-button",2),A("click",function(){return o.findAgreements()}),s()(),u(4,"div",3),s(),l(5,"p-table",4),d(6,be,7,3,"ng-template",5)(7,ve,5,1,"ng-template",6)(8,Fe,5,6,"ng-template",7)(9,Re,3,2,"ng-template",8)(10,Ne,0,0,"ng-template",9),s(),l(11,"app-button-action",10),A("isHide",function(b){return o.isButtonActions=!b}),s(),l(12,"p-dialog",11),O("visibleChange",function(b){return $(o.isVisibleAgreementView,b)||(o.isVisibleAgreementView=b),b}),d(13,Pe,1,1,"app-view",12),s()),m&2&&(r(2),c("icon",o.IconButtonActionEnum.CREATE)("label",o.LabelButtonActionEnum.CREATE)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.CREATE),r(),c("icon",o.IconButtonActionEnum.SYNC)("label",o.LabelButtonActionEnum.SYNC)("loading",o.coreService.isLoading)("severity",o.SeverityButtonActionEnum.SYNC),r(2),c("value",o.items)("columns",o.columns)("paginator",!0)("rows",10)("loading",o.coreService.isLoading),r(6),c("buttonActions",o.buttonActions)("enabled",o.isButtonActions),r(),D("visible",o.isVisibleAgreementView),c("modal",!0),r(),_(13,o.selectedItem&&o.isVisibleAgreementView?13:-1))},dependencies:[M,ge,G,de,te,ie,ne,me,se,pe,ce,le,_e,re,ae,ue,fe],styles:[".enabled[_ngcontent-%COMP%]{background-color:var(--red-200)}"]});let e=n;return e})();export{rt as a};
