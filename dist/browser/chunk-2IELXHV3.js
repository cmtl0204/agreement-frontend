import{a as _e,b as we}from"./chunk-SPMLKPHR.js";import{b as J}from"./chunk-EPDUYQ6E.js";import{a as Pe}from"./chunk-PDG3KPQP.js";import{b as Ee}from"./chunk-ISADC5UE.js";import{a as ve,b as Z,c as he,e as Fe}from"./chunk-PBCIGM6W.js";import{A as z,B as M,P as $,Q as Ce,Wa as Ne,X as Se,Y as be,Z as xe,b as O,i as H,k as u,m as E,n as P,q as I,s as V,u as L,v as R,x as fe,y as Y,z as ge}from"./chunk-QE2E6YRM.js";import{e as ce,j as N,k as ue,n as ye,r as Te}from"./chunk-YQJQS4JL.js";import{R as j,k as y,o as A,p as de,r as x,ra as B,s as F,sa as T,t as G,y as pe}from"./chunk-CK22UZYV.js";import{$ as k,Aa as w,Ba as f,Ca as m,Da as re,E as q,Ea as ne,H as c,J as S,K as D,La as g,Ma as b,Mb as me,Na as ae,O as C,P as _,Rb as Q,Xa as se,_ as o,ja as v,ka as oe,la as n,qa as h,tb as K,ua as r,va as a,wa as d,wb as le,zb as U}from"./chunk-EUOB27Q6.js";var Ie=()=>"[\\w\\-]+(\\.[\\w \\-]+)";var $e=["*"],Ve=(()=>{class t{style;styleClass;static \u0275fac=function(l){return new(l||t)};static \u0275cmp=S({type:t,selectors:[["p-inputGroupAddon"]],hostAttrs:[1,"p-element","p-inputgroup-addon"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:$e,decls:2,vars:3,consts:[[3,"ngClass","ngStyle"]],template:function(l,s){l&1&&(re(),r(0,"div",0),ne(1),a()),l&2&&(n("ngClass",s.styleClass)("ngStyle",s.style),oe("data-pc-name","inputgroupaddon"))},dependencies:[K,le],encapsulation:2})}return t})(),Le=(()=>{class t{static \u0275fac=function(l){return new(l||t)};static \u0275mod=D({type:t});static \u0275inj=q({imports:[U,de]})}return t})();var Ue=t=>({"p-error":t});function Ye(t,i){if(t&1&&(r(0,"div",5)(1,"span",6),g(2),a()()),t&2){let e=m();o(2),b(e.authService.system)}}function Ze(t,i){t&1&&(r(0,"h2"),g(1,"PRUEBAS"),a())}function Je(t,i){if(t&1&&(r(0,"div",10),d(1,"app-progress-bar",17),a()),t&2){let e=m(2);o(),n("message",e.messageService.progressBarLogin)}}function Qe(t,i){if(t&1){let e=w();r(0,"form",7),f("ngSubmit",function(){C(e);let s=m();return _(s.onSubmit())}),r(1,"div",8),v(2,Ze,2,0,"h2"),r(3,"h2",9),g(4),a()(),r(5,"div",10),d(6,"label",11),r(7,"p-inputGroup"),d(8,"input",12),r(9,"p-inputGroupAddon"),g(10,"@turismo.gob.ec"),a()(),d(11,"small",13),a(),r(12,"div",10),d(13,"label",14)(14,"p-password",15)(15,"small",13),a(),v(16,Je,2,1,"div",10),r(17,"div",10),d(18,"p-button",16),a()()}if(t&2){let e=m();n("formGroup",e.form),o(2),h(2,e.environment.production?-1:2),o(),n("ngClass",se(17,Ue,!e.environment.production)),o(),ae(" Ingreso al Sistema ",e.authService.systemShortName," "),o(2),n("label",e.LoginFormEnum.username)("required",e.usernameField),o(5),n("errors",e.usernameField.errors)("touched",e.usernameField.touched)("dirty",e.usernameField.dirty),o(2),n("label",e.LoginFormEnum.password)("required",e.passwordField),o(),n("feedback",!1),o(),n("errors",e.passwordField.errors)("touched",e.passwordField.touched)("dirty",e.passwordField.dirty),o(),h(16,e.coreService.isLoading?16:-1),o(2),n("icon",e.PrimeIcons.SIGN_IN)}}function Xe(t,i){if(t&1&&(r(0,"div",18),d(1,"p-button",19),a()),t&2){let e=m();o(),n("icon",e.PrimeIcons.DOWNLOAD)}}var Ae=(()=>{let i=class i{constructor(){this.authService=c(T),this.authHttpService=c(B),this.coreService=c(x),this.formBuilder=c(R),this.messageService=c(F),this.routesService=c(G),this.PrimeIcons=y,this.LoginFormEnum=j,this.environment=pe,this.authService.removeLogin(),this.buildForm()}buildForm(){this.form=this.formBuilder.group({username:[null,[u.required,u.pattern(Ie())]],password:[null,[u.required]]}),this.checkValueChanges()}checkValueChanges(){}onSubmit(){this.usernameField.value&&this.usernameField.patchValue(this.usernameField.value.trim()),this.form.valid?this.login():(this.form.markAllAsTouched(),this.messageService.errorsFields())}login(){this.authService.removeLogin(),this.authHttpService.login(this.form.value).subscribe(l=>{if(this.authService.roles.length===0){this.messageService.errorCustom("Sin Rol","No cuenta con un rol asignado"),this.authService.removeLogin();return}this.routesService.roleSelect()})}get usernameField(){return this.form.controls.username}get passwordField(){return this.form.controls.password}};i.\u0275fac=function(s){return new(s||i)},i.\u0275cmp=S({type:i,selectors:[["app-login"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold","p-error"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[3,"ngClass"],[1,"field","col-12"],["for","username","appLabel","",3,"label","required"],["pInputText","","id","username","formControlName","username"],["appErrorMessage","",3,"errors","touched","dirty"],["for","password","appLabel","",3,"label","required"],["id","password","formControlName","password",3,"feedback"],["type","submit","label","Continuar",3,"icon"],[3,"message"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","info","label","Descargar Manual de Usuario",3,"icon"]],template:function(s,p){s&1&&(r(0,"div",0)(1,"p-panel",1),v(2,Ye,3,1,"ng-template",2)(3,Qe,19,19,"ng-template",3)(4,Xe,2,1,"ng-template",4),a()())},dependencies:[K,I,H,E,P,V,L,O,z,M,A,N,Y,Z,$,_e,Ve],styles:[`body{background-image:url(/assets/images/pages/auth/login/login.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();function et(t,i){if(t&1&&(r(0,"div",5)(1,"span",6),g(2),a()()),t&2){let e=m();o(2),b(e.authService.system)}}function tt(t,i){if(t&1){let e=w();r(0,"div",9)(1,"p-button",15),f("click",function(){C(e);let s=m(2);return _(s.requestTransactionalCode())}),a()()}if(t&2){let e=m(2);o(),n("icon",e.PrimeIcons.SEND)("disabled",!e.usernameField.valid)}}function it(t,i){if(t&1&&(r(0,"div",13),d(1,"label",16)(2,"input",17)(3,"small",12),a()),t&2){let e=m(2);o(),n("required",e.transactionalCodeField),o(2),n("errors",e.transactionalCodeField.errors)("touched",e.transactionalCodeField.touched)("dirty",e.transactionalCodeField.dirty)}}function ot(t,i){if(t&1){let e=w();r(0,"div",13)(1,"p-button",18),f("click",function(){C(e);let s=m(2);return _(s.verifyTransactionalCode())}),a()()}if(t&2){let e=m(2);o(),n("icon",e.PrimeIcons.VERIFIED)("disabled",!e.isRequestTransactionalCode||!e.transactionalCodeField.valid)}}function rt(t,i){if(t&1&&(r(0,"div",14)(1,"div",19),d(2,"label",20)(3,"p-password",21)(4,"small",12),a(),r(5,"div",19),d(6,"label",22)(7,"p-password",23)(8,"small",12),a()()),t&2){let e=m(2);o(2),n("label",e.LoginFormEnum.username)("required",e.passwordNewField),o(),n("feedback",!1),o(),n("errors",e.passwordNewField.errors)("touched",e.passwordNewField.touched)("dirty",e.passwordNewField.dirty),o(2),n("label",e.LoginFormEnum.passwordConfirmation)("required",e.passwordConfirmationField),o(),n("feedback",!1),o(),n("errors",e.passwordConfirmationField.errors)("touched",e.passwordConfirmationField.touched)("dirty",e.passwordConfirmationField.dirty)}}function nt(t,i){if(t&1){let e=w();r(0,"div",13)(1,"p-button",24),f("click",function(){C(e);let s=m(2);return _(s.resetPassword())}),a()()}if(t&2){let e=m(2);o(),n("icon",e.PrimeIcons.KEY)}}function at(t,i){t&1&&(r(0,"div",13),d(1,"app-progress-bar"),a())}function st(t,i){if(t&1){let e=w();r(0,"form",7),f("ngSubmit",function(){C(e);let s=m();return _(s.onSubmit())}),r(1,"div",8)(2,"h2"),g(3,"Recupera Contrase\xF1a"),a()(),r(4,"div",9),d(5,"label",10)(6,"input",11)(7,"small",12),a(),v(8,tt,2,2,"div",9)(9,it,4,4,"div",13)(10,ot,2,2,"div",13)(11,rt,9,12,"div",14)(12,nt,2,1,"div",13)(13,at,2,0,"div",13),a()}if(t&2){let e=m();n("formGroup",e.form),o(5),n("label",e.LoginFormEnum.username)("required",e.usernameField),o(2),n("errors",e.usernameField.errors)("touched",e.usernameField.touched)("dirty",e.usernameField.dirty),o(),h(8,e.isValidTransactionalCode?-1:8),o(),h(9,e.isRequestTransactionalCode&&!e.isValidTransactionalCode?9:-1),o(),h(10,e.isRequestTransactionalCode&&!e.isValidTransactionalCode?10:-1),o(),h(11,e.isValidTransactionalCode?11:-1),o(),h(12,e.isValidTransactionalCode?12:-1),o(),h(13,e.coreService.isLoading?13:-1)}}function lt(t,i){if(t&1){let e=w();r(0,"div",25)(1,"p-button",26),f("click",function(){C(e);let s=m();return _(s.redirectLogin())}),a()()}if(t&2){let e=m();o(),n("raised",!0)("icon",e.PrimeIcons.ARROW_LEFT)}}var Ge=(()=>{let i=class i{constructor(){this.coreService=c(x),this.formBuilder=c(R),this.authHttpService=c(B),this.messageService=c(F),this.authService=c(T),this.routesService=c(G),this.PrimeIcons=y,this.isValidTransactionalCode=!1,this.isRequestTransactionalCode=!1,this.LoginFormEnum=j,this.buildForm()}ngOnInit(){}buildForm(){this.form=this.formBuilder.group({transactionalCode:[null,[u.required,u.minLength(6)]],passwordNew:[null,[u.required,u.minLength(8)]],passwordConfirmation:[null,[u.required]],username:[null,[u.required]]},{validators:J.passwordMatchValidator})}onSubmit(){this.form.valid?this.resetPassword():this.form.markAllAsTouched()}resetPassword(){this.authHttpService.resetPassword(this.form.value).subscribe(()=>this.routesService.login())}requestTransactionalCode(){this.usernameField.valid?(this.isRequestTransactionalCode=!1,this.transactionalCodeField.reset(),this.authHttpService.requestTransactionalCode(this.usernameField.value).subscribe(()=>this.isRequestTransactionalCode=!0)):this.usernameField.markAsTouched()}verifyTransactionalCode(){this.usernameField.valid?(this.isValidTransactionalCode=!1,this.authHttpService.verifyTransactionalCode(this.transactionalCodeField.value,this.usernameField.value).subscribe(()=>this.isValidTransactionalCode=!0)):this.transactionalCodeField.markAsTouched()}redirectLogin(){this.routesService.login()}get usernameField(){return this.form.controls.username}get transactionalCodeField(){return this.form.controls.transactionalCode}get passwordNewField(){return this.form.controls.passwordNew}get passwordConfirmationField(){return this.form.controls.passwordConfirmation}};i.\u0275fac=function(s){return new(s||i)},i.\u0275cmp=S({type:i,selectors:[["app-password-reset"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[1,"field","col-12"],["for","username","appLabel","",3,"label","required"],["pInputText","","id","username","formControlName","username"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"field"],[1,"formgrid","grid"],["label","Solicitar C\xF3digo","severity","info",3,"click","icon","disabled"],["for","transactionalCode","appLabel","","label","Ingrese el c\xF3digo enviado a su correo",3,"required"],["pInputText","","id","transactionalCode","formControlName","transactionalCode"],["severity","success","label","Validar C\xF3digo",3,"click","icon","disabled"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["for","passwordNew","appLabel","",3,"label","required"],["id","passwordNew","formControlName","passwordNew",3,"feedback"],["for","passwordConfirmation","appLabel","",3,"label","required"],["id","passwordConfirmation","formControlName","passwordConfirmation",3,"feedback"],["label","Resetear Contrase\xF1a",3,"click","icon"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","secondary","label","Regresar al Login",1,"w-full",3,"click","raised","icon"]],template:function(s,p){s&1&&(r(0,"div",0)(1,"p-panel",1),v(2,et,3,1,"ng-template",2)(3,st,14,12,"ng-template",3)(4,lt,2,2,"ng-template",4),a()())},dependencies:[I,H,E,P,V,L,O,z,M,A,N,Y,Z,$],styles:[`body{background-image:url(/assets/images/pages/auth/login/password-reset.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();function mt(t,i){if(t&1&&(r(0,"div",5)(1,"span",6),g(2),a()()),t&2){let e=m();o(2),b(e.authService.system)}}function dt(t,i){if(t&1&&(r(0,"div",5)(1,"div"),g(2),a()()),t&2){let e=i.$implicit;o(2),b(e.name)}}function pt(t,i){if(t&1&&(r(0,"div",5)(1,"div"),g(2),a()()),t&2){let e=i.$implicit;o(2),b(e.name)}}function ct(t,i){if(t&1){let e=w();r(0,"form",7),f("ngSubmit",function(){C(e);let s=m();return _(s.onSubmit())}),r(1,"div",8)(2,"h2"),g(3,"Seleccione un Rol"),a()(),r(4,"div",9),d(5,"label",10),r(6,"p-dropdown",11),v(7,dt,3,1,"ng-template",12)(8,pt,3,1,"ng-template",13),a()(),r(9,"div",9),d(10,"p-button",14),a()()}if(t&2){let e=m();n("formGroup",e.form),o(5),n("label",e.LoginFormEnum.roleSelect)("required",e.roleField),o(),n("options",e.roles),o(4),n("icon",e.PrimeIcons.SIGN_IN)}}function ut(t,i){if(t&1){let e=w();r(0,"div",15)(1,"p-button",16),f("click",function(){C(e);let s=m();return _(s.redirectLogin())}),a()()}if(t&2){let e=m();o(),n("raised",!0)("icon",e.PrimeIcons.ARROW_LEFT)}}var je=(()=>{let i=class i{constructor(){this.coreService=c(x),this.formBuilder=c(R),this.messageService=c(F),this.authService=c(T),this.routesService=c(G),this.roles=[],this.LoginFormEnum=j,this.PrimeIcons=y,this.buildForm()}ngOnInit(){this.roles=this.authService.roles}buildForm(){this.form=this.formBuilder.group({role:[null,[u.required]],fiscalYear:[null],unit:[null]})}onSubmit(){this.form.valid?this.selectRole():(this.form.markAllAsTouched(),this.messageService.errorsFields())}selectRole(){this.authService.role=this.roleField.value,this.authService.selectDashboard()}redirectLogin(){this.routesService.login()}get roleField(){return this.form.controls.role}};i.\u0275fac=function(s){return new(s||i)},i.\u0275cmp=S({type:i,selectors:[["app-role-select"]],decls:5,vars:0,consts:[[1,"grid"],[1,"col-12","xl:col-4","lg:col-4","md:col-6","sm:col-12"],["pTemplate","header"],["pTemplate","content"],["pTemplate","footer"],[1,"flex","align-items-center","gap-2"],[1,"font-bold"],[1,"p-fluid","grid",3,"ngSubmit","formGroup"],[1,"field","col-12","text-center"],[1,"field","col-12"],["for","role","appLabel","",3,"label","required"],["id","role","formControlName","role","dataKey","id","placeholder","Seleccione","appendTo","body",3,"options"],["pTemplate","selectedItem"],["pTemplate","item"],["type","submit","label","Continuar",3,"icon"],[1,"flex","flex-wrap","align-items-center","justify-content-between","gap-3"],["severity","secondary","label","Regresar al Login",3,"click","raised","icon"]],template:function(s,p){s&1&&(r(0,"div",0)(1,"p-panel",1),v(2,mt,3,1,"ng-template",2)(3,ct,11,5,"ng-template",3)(4,ut,2,2,"ng-template",4),a()())},dependencies:[I,E,P,V,L,M,A,N,Se,$],styles:[`body{background-image:url(/assets/images/pages/auth/login/role.jpg);background-size:cover}.p-panel-content{opacity:90%}.p-panel-header{opacity:70%}.p-panel-footer{opacity:80%}
`],encapsulation:2});let t=i;return t})();var ft=[{path:"login",component:Ae},{path:"password-reset",component:Ge},{path:"role-select",component:je}],Be=(()=>{let i=class i{};i.\u0275fac=function(s){return new(s||i)},i.\u0275mod=D({type:i}),i.\u0275inj=q({imports:[Q.forChild(ft),Q]});let t=i;return t})();function gt(t,i){if(t&1&&(r(0,"div",1),d(1,"app-progress-bar",12),a()),t&2){let e=m();o(),n("message",e.messageService.progressBarProcess)}}var di=(()=>{let i=class i{constructor(l,s,p,ie,Oe,He){this.authHttpService=l,this.authService=s,this.activatedRoute=p,this.coreService=ie,this.formBuilder=Oe,this.messageService=He,this.PrimeIcons=y,this.form=this.newForm()}ngOnInit(){}newForm(){return this.formBuilder.group({passwordConfirmation:[null,[u.required]],passwordNew:[null,[u.required,u.minLength(8)]],passwordOld:[null,[u.required]]},{validators:J.passwordMatchValidator})}onSubmit(){this.form.valid?this.changePassword():(this.form.markAllAsTouched(),this.messageService.errorsFields())}changePassword(){this.authHttpService.changePassword(this.authService.auth.id,this.form.value).subscribe(l=>{})}get passwordConfirmationField(){return this.form.controls.passwordConfirmation}get passwordNewField(){return this.form.controls.passwordNew}get passwordOldField(){return this.form.controls.passwordOld}};i.\u0275fac=function(s){return new(s||i)(k(B),k(T),k(me),k(x),k(R),k(F))},i.\u0275cmp=S({type:i,selectors:[["app-password-change"]],decls:17,vars:18,consts:[[1,"p-fluid",3,"ngSubmit","formGroup"],[1,"field"],["for","passwordOld","appLabel","","label","Contrase\xF1a Anterior",3,"required"],["pPassword","","type","password","id","passwordOld","formControlName","passwordOld"],["appErrorMessage","",3,"errors","touched","dirty"],[1,"formgrid","grid"],[1,"field","xl:col-6","lg:col-6","md:col-6","sm:col-12"],["appLabel","","for","passwordNew","label","Nueva Contrase\xF1a",3,"required"],["pPassword","","type","password","id","passwordNew","formControlName","passwordNew",3,"feedback"],["appLabel","","for","passwordConfirmation","label","Repita la Contrase\xF1a",3,"required"],["pPassword","","type","password","id","passwordConfirmation","formControlName","passwordConfirmation",3,"feedback"],["type","submit","label","Cambiar Contrase\xF1a",3,"icon","loading"],[3,"message"]],template:function(s,p){s&1&&(r(0,"form",0),f("ngSubmit",function(){return p.onSubmit()}),r(1,"div",1),d(2,"label",2)(3,"input",3)(4,"small",4),a(),r(5,"div",5)(6,"div",6),d(7,"label",7)(8,"input",8)(9,"small",4),a(),r(10,"div",6),d(11,"label",9)(12,"input",10)(13,"small",4),a()(),r(14,"div",1),d(15,"p-button",11),a(),v(16,gt,2,1,"div",1),a()),s&2&&(n("formGroup",p.form),o(2),n("required",p.passwordOldField),o(2),n("errors",p.passwordOldField.errors)("touched",p.passwordOldField.touched)("dirty",p.passwordOldField.dirty),o(3),n("required",p.passwordNewField),o(),n("feedback",!1),o(),n("errors",p.passwordNewField.errors)("touched",p.passwordNewField.touched)("dirty",p.passwordNewField.dirty),o(2),n("required",p.passwordConfirmationField),o(),n("feedback",!1),o(),n("errors",p.passwordConfirmationField.errors)("touched",p.passwordConfirmationField.touched)("dirty",p.passwordConfirmationField.dirty),o(2),n("icon",p.PrimeIcons.SAVE)("loading",p.coreService.isLoading),o(),h(16,p.coreService.isLoading?16:-1))},dependencies:[I,H,E,P,V,L,O,z,M,N,ve],styles:[".loginForm[_ngcontent-%COMP%]{padding:5% 20% 20%}"]});let t=i;return t})();var Gi=(()=>{let i=class i{};i.\u0275fac=function(s){return new(s||i)},i.\u0275mod=D({type:i}),i.\u0275inj=q({imports:[U,Be,fe,Ne,ue,xe,Fe,ye,ge,he,ce,be,Te,Ce,Ee,Pe,we,Le]});let t=i;return t})();export{di as a,Gi as b};
