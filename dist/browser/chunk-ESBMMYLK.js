import{a as je}from"./chunk-54G7NZAN.js";import{b as Ve}from"./chunk-6OUSS3ZN.js";import{b as se}from"./chunk-UKRHH3MD.js";import{a as Re}from"./chunk-PDG3KPQP.js";import{c as Pe,d as ze,f as He}from"./chunk-G4OVCVLI.js";import{b as ke}from"./chunk-ISADC5UE.js";import{c as ce,e as he}from"./chunk-PBCIGM6W.js";import{Ea as Be,Ga as Oe,Ja as Ne,P as de,Q as ue,Ta as De,Wa as Fe,Y as ge,Z as ve,aa as _e,ca as xe,fa as ye,ga as be,ma as Se,na as Ce,o as le,oa as Ee,pa as Te,ta as Ae,va as Ie,w as ae,x as me,xa as Le,z as pe,za as we}from"./chunk-QE2E6YRM.js";import{e as ne,j as oe,k as re,n as fe,r as Me}from"./chunk-YQJQS4JL.js";import{I,J as v,K as L,L as w,M as J,N as y,O as X,Q as Y,aa as b,ha as Z,k as W,la as ee,o as M,p as U,qa as te,r as G,s as $,sa as ie,u as Q,v as q,x as K}from"./chunk-CK22UZYV.js";import{Aa as F,Ba as k,Ca as s,E as d,H as p,J as S,K as u,La as r,Ma as _,Na as c,O as N,Oa as T,Ob as j,P as D,Rb as A,Wa as R,_ as m,eb as V,gb as P,ja as g,ka as C,la as f,qa as E,ua as o,va as n,vb as z,wa as h,yb as H,zb as x}from"./chunk-EUOB27Q6.js";var $e=()=>({"min-width":"70rem"});function Qe(t,i){if(t&1&&h(0,"app-skeleton",0),t&2){let e=s();f("type",e.SkeletonEnum.CARD)}}function qe(t,i){if(t&1&&(o(0,"h3"),r(1),n()),t&2){let e=s(2);m(),_(e.AgreementLogEnum.header)}}function Ke(t,i){t&1&&(o(0,"tr")(1,"th"),r(2,"Campo"),n(),o(3,"th"),r(4,"Descripci\xF3n"),n(),o(5,"th"),r(6,"Texto Original"),n(),o(7,"th"),r(8,"Texto Actualizado"),n(),o(9,"th"),r(10,"Usuario Responsable"),n(),o(11,"th"),r(12,"Fecha y Hora"),n()())}function Je(t,i){if(t&1&&(o(0,"td")(1,"span",10),r(2),n()()),t&2){let e=s(),a=e.$implicit,l=e.rowspan;C("rowspan",l),m(2),_(a.property)}}function Xe(t,i){if(t&1&&(o(0,"tr"),g(1,Je,3,2,"td",8),o(2,"td"),r(3),n(),o(4,"td")(5,"span",9),r(6),n()(),o(7,"td"),r(8),n(),o(9,"td"),r(10),n(),o(11,"td"),r(12),V(13,"date"),n()()),t&2){let e=i.$implicit,a=i.rowgroup;m(),f("ngIf",a),m(2),c(" ",e.description," "),m(3),_(e.oldValue),m(2),c(" ",e.newValue," "),m(2),T(" ",e.agreementLog.user.name," ",e.agreementLog.user.lastname," "),m(2),c(" ",P(13,7,e.agreementLog.registeredAt,"dd/MM/yyyy HH:mm:ss")," ")}}function Ye(t,i){if(t&1&&(o(0,"p")(1,"b"),r(2,"N\xFAmero Interno Convenio:"),n(),r(3),n(),o(4,"p")(5,"b"),r(6,"Nombre del Convenio:"),n(),r(7),n(),o(8,"p")(9,"b"),r(10,"Unidad Administradora:"),n(),r(11),n(),o(12,"p")(13,"b"),r(14,"Cargo Unidad Administradora:"),n(),r(15),n(),o(16,"p-table",6),g(17,Ke,13,0,"ng-template",4)(18,Xe,14,10,"ng-template",7),n()),t&2){let e=s(2);m(3),c(" ",e.agreement==null?null:e.agreement.internalNumber,""),m(4),c(" ",e.agreement==null?null:e.agreement.name,""),m(4),T(" ",e.agreement==null||e.agreement.administrator==null||e.agreement.administrator.user==null?null:e.agreement.administrator.user.name," ",e.agreement==null||e.agreement.administrator==null||e.agreement.administrator.user==null?null:e.agreement.administrator.user.lastname," "),m(4),c(" ",e.agreement==null||e.agreement.administrator==null||e.agreement.administrator.position==null?null:e.agreement.administrator.position.name,""),m(),f("value",e.items)("tableStyle",R(7,$e))}}function Ze(t,i){if(t&1){let e=F();o(0,"p-toolbar")(1,"div",1)(2,"p-button",2),k("click",function(){N(e);let l=s();return D(l.downloadLogsByAgreement())}),n()(),h(3,"div",3),n(),o(4,"p-panel"),g(5,qe,2,1,"ng-template",4)(6,Ye,19,8,"ng-template",5),n()}if(t&2){let e=s();m(2),f("icon",e.IconButtonActionEnum.DOWNLOAD)("label",e.LabelButtonActionEnum.DOWNLOAD)("loading",e.coreService.isLoading)("severity",e.SeverityButtonActionEnum.DOWNLOAD)}}var We=(()=>{let i=class i{constructor(){this.authService=p(ie),this.coreService=p(G),this.agreementsHttpService=p(Z),this.agreementLogsHttpService=p(ee),this.agreementsService=p(K),this.router=p(j),this.breadcrumbService=p(Q),this.PrimeIcons=W,this.IconButtonActionEnum=w,this.SeverityButtonActionEnum=J,this.LabelButtonActionEnum=L,this.BreadcrumbEnum=y,this.TableEnum=Y,this.messageService=p($),this.messageDialogService=p(q),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new le(""),this.items=[],this.events=[],this.isVisibleAgreementView=!1,this.SkeletonEnum=X,this.AgreementLogEnum=b,this.breadcrumbService.setItems([{label:y.AGREEMENTS},{label:y.AGREEMENTS_LOG}]),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findAgreementLogsByAgreement()}findAgreementLogsByAgreement(){this.agreementLogsHttpService.findAgreementLogsByAgreement(this.id).subscribe(a=>{this.items=a,this.items.length>0&&(console.log(),this.agreement=this.items[0].agreementLog?.agreement)})}buildColumns(){this.columns=[{field:"registeredAt",header:b.registeredAt},{field:"user",header:b.user}]}buildButtonActions(){this.buttonActions=[{id:v.VIEW,label:L.VIEW,icon:w.VIEW,command:()=>{this.redirectCreateForm()}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}validateButtonActions(a){this.buildButtonActions(),a.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===v.COMPLETE),1),a.enabled||(this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===v.VIEW),1),this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===v.EDIT),1))}selectItem(a){this.agreementsHttpService.findOne(a.id).subscribe(l=>{this.isButtonActions=!0,this.agreement=a,this.validateButtonActions(a),this.agreementsService.agreement=l})}downloadLogsByAgreement(){this.agreementLogsHttpService.downloadLogsByAgreement(this.id)}};i.\u0275fac=function(l){return new(l||i)},i.\u0275cmp=S({type:i,selectors:[["app-log"]],inputs:{id:"id"},decls:2,vars:2,consts:[[3,"type"],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["pTemplate","header"],["pTemplate","content"],["sortField","property","sortMode","single","dataKey","property","rowGroupMode","rowspan","groupRowsBy","property",3,"value","tableStyle"],["pTemplate","body"],[4,"ngIf"],[1,"ml-1","vertical-align-middle"],[1,"font-bold","ml-2"]],template:function(l,O){l&1&&g(0,Qe,1,1,"app-skeleton",0)(1,Ze,7,4),l&2&&(E(0,O.coreService.isLoading?0:-1),m(),E(1,O.coreService.isLoading?-1:1))},dependencies:[z,Ce,M,oe,de,Ee,be,H]});let t=i;return t})();var et=[{path:"",component:We,canActivate:[se],data:{roles:[I.NATIONAL_SUPERVISOR,I.INTERNATIONAL_SUPERVISOR]}}],Ue=(()=>{let i=class i{};i.\u0275fac=function(l){return new(l||i)},i.\u0275mod=u({type:i}),i.\u0275inj=d({imports:[A.forChild(et),A]});let t=i;return t})();var Ge=(()=>{class t{static \u0275fac=function(a){return new(a||t)};static \u0275mod=u({type:t});static \u0275inj=d({imports:[x,U]})}return t})();var Ti=(()=>{let i=class i{};i.\u0275fac=function(l){return new(l||i)},i.\u0275mod=u({type:i}),i.\u0275inj=d({providers:[te],imports:[x,Ue,me,Fe,re,ve,he,fe,pe,ce,ne,ge,Me,ue,ke,Te,Le,xe,ze,_e,He,Pe,je,Ae,Ie,Ve,ae,Se,Oe,Ne,ye,De,we,Re,Be,Ge]});let t=i;return t})();export{Ti as LogModule};
