import{a as je}from"./chunk-JMTOVCST.js";import{b as Ve}from"./chunk-TK26SYKO.js";import{b as se}from"./chunk-NLQHXLQA.js";import{a as Re}from"./chunk-SBIYMBDM.js";import{c as Pe,d as ze,f as He}from"./chunk-JLN5XX2E.js";import{b as Fe}from"./chunk-ISADC5UE.js";import{c as ce,e as he}from"./chunk-XASNB7HI.js";import{A as pe,Aa as we,Fa as Ne,Ha as Be,Ka as Oe,Q as de,R as ue,Ua as De,Xa as ke,Z as ge,_ as ve,ba as _e,da as xe,ga as Ce,ha as Te,na as Ee,oa as ye,p as le,pa as Se,qa as be,ua as Ae,wa as Ie,x as ae,y as me,ya as Le}from"./chunk-Y3HCVK7F.js";import{e as ne,j as oe,k as re,n as fe,r as Me}from"./chunk-RZRVD6AN.js";import{Ba as ie,K as v,L as _,M as I,N as L,O as J,P as E,Q as X,S as Y,da as y,k as G,la as Z,o as M,p as W,pa as ee,r as U,s as $,u as Q,v as q,x as K,za as te}from"./chunk-EWPJV5E5.js";import{Aa as D,Ba as k,Ca as s,E as u,H as p,J as S,K as g,La as r,Ma as C,Na as d,O as B,Oa as F,Ob as j,P as O,Rb as A,Wa as R,_ as m,eb as V,gb as P,ja as c,ka as b,la as f,qa as h,ua as o,va as n,vb as z,wa as x,yb as H,zb as T}from"./chunk-EUOB27Q6.js";var $e=()=>({"min-width":"70rem"});function Qe(e,t){if(e&1&&x(0,"app-skeleton",0),e&2){let i=s();f("type",i.SkeletonEnum.CARD)}}function qe(e,t){if(e&1&&(o(0,"h3"),r(1),n()),e&2){let i=s(2);m(),C(i.AgreementLogEnum.header)}}function Ke(e,t){if(e&1&&(o(0,"p")(1,"b"),r(2,"Unidad Administradora:"),n(),r(3),n(),o(4,"p")(5,"b"),r(6,"Cargo Unidad Administradora:"),n(),r(7),n()),e&2){let i=s(4);m(3),d(" ",i.agreement.administrator.unit.name," "),m(4),d(" ",i.agreement.administrator.position.name," ")}}function Je(e,t){if(e&1&&(o(0,"p")(1,"b"),r(2,"N\xFAmero Interno Convenio:"),n(),r(3),n(),o(4,"p")(5,"b"),r(6,"Nombre del Convenio:"),n(),r(7),n(),c(8,Ke,8,2)),e&2){let i=s(3);m(3),d(" ",i.agreement.internalNumber,""),m(4),d(" ",i.agreement.name,""),m(),h(8,i.agreement.administrator?8:-1)}}function Xe(e,t){e&1&&(o(0,"tr")(1,"th"),r(2,"Campo"),n(),o(3,"th"),r(4,"Descripci\xF3n"),n(),o(5,"th"),r(6,"Texto Original"),n(),o(7,"th"),r(8,"Texto Actualizado"),n(),o(9,"th"),r(10,"Usuario Responsable"),n(),o(11,"th"),r(12,"Fecha y Hora"),n()())}function Ye(e,t){if(e&1&&(o(0,"td")(1,"span",10),r(2),n()()),e&2){let i=s(),a=i.$implicit,l=i.rowspan;b("rowspan",l),m(2),C(a.property)}}function Ze(e,t){if(e&1&&(o(0,"tr"),c(1,Ye,3,2,"td",8),o(2,"td"),r(3),n(),o(4,"td")(5,"span",9),r(6),n()(),o(7,"td"),r(8),n(),o(9,"td"),r(10),n(),o(11,"td"),r(12),V(13,"date"),n()()),e&2){let i=t.$implicit,a=t.rowgroup;m(),f("ngIf",a),m(2),d(" ",i.description," "),m(3),C(i.oldValue),m(2),d(" ",i.newValue," "),m(2),F(" ",i.agreementLog.user.name," ",i.agreementLog.user.lastname," "),m(2),d(" ",P(13,7,i.agreementLog.registeredAt,"dd/MM/yyyy HH:mm:ss")," ")}}function et(e,t){if(e&1&&(c(0,Je,9,3),o(1,"p-table",6),c(2,Xe,13,0,"ng-template",4)(3,Ze,14,10,"ng-template",7),n()),e&2){let i=s(2);h(0,i.agreement?0:-1),m(),f("value",i.items)("tableStyle",R(3,$e))}}function tt(e,t){if(e&1){let i=D();o(0,"p-toolbar")(1,"div",1)(2,"p-button",2),k("click",function(){B(i);let l=s();return O(l.downloadLogsByAgreement())}),n()(),x(3,"div",3),n(),o(4,"p-panel"),c(5,qe,2,1,"ng-template",4)(6,et,4,4,"ng-template",5),n()}if(e&2){let i=s();m(2),f("icon",i.IconButtonActionEnum.DOWNLOAD)("label",i.LabelButtonActionEnum.DOWNLOAD)("loading",i.coreService.isLoading)("severity",i.SeverityButtonActionEnum.DOWNLOAD)}}var Ge=(()=>{let t=class t{constructor(){this.authService=p(ie),this.coreService=p(U),this.agreementsHttpService=p(Z),this.agreementLogsHttpService=p(ee),this.agreementsService=p(K),this.router=p(j),this.breadcrumbService=p(Q),this.PrimeIcons=G,this.IconButtonActionEnum=L,this.SeverityButtonActionEnum=J,this.LabelButtonActionEnum=I,this.BreadcrumbEnum=E,this.TableEnum=Y,this.messageService=p($),this.messageDialogService=p(q),this.buttonActions=[],this.isButtonActions=!1,this.columns=[],this.search=new le(""),this.items=[],this.events=[],this.isVisibleAgreementView=!1,this.SkeletonEnum=X,this.AgreementLogEnum=y,this.breadcrumbService.setItems([{label:E.AGREEMENTS,routerLink:[`/core/${this.authService.role.code}/agreement-list`]},{label:E.AGREEMENTS_LOG}]),this.buildButtonActions(),this.buildColumns()}ngOnInit(){this.findAgreementLogsByAgreement()}findAgreementLogsByAgreement(){this.agreementLogsHttpService.findAgreementLogsByAgreement(this.id).subscribe(a=>{this.items=a,this.items.length>0&&(this.agreement=this.items[0].agreementLog?.agreement)})}buildColumns(){this.columns=[{field:"registeredAt",header:y.registeredAt},{field:"user",header:y.user}]}buildButtonActions(){this.buttonActions=[{id:_.VIEW,label:I.VIEW,icon:L.VIEW,command:()=>{this.redirectCreateForm()}}]}redirectCreateForm(){this.agreementsService.clearAgreement(),this.router.navigate(["/core/agreements","register"])}validateButtonActions(a){this.buildButtonActions(),a.enabled&&this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===_.COMPLETE),1),a.enabled||(this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===_.VIEW),1),this.buttonActions.splice(this.buttonActions.findIndex(l=>l.id===_.EDIT),1))}selectItem(a){this.agreementsHttpService.findOne(a.id).subscribe(l=>{this.isButtonActions=!0,this.agreement=a,this.validateButtonActions(a),this.agreementsService.agreement=l})}downloadLogsByAgreement(){this.agreementLogsHttpService.downloadLogsByAgreement(this.id)}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=S({type:t,selectors:[["app-log"]],inputs:{id:"id"},decls:2,vars:2,consts:[[3,"type"],[1,"p-toolbar-group-left"],[3,"click","icon","label","loading","severity"],[1,"p-toolbar-group-right"],["pTemplate","header"],["pTemplate","content"],["sortField","property","sortMode","single","dataKey","property","rowGroupMode","rowspan","groupRowsBy","property",3,"value","tableStyle"],["pTemplate","body"],[4,"ngIf"],[1,"ml-1","vertical-align-middle"],[1,"font-bold","ml-2"]],template:function(l,N){l&1&&c(0,Qe,1,1,"app-skeleton",0)(1,tt,7,4),l&2&&(h(0,N.coreService.isLoading?0:-1),m(),h(1,N.coreService.isLoading?-1:1))},dependencies:[z,ye,M,oe,de,Se,Te,H]});let e=t;return e})();var it=[{path:"",component:Ge,canActivate:[se],data:{roles:[v.AGREEMENT_ADMINISTRATOR,v.NATIONAL_SUPERVISOR,v.INTERNATIONAL_SUPERVISOR,v.NATIONAL_MANAGER,v.INTERNATIONAL_MANAGER]}}],We=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=g({type:t}),t.\u0275inj=u({imports:[A.forChild(it),A]});let e=t;return e})();var Ue=(()=>{class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=g({type:e});static \u0275inj=u({imports:[T,W]})}return e})();var Mi=(()=>{let t=class t{};t.\u0275fac=function(l){return new(l||t)},t.\u0275mod=g({type:t}),t.\u0275inj=u({providers:[te],imports:[T,We,me,ke,re,ve,he,fe,pe,ce,ne,ge,Me,ue,Fe,be,Le,xe,ze,_e,He,Pe,je,Ae,Ie,Ve,ae,Ee,Be,Oe,Ce,De,we,Re,Ne,Ue]});let e=t;return e})();export{Mi as LogModule};
